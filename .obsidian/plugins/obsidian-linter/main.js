/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/
"use strict";var obsidian=require("obsidian");
/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function __classPrivateFieldGet(receiver,state,kind,f){if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===kind?f:"a"===kind?f.call(receiver):f?f.value:state.get(receiver)}
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */
function isNothing(subject){return null==subject}var common={isNothing,isObject:function(subject){return"object"==typeof subject&&null!==subject},toArray:function(sequence){return Array.isArray(sequence)?sequence:isNothing(sequence)?[]:[sequence]},repeat:function(string,count){var cycle,result="";for(cycle=0;cycle<count;cycle+=1)result+=string;return result},isNegativeZero:function(number){return 0===number&&Number.NEGATIVE_INFINITY===1/number},extend:function(target,source){var index,length,key,sourceKeys;if(source)for(index=0,length=(sourceKeys=Object.keys(source)).length;index<length;index+=1)target[key=sourceKeys[index]]=source[key];return target}};function formatError(exception,compact){var where="",message=exception.reason||"(unknown reason)";return exception.mark?(exception.mark.name&&(where+='in "'+exception.mark.name+'" '),where+="("+(exception.mark.line+1)+":"+(exception.mark.column+1)+")",!compact&&exception.mark.snippet&&(where+="\n\n"+exception.mark.snippet),message+" "+where):message}function YAMLException$1(reason,mark){Error.call(this),this.name="YAMLException",this.reason=reason,this.mark=mark,this.message=formatError(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}YAMLException$1.prototype=Object.create(Error.prototype),YAMLException$1.prototype.constructor=YAMLException$1,YAMLException$1.prototype.toString=function(compact){return this.name+": "+formatError(this,compact)};var exception=YAMLException$1;function getLine(buffer,lineStart,lineEnd,position,maxLineLength){var head="",tail="",maxHalfLength=Math.floor(maxLineLength/2)-1;return position-lineStart>maxHalfLength&&(lineStart=position-maxHalfLength+(head=" ... ").length),lineEnd-position>maxHalfLength&&(lineEnd=position+maxHalfLength-(tail=" ...").length),{str:head+buffer.slice(lineStart,lineEnd).replace(/\t/g,"â†’")+tail,pos:position-lineStart+head.length}}function padStart(string,max){return common.repeat(" ",max-string.length)+string}var TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"],type=function(tag,options){if(options=options||{},Object.keys(options).forEach((function(name){if(-1===TYPE_CONSTRUCTOR_OPTIONS.indexOf(name))throw new exception('Unknown option "'+name+'" is met in definition of "'+tag+'" YAML type.')})),this.options=options,this.tag=tag,this.kind=options.kind||null,this.resolve=options.resolve||function(){return!0},this.construct=options.construct||function(data){return data},this.instanceOf=options.instanceOf||null,this.predicate=options.predicate||null,this.represent=options.represent||null,this.representName=options.representName||null,this.defaultStyle=options.defaultStyle||null,this.multi=options.multi||!1,this.styleAliases=function(map){var result={};return null!==map&&Object.keys(map).forEach((function(style){map[style].forEach((function(alias){result[String(alias)]=style}))})),result}(options.styleAliases||null),-1===YAML_NODE_KINDS.indexOf(this.kind))throw new exception('Unknown kind "'+this.kind+'" is specified for "'+tag+'" YAML type.')};function compileList(schema,name){var result=[];return schema[name].forEach((function(currentType){var newIndex=result.length;result.forEach((function(previousType,previousIndex){previousType.tag===currentType.tag&&previousType.kind===currentType.kind&&previousType.multi===currentType.multi&&(newIndex=previousIndex)})),result[newIndex]=currentType})),result}function Schema$1(definition){return this.extend(definition)}Schema$1.prototype.extend=function(definition){var implicit=[],explicit=[];if(definition instanceof type)explicit.push(definition);else if(Array.isArray(definition))explicit=explicit.concat(definition);else{if(!definition||!Array.isArray(definition.implicit)&&!Array.isArray(definition.explicit))throw new exception("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");definition.implicit&&(implicit=implicit.concat(definition.implicit)),definition.explicit&&(explicit=explicit.concat(definition.explicit))}implicit.forEach((function(type$1){if(!(type$1 instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(type$1.loadKind&&"scalar"!==type$1.loadKind)throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(type$1.multi)throw new exception("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),explicit.forEach((function(type$1){if(!(type$1 instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var result=Object.create(Schema$1.prototype);return result.implicit=(this.implicit||[]).concat(implicit),result.explicit=(this.explicit||[]).concat(explicit),result.compiledImplicit=compileList(result,"implicit"),result.compiledExplicit=compileList(result,"explicit"),result.compiledTypeMap=function(){var index,length,result={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function collectType(type){type.multi?(result.multi[type.kind].push(type),result.multi.fallback.push(type)):result[type.kind][type.tag]=result.fallback[type.tag]=type}for(index=0,length=arguments.length;index<length;index+=1)arguments[index].forEach(collectType);return result}(result.compiledImplicit,result.compiledExplicit),result};var failsafe=new Schema$1({explicit:[new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(data){return null!==data?data:""}}),new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(data){return null!==data?data:[]}}),new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(data){return null!==data?data:{}}})]}),_null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(data){if(null===data)return!0;var max=data.length;return 1===max&&"~"===data||4===max&&("null"===data||"Null"===data||"NULL"===data)},construct:function(){return null},predicate:function(object){return null===object},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(data){if(null===data)return!1;var max=data.length;return 4===max&&("true"===data||"True"===data||"TRUE"===data)||5===max&&("false"===data||"False"===data||"FALSE"===data)},construct:function(data){return"true"===data||"True"===data||"TRUE"===data},predicate:function(object){return"[object Boolean]"===Object.prototype.toString.call(object)},represent:{lowercase:function(object){return object?"true":"false"},uppercase:function(object){return object?"TRUE":"FALSE"},camelcase:function(object){return object?"True":"False"}},defaultStyle:"lowercase"});function isOctCode(c){return 48<=c&&c<=55}function isDecCode(c){return 48<=c&&c<=57}var int=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(data){if(null===data)return!1;var ch,c,max=data.length,index=0,hasDigits=!1;if(!max)return!1;if("-"!==(ch=data[index])&&"+"!==ch||(ch=data[++index]),"0"===ch){if(index+1===max)return!0;if("b"===(ch=data[++index])){for(index++;index<max;index++)if("_"!==(ch=data[index])){if("0"!==ch&&"1"!==ch)return!1;hasDigits=!0}return hasDigits&&"_"!==ch}if("x"===ch){for(index++;index<max;index++)if("_"!==(ch=data[index])){if(!(48<=(c=data.charCodeAt(index))&&c<=57||65<=c&&c<=70||97<=c&&c<=102))return!1;hasDigits=!0}return hasDigits&&"_"!==ch}if("o"===ch){for(index++;index<max;index++)if("_"!==(ch=data[index])){if(!isOctCode(data.charCodeAt(index)))return!1;hasDigits=!0}return hasDigits&&"_"!==ch}}if("_"===ch)return!1;for(;index<max;index++)if("_"!==(ch=data[index])){if(!isDecCode(data.charCodeAt(index)))return!1;hasDigits=!0}return!(!hasDigits||"_"===ch)},construct:function(data){var ch,value=data,sign=1;if(-1!==value.indexOf("_")&&(value=value.replace(/_/g,"")),"-"!==(ch=value[0])&&"+"!==ch||("-"===ch&&(sign=-1),ch=(value=value.slice(1))[0]),"0"===value)return 0;if("0"===ch){if("b"===value[1])return sign*parseInt(value.slice(2),2);if("x"===value[1])return sign*parseInt(value.slice(2),16);if("o"===value[1])return sign*parseInt(value.slice(2),8)}return sign*parseInt(value,10)},predicate:function(object){return"[object Number]"===Object.prototype.toString.call(object)&&object%1==0&&!common.isNegativeZero(object)},represent:{binary:function(obj){return obj>=0?"0b"+obj.toString(2):"-0b"+obj.toString(2).slice(1)},octal:function(obj){return obj>=0?"0o"+obj.toString(8):"-0o"+obj.toString(8).slice(1)},decimal:function(obj){return obj.toString(10)},hexadecimal:function(obj){return obj>=0?"0x"+obj.toString(16).toUpperCase():"-0x"+obj.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/,float=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(data){return null!==data&&!(!YAML_FLOAT_PATTERN.test(data)||"_"===data[data.length-1])},construct:function(data){var value,sign;return sign="-"===(value=data.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(value[0])>=0&&(value=value.slice(1)),".inf"===value?1===sign?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===value?NaN:sign*parseFloat(value,10)},predicate:function(object){return"[object Number]"===Object.prototype.toString.call(object)&&(object%1!=0||common.isNegativeZero(object))},represent:function(object,style){var res;if(isNaN(object))switch(style){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===object)switch(style){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===object)switch(style){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(object))return"-0.0";return res=object.toString(10),SCIENTIFIC_WITHOUT_DOT.test(res)?res.replace("e",".e"):res},defaultStyle:"lowercase"}),core=failsafe.extend({implicit:[_null,bool,int,float]}),YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(data){return null!==data&&(null!==YAML_DATE_REGEXP.exec(data)||null!==YAML_TIMESTAMP_REGEXP.exec(data))},construct:function(data){var match,year,month,day,hour,minute,second,date,fraction=0,delta=null;if(null===(match=YAML_DATE_REGEXP.exec(data))&&(match=YAML_TIMESTAMP_REGEXP.exec(data)),null===match)throw new Error("Date resolve error");if(year=+match[1],month=+match[2]-1,day=+match[3],!match[4])return new Date(Date.UTC(year,month,day));if(hour=+match[4],minute=+match[5],second=+match[6],match[7]){for(fraction=match[7].slice(0,3);fraction.length<3;)fraction+="0";fraction=+fraction}return match[9]&&(delta=6e4*(60*+match[10]+ +(match[11]||0)),"-"===match[9]&&(delta=-delta)),date=new Date(Date.UTC(year,month,day,hour,minute,second,fraction)),delta&&date.setTime(date.getTime()-delta),date},instanceOf:Date,represent:function(object){return object.toISOString()}}),merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(data){return"<<"===data||null===data}}),BASE64_MAP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(data){if(null===data)return!1;var code,idx,bitlen=0,max=data.length,map=BASE64_MAP;for(idx=0;idx<max;idx++)if(!((code=map.indexOf(data.charAt(idx)))>64)){if(code<0)return!1;bitlen+=6}return bitlen%8==0},construct:function(data){var idx,tailbits,input=data.replace(/[\r\n=]/g,""),max=input.length,map=BASE64_MAP,bits=0,result=[];for(idx=0;idx<max;idx++)idx%4==0&&idx&&(result.push(bits>>16&255),result.push(bits>>8&255),result.push(255&bits)),bits=bits<<6|map.indexOf(input.charAt(idx));return 0==(tailbits=max%4*6)?(result.push(bits>>16&255),result.push(bits>>8&255),result.push(255&bits)):18===tailbits?(result.push(bits>>10&255),result.push(bits>>2&255)):12===tailbits&&result.push(bits>>4&255),new Uint8Array(result)},predicate:function(obj){return"[object Uint8Array]"===Object.prototype.toString.call(obj)},represent:function(object){var idx,tail,result="",bits=0,max=object.length,map=BASE64_MAP;for(idx=0;idx<max;idx++)idx%3==0&&idx&&(result+=map[bits>>18&63],result+=map[bits>>12&63],result+=map[bits>>6&63],result+=map[63&bits]),bits=(bits<<8)+object[idx];return 0==(tail=max%3)?(result+=map[bits>>18&63],result+=map[bits>>12&63],result+=map[bits>>6&63],result+=map[63&bits]):2===tail?(result+=map[bits>>10&63],result+=map[bits>>4&63],result+=map[bits<<2&63],result+=map[64]):1===tail&&(result+=map[bits>>2&63],result+=map[bits<<4&63],result+=map[64],result+=map[64]),result}}),_hasOwnProperty$3=Object.prototype.hasOwnProperty,_toString$2=Object.prototype.toString,omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(data){if(null===data)return!0;var index,length,pair,pairKey,pairHasKey,objectKeys=[],object=data;for(index=0,length=object.length;index<length;index+=1){if(pair=object[index],pairHasKey=!1,"[object Object]"!==_toString$2.call(pair))return!1;for(pairKey in pair)if(_hasOwnProperty$3.call(pair,pairKey)){if(pairHasKey)return!1;pairHasKey=!0}if(!pairHasKey)return!1;if(-1!==objectKeys.indexOf(pairKey))return!1;objectKeys.push(pairKey)}return!0},construct:function(data){return null!==data?data:[]}}),_toString$1=Object.prototype.toString,pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(data){if(null===data)return!0;var index,length,pair,keys,result,object=data;for(result=new Array(object.length),index=0,length=object.length;index<length;index+=1){if(pair=object[index],"[object Object]"!==_toString$1.call(pair))return!1;if(1!==(keys=Object.keys(pair)).length)return!1;result[index]=[keys[0],pair[keys[0]]]}return!0},construct:function(data){if(null===data)return[];var index,length,pair,keys,result,object=data;for(result=new Array(object.length),index=0,length=object.length;index<length;index+=1)pair=object[index],keys=Object.keys(pair),result[index]=[keys[0],pair[keys[0]]];return result}}),_hasOwnProperty$2=Object.prototype.hasOwnProperty,set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(data){if(null===data)return!0;var key,object=data;for(key in object)if(_hasOwnProperty$2.call(object,key)&&null!==object[key])return!1;return!0},construct:function(data){return null!==data?data:{}}}),_default=core.extend({implicit:[timestamp,merge],explicit:[binary,omap,pairs,set]}),_hasOwnProperty$1=Object.prototype.hasOwnProperty,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(obj){return Object.prototype.toString.call(obj)}function is_EOL(c){return 10===c||13===c}function is_WHITE_SPACE(c){return 9===c||32===c}function is_WS_OR_EOL(c){return 9===c||32===c||10===c||13===c}function is_FLOW_INDICATOR(c){return 44===c||91===c||93===c||123===c||125===c}function fromHexCode(c){var lc;return 48<=c&&c<=57?c-48:97<=(lc=32|c)&&lc<=102?lc-97+10:-1}function simpleEscapeSequence(c){return 48===c?"\0":97===c?"":98===c?"\b":116===c||9===c?"\t":110===c?"\n":118===c?"\v":102===c?"\f":114===c?"\r":101===c?"":32===c?" ":34===c?'"':47===c?"/":92===c?"\\":78===c?"Â…":95===c?"Â ":76===c?"\u2028":80===c?"\u2029":""}function charFromCodepoint(c){return c<=65535?String.fromCharCode(c):String.fromCharCode(55296+(c-65536>>10),56320+(c-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(input,options){this.input=input,this.filename=options.filename||null,this.schema=options.schema||_default,this.onWarning=options.onWarning||null,this.legacy=options.legacy||!1,this.json=options.json||!1,this.listener=options.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=input.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function generateError(state,message){var mark={name:state.filename,buffer:state.input.slice(0,-1),position:state.position,line:state.line,column:state.position-state.lineStart};return mark.snippet=function(mark,options){if(options=Object.create(options||null),!mark.buffer)return null;options.maxLength||(options.maxLength=79),"number"!=typeof options.indent&&(options.indent=1),"number"!=typeof options.linesBefore&&(options.linesBefore=3),"number"!=typeof options.linesAfter&&(options.linesAfter=2);for(var match,re=/\r?\n|\r|\0/g,lineStarts=[0],lineEnds=[],foundLineNo=-1;match=re.exec(mark.buffer);)lineEnds.push(match.index),lineStarts.push(match.index+match[0].length),mark.position<=match.index&&foundLineNo<0&&(foundLineNo=lineStarts.length-2);foundLineNo<0&&(foundLineNo=lineStarts.length-1);var i,line,result="",lineNoLength=Math.min(mark.line+options.linesAfter,lineEnds.length).toString().length,maxLineLength=options.maxLength-(options.indent+lineNoLength+3);for(i=1;i<=options.linesBefore&&!(foundLineNo-i<0);i++)line=getLine(mark.buffer,lineStarts[foundLineNo-i],lineEnds[foundLineNo-i],mark.position-(lineStarts[foundLineNo]-lineStarts[foundLineNo-i]),maxLineLength),result=common.repeat(" ",options.indent)+padStart((mark.line-i+1).toString(),lineNoLength)+" | "+line.str+"\n"+result;for(line=getLine(mark.buffer,lineStarts[foundLineNo],lineEnds[foundLineNo],mark.position,maxLineLength),result+=common.repeat(" ",options.indent)+padStart((mark.line+1).toString(),lineNoLength)+" | "+line.str+"\n",result+=common.repeat("-",options.indent+lineNoLength+3+line.pos)+"^\n",i=1;i<=options.linesAfter&&!(foundLineNo+i>=lineEnds.length);i++)line=getLine(mark.buffer,lineStarts[foundLineNo+i],lineEnds[foundLineNo+i],mark.position-(lineStarts[foundLineNo]-lineStarts[foundLineNo+i]),maxLineLength),result+=common.repeat(" ",options.indent)+padStart((mark.line+i+1).toString(),lineNoLength)+" | "+line.str+"\n";return result.replace(/\n$/,"")}(mark),new exception(message,mark)}function throwError(state,message){throw generateError(state,message)}function throwWarning(state,message){state.onWarning&&state.onWarning.call(null,generateError(state,message))}var directiveHandlers={YAML:function(state,name,args){var match,major,minor;null!==state.version&&throwError(state,"duplication of %YAML directive"),1!==args.length&&throwError(state,"YAML directive accepts exactly one argument"),null===(match=/^([0-9]+)\.([0-9]+)$/.exec(args[0]))&&throwError(state,"ill-formed argument of the YAML directive"),major=parseInt(match[1],10),minor=parseInt(match[2],10),1!==major&&throwError(state,"unacceptable YAML version of the document"),state.version=args[0],state.checkLineBreaks=minor<2,1!==minor&&2!==minor&&throwWarning(state,"unsupported YAML version of the document")},TAG:function(state,name,args){var handle,prefix;2!==args.length&&throwError(state,"TAG directive accepts exactly two arguments"),handle=args[0],prefix=args[1],PATTERN_TAG_HANDLE.test(handle)||throwError(state,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$1.call(state.tagMap,handle)&&throwError(state,'there is a previously declared suffix for "'+handle+'" tag handle'),PATTERN_TAG_URI.test(prefix)||throwError(state,"ill-formed tag prefix (second argument) of the TAG directive");try{prefix=decodeURIComponent(prefix)}catch(err){throwError(state,"tag prefix is malformed: "+prefix)}state.tagMap[handle]=prefix}};function captureSegment(state,start,end,checkJson){var _position,_length,_character,_result;if(start<end){if(_result=state.input.slice(start,end),checkJson)for(_position=0,_length=_result.length;_position<_length;_position+=1)9===(_character=_result.charCodeAt(_position))||32<=_character&&_character<=1114111||throwError(state,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(_result)&&throwError(state,"the stream contains non-printable characters");state.result+=_result}}function mergeMappings(state,destination,source,overridableKeys){var sourceKeys,key,index,quantity;for(common.isObject(source)||throwError(state,"cannot merge mappings; the provided source object is unacceptable"),index=0,quantity=(sourceKeys=Object.keys(source)).length;index<quantity;index+=1)key=sourceKeys[index],_hasOwnProperty$1.call(destination,key)||(destination[key]=source[key],overridableKeys[key]=!0)}function storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,valueNode,startLine,startLineStart,startPos){var index,quantity;if(Array.isArray(keyNode))for(index=0,quantity=(keyNode=Array.prototype.slice.call(keyNode)).length;index<quantity;index+=1)Array.isArray(keyNode[index])&&throwError(state,"nested arrays are not supported inside keys"),"object"==typeof keyNode&&"[object Object]"===_class(keyNode[index])&&(keyNode[index]="[object Object]");if("object"==typeof keyNode&&"[object Object]"===_class(keyNode)&&(keyNode="[object Object]"),keyNode=String(keyNode),null===_result&&(_result={}),"tag:yaml.org,2002:merge"===keyTag)if(Array.isArray(valueNode))for(index=0,quantity=valueNode.length;index<quantity;index+=1)mergeMappings(state,_result,valueNode[index],overridableKeys);else mergeMappings(state,_result,valueNode,overridableKeys);else state.json||_hasOwnProperty$1.call(overridableKeys,keyNode)||!_hasOwnProperty$1.call(_result,keyNode)||(state.line=startLine||state.line,state.lineStart=startLineStart||state.lineStart,state.position=startPos||state.position,throwError(state,"duplicated mapping key")),"__proto__"===keyNode?Object.defineProperty(_result,keyNode,{configurable:!0,enumerable:!0,writable:!0,value:valueNode}):_result[keyNode]=valueNode,delete overridableKeys[keyNode];return _result}function readLineBreak(state){var ch;10===(ch=state.input.charCodeAt(state.position))?state.position++:13===ch?(state.position++,10===state.input.charCodeAt(state.position)&&state.position++):throwError(state,"a line break is expected"),state.line+=1,state.lineStart=state.position,state.firstTabInLine=-1}function skipSeparationSpace(state,allowComments,checkIndent){for(var lineBreaks=0,ch=state.input.charCodeAt(state.position);0!==ch;){for(;is_WHITE_SPACE(ch);)9===ch&&-1===state.firstTabInLine&&(state.firstTabInLine=state.position),ch=state.input.charCodeAt(++state.position);if(allowComments&&35===ch)do{ch=state.input.charCodeAt(++state.position)}while(10!==ch&&13!==ch&&0!==ch);if(!is_EOL(ch))break;for(readLineBreak(state),ch=state.input.charCodeAt(state.position),lineBreaks++,state.lineIndent=0;32===ch;)state.lineIndent++,ch=state.input.charCodeAt(++state.position)}return-1!==checkIndent&&0!==lineBreaks&&state.lineIndent<checkIndent&&throwWarning(state,"deficient indentation"),lineBreaks}function testDocumentSeparator(state){var ch,_position=state.position;return!(45!==(ch=state.input.charCodeAt(_position))&&46!==ch||ch!==state.input.charCodeAt(_position+1)||ch!==state.input.charCodeAt(_position+2)||(_position+=3,0!==(ch=state.input.charCodeAt(_position))&&!is_WS_OR_EOL(ch)))}function writeFoldedLines(state,count){1===count?state.result+=" ":count>1&&(state.result+=common.repeat("\n",count-1))}function readBlockSequence(state,nodeIndent){var _line,ch,_tag=state.tag,_anchor=state.anchor,_result=[],detected=!1;if(-1!==state.firstTabInLine)return!1;for(null!==state.anchor&&(state.anchorMap[state.anchor]=_result),ch=state.input.charCodeAt(state.position);0!==ch&&(-1!==state.firstTabInLine&&(state.position=state.firstTabInLine,throwError(state,"tab characters must not be used in indentation")),45===ch)&&is_WS_OR_EOL(state.input.charCodeAt(state.position+1));)if(detected=!0,state.position++,skipSeparationSpace(state,!0,-1)&&state.lineIndent<=nodeIndent)_result.push(null),ch=state.input.charCodeAt(state.position);else if(_line=state.line,composeNode(state,nodeIndent,3,!1,!0),_result.push(state.result),skipSeparationSpace(state,!0,-1),ch=state.input.charCodeAt(state.position),(state.line===_line||state.lineIndent>nodeIndent)&&0!==ch)throwError(state,"bad indentation of a sequence entry");else if(state.lineIndent<nodeIndent)break;return!!detected&&(state.tag=_tag,state.anchor=_anchor,state.kind="sequence",state.result=_result,!0)}function readTagProperty(state){var _position,tagHandle,tagName,ch,isVerbatim=!1,isNamed=!1;if(33!==(ch=state.input.charCodeAt(state.position)))return!1;if(null!==state.tag&&throwError(state,"duplication of a tag property"),60===(ch=state.input.charCodeAt(++state.position))?(isVerbatim=!0,ch=state.input.charCodeAt(++state.position)):33===ch?(isNamed=!0,tagHandle="!!",ch=state.input.charCodeAt(++state.position)):tagHandle="!",_position=state.position,isVerbatim){do{ch=state.input.charCodeAt(++state.position)}while(0!==ch&&62!==ch);state.position<state.length?(tagName=state.input.slice(_position,state.position),ch=state.input.charCodeAt(++state.position)):throwError(state,"unexpected end of the stream within a verbatim tag")}else{for(;0!==ch&&!is_WS_OR_EOL(ch);)33===ch&&(isNamed?throwError(state,"tag suffix cannot contain exclamation marks"):(tagHandle=state.input.slice(_position-1,state.position+1),PATTERN_TAG_HANDLE.test(tagHandle)||throwError(state,"named tag handle cannot contain such characters"),isNamed=!0,_position=state.position+1)),ch=state.input.charCodeAt(++state.position);tagName=state.input.slice(_position,state.position),PATTERN_FLOW_INDICATORS.test(tagName)&&throwError(state,"tag suffix cannot contain flow indicator characters")}tagName&&!PATTERN_TAG_URI.test(tagName)&&throwError(state,"tag name cannot contain such characters: "+tagName);try{tagName=decodeURIComponent(tagName)}catch(err){throwError(state,"tag name is malformed: "+tagName)}return isVerbatim?state.tag=tagName:_hasOwnProperty$1.call(state.tagMap,tagHandle)?state.tag=state.tagMap[tagHandle]+tagName:"!"===tagHandle?state.tag="!"+tagName:"!!"===tagHandle?state.tag="tag:yaml.org,2002:"+tagName:throwError(state,'undeclared tag handle "'+tagHandle+'"'),!0}function readAnchorProperty(state){var _position,ch;if(38!==(ch=state.input.charCodeAt(state.position)))return!1;for(null!==state.anchor&&throwError(state,"duplication of an anchor property"),ch=state.input.charCodeAt(++state.position),_position=state.position;0!==ch&&!is_WS_OR_EOL(ch)&&!is_FLOW_INDICATOR(ch);)ch=state.input.charCodeAt(++state.position);return state.position===_position&&throwError(state,"name of an anchor node must contain at least one character"),state.anchor=state.input.slice(_position,state.position),!0}function composeNode(state,parentIndent,nodeContext,allowToSeek,allowCompact){var allowBlockStyles,allowBlockScalars,allowBlockCollections,typeIndex,typeQuantity,typeList,type,flowIndent,blockIndent,indentStatus=1,atNewLine=!1,hasContent=!1;if(null!==state.listener&&state.listener("open",state),state.tag=null,state.anchor=null,state.kind=null,state.result=null,allowBlockStyles=allowBlockScalars=allowBlockCollections=4===nodeContext||3===nodeContext,allowToSeek&&skipSeparationSpace(state,!0,-1)&&(atNewLine=!0,state.lineIndent>parentIndent?indentStatus=1:state.lineIndent===parentIndent?indentStatus=0:state.lineIndent<parentIndent&&(indentStatus=-1)),1===indentStatus)for(;readTagProperty(state)||readAnchorProperty(state);)skipSeparationSpace(state,!0,-1)?(atNewLine=!0,allowBlockCollections=allowBlockStyles,state.lineIndent>parentIndent?indentStatus=1:state.lineIndent===parentIndent?indentStatus=0:state.lineIndent<parentIndent&&(indentStatus=-1)):allowBlockCollections=!1;if(allowBlockCollections&&(allowBlockCollections=atNewLine||allowCompact),1!==indentStatus&&4!==nodeContext||(flowIndent=1===nodeContext||2===nodeContext?parentIndent:parentIndent+1,blockIndent=state.position-state.lineStart,1===indentStatus?allowBlockCollections&&(readBlockSequence(state,blockIndent)||function(state,nodeIndent,flowIndent){var following,allowCompact,_line,_keyLine,_keyLineStart,_keyPos,ch,_tag=state.tag,_anchor=state.anchor,_result={},overridableKeys=Object.create(null),keyTag=null,keyNode=null,valueNode=null,atExplicitKey=!1,detected=!1;if(-1!==state.firstTabInLine)return!1;for(null!==state.anchor&&(state.anchorMap[state.anchor]=_result),ch=state.input.charCodeAt(state.position);0!==ch;){if(atExplicitKey||-1===state.firstTabInLine||(state.position=state.firstTabInLine,throwError(state,"tab characters must not be used in indentation")),following=state.input.charCodeAt(state.position+1),_line=state.line,63!==ch&&58!==ch||!is_WS_OR_EOL(following)){if(_keyLine=state.line,_keyLineStart=state.lineStart,_keyPos=state.position,!composeNode(state,flowIndent,2,!1,!0))break;if(state.line===_line){for(ch=state.input.charCodeAt(state.position);is_WHITE_SPACE(ch);)ch=state.input.charCodeAt(++state.position);if(58===ch)is_WS_OR_EOL(ch=state.input.charCodeAt(++state.position))||throwError(state,"a whitespace character is expected after the key-value separator within a block mapping"),atExplicitKey&&(storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,null,_keyLine,_keyLineStart,_keyPos),keyTag=keyNode=valueNode=null),detected=!0,atExplicitKey=!1,allowCompact=!1,keyTag=state.tag,keyNode=state.result;else{if(!detected)return state.tag=_tag,state.anchor=_anchor,!0;throwError(state,"can not read an implicit mapping pair; a colon is missed")}}else{if(!detected)return state.tag=_tag,state.anchor=_anchor,!0;throwError(state,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===ch?(atExplicitKey&&(storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,null,_keyLine,_keyLineStart,_keyPos),keyTag=keyNode=valueNode=null),detected=!0,atExplicitKey=!0,allowCompact=!0):atExplicitKey?(atExplicitKey=!1,allowCompact=!0):throwError(state,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),state.position+=1,ch=following;if((state.line===_line||state.lineIndent>nodeIndent)&&(atExplicitKey&&(_keyLine=state.line,_keyLineStart=state.lineStart,_keyPos=state.position),composeNode(state,nodeIndent,4,!0,allowCompact)&&(atExplicitKey?keyNode=state.result:valueNode=state.result),atExplicitKey||(storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,valueNode,_keyLine,_keyLineStart,_keyPos),keyTag=keyNode=valueNode=null),skipSeparationSpace(state,!0,-1),ch=state.input.charCodeAt(state.position)),(state.line===_line||state.lineIndent>nodeIndent)&&0!==ch)throwError(state,"bad indentation of a mapping entry");else if(state.lineIndent<nodeIndent)break}return atExplicitKey&&storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,null,_keyLine,_keyLineStart,_keyPos),detected&&(state.tag=_tag,state.anchor=_anchor,state.kind="mapping",state.result=_result),detected}(state,blockIndent,flowIndent))||function(state,nodeIndent){var _line,_lineStart,_pos,_result,terminator,isPair,isExplicitPair,isMapping,keyNode,keyTag,valueNode,ch,readNext=!0,_tag=state.tag,_anchor=state.anchor,overridableKeys=Object.create(null);if(91===(ch=state.input.charCodeAt(state.position)))terminator=93,isMapping=!1,_result=[];else{if(123!==ch)return!1;terminator=125,isMapping=!0,_result={}}for(null!==state.anchor&&(state.anchorMap[state.anchor]=_result),ch=state.input.charCodeAt(++state.position);0!==ch;){if(skipSeparationSpace(state,!0,nodeIndent),(ch=state.input.charCodeAt(state.position))===terminator)return state.position++,state.tag=_tag,state.anchor=_anchor,state.kind=isMapping?"mapping":"sequence",state.result=_result,!0;readNext?44===ch&&throwError(state,"expected the node content, but found ','"):throwError(state,"missed comma between flow collection entries"),valueNode=null,isPair=isExplicitPair=!1,63===ch&&is_WS_OR_EOL(state.input.charCodeAt(state.position+1))&&(isPair=isExplicitPair=!0,state.position++,skipSeparationSpace(state,!0,nodeIndent)),_line=state.line,_lineStart=state.lineStart,_pos=state.position,composeNode(state,nodeIndent,1,!1,!0),keyTag=state.tag,keyNode=state.result,skipSeparationSpace(state,!0,nodeIndent),ch=state.input.charCodeAt(state.position),!isExplicitPair&&state.line!==_line||58!==ch||(isPair=!0,ch=state.input.charCodeAt(++state.position),skipSeparationSpace(state,!0,nodeIndent),composeNode(state,nodeIndent,1,!1,!0),valueNode=state.result),isMapping?storeMappingPair(state,_result,overridableKeys,keyTag,keyNode,valueNode,_line,_lineStart,_pos):isPair?_result.push(storeMappingPair(state,null,overridableKeys,keyTag,keyNode,valueNode,_line,_lineStart,_pos)):_result.push(keyNode),skipSeparationSpace(state,!0,nodeIndent),44===(ch=state.input.charCodeAt(state.position))?(readNext=!0,ch=state.input.charCodeAt(++state.position)):readNext=!1}throwError(state,"unexpected end of the stream within a flow collection")}(state,flowIndent)?hasContent=!0:(allowBlockScalars&&function(state,nodeIndent){var captureStart,folding,tmp,ch,c,chomping=1,didReadContent=!1,detectedIndent=!1,textIndent=nodeIndent,emptyLines=0,atMoreIndented=!1;if(124===(ch=state.input.charCodeAt(state.position)))folding=!1;else{if(62!==ch)return!1;folding=!0}for(state.kind="scalar",state.result="";0!==ch;)if(43===(ch=state.input.charCodeAt(++state.position))||45===ch)1===chomping?chomping=43===ch?3:2:throwError(state,"repeat of a chomping mode identifier");else{if(!((tmp=48<=(c=ch)&&c<=57?c-48:-1)>=0))break;0===tmp?throwError(state,"bad explicit indentation width of a block scalar; it cannot be less than one"):detectedIndent?throwError(state,"repeat of an indentation width identifier"):(textIndent=nodeIndent+tmp-1,detectedIndent=!0)}if(is_WHITE_SPACE(ch)){do{ch=state.input.charCodeAt(++state.position)}while(is_WHITE_SPACE(ch));if(35===ch)do{ch=state.input.charCodeAt(++state.position)}while(!is_EOL(ch)&&0!==ch)}for(;0!==ch;){for(readLineBreak(state),state.lineIndent=0,ch=state.input.charCodeAt(state.position);(!detectedIndent||state.lineIndent<textIndent)&&32===ch;)state.lineIndent++,ch=state.input.charCodeAt(++state.position);if(!detectedIndent&&state.lineIndent>textIndent&&(textIndent=state.lineIndent),is_EOL(ch))emptyLines++;else{if(state.lineIndent<textIndent){3===chomping?state.result+=common.repeat("\n",didReadContent?1+emptyLines:emptyLines):1===chomping&&didReadContent&&(state.result+="\n");break}for(folding?is_WHITE_SPACE(ch)?(atMoreIndented=!0,state.result+=common.repeat("\n",didReadContent?1+emptyLines:emptyLines)):atMoreIndented?(atMoreIndented=!1,state.result+=common.repeat("\n",emptyLines+1)):0===emptyLines?didReadContent&&(state.result+=" "):state.result+=common.repeat("\n",emptyLines):state.result+=common.repeat("\n",didReadContent?1+emptyLines:emptyLines),didReadContent=!0,detectedIndent=!0,emptyLines=0,captureStart=state.position;!is_EOL(ch)&&0!==ch;)ch=state.input.charCodeAt(++state.position);captureSegment(state,captureStart,state.position,!1)}}return!0}(state,flowIndent)||function(state,nodeIndent){var ch,captureStart,captureEnd;if(39!==(ch=state.input.charCodeAt(state.position)))return!1;for(state.kind="scalar",state.result="",state.position++,captureStart=captureEnd=state.position;0!==(ch=state.input.charCodeAt(state.position));)if(39===ch){if(captureSegment(state,captureStart,state.position,!0),39!==(ch=state.input.charCodeAt(++state.position)))return!0;captureStart=state.position,state.position++,captureEnd=state.position}else is_EOL(ch)?(captureSegment(state,captureStart,captureEnd,!0),writeFoldedLines(state,skipSeparationSpace(state,!1,nodeIndent)),captureStart=captureEnd=state.position):state.position===state.lineStart&&testDocumentSeparator(state)?throwError(state,"unexpected end of the document within a single quoted scalar"):(state.position++,captureEnd=state.position);throwError(state,"unexpected end of the stream within a single quoted scalar")}(state,flowIndent)||function(state,nodeIndent){var captureStart,captureEnd,hexLength,hexResult,tmp,ch,c;if(34!==(ch=state.input.charCodeAt(state.position)))return!1;for(state.kind="scalar",state.result="",state.position++,captureStart=captureEnd=state.position;0!==(ch=state.input.charCodeAt(state.position));){if(34===ch)return captureSegment(state,captureStart,state.position,!0),state.position++,!0;if(92===ch){if(captureSegment(state,captureStart,state.position,!0),is_EOL(ch=state.input.charCodeAt(++state.position)))skipSeparationSpace(state,!1,nodeIndent);else if(ch<256&&simpleEscapeCheck[ch])state.result+=simpleEscapeMap[ch],state.position++;else if((tmp=120===(c=ch)?2:117===c?4:85===c?8:0)>0){for(hexLength=tmp,hexResult=0;hexLength>0;hexLength--)(tmp=fromHexCode(ch=state.input.charCodeAt(++state.position)))>=0?hexResult=(hexResult<<4)+tmp:throwError(state,"expected hexadecimal character");state.result+=charFromCodepoint(hexResult),state.position++}else throwError(state,"unknown escape sequence");captureStart=captureEnd=state.position}else is_EOL(ch)?(captureSegment(state,captureStart,captureEnd,!0),writeFoldedLines(state,skipSeparationSpace(state,!1,nodeIndent)),captureStart=captureEnd=state.position):state.position===state.lineStart&&testDocumentSeparator(state)?throwError(state,"unexpected end of the document within a double quoted scalar"):(state.position++,captureEnd=state.position)}throwError(state,"unexpected end of the stream within a double quoted scalar")}(state,flowIndent)?hasContent=!0:function(state){var _position,alias,ch;if(42!==(ch=state.input.charCodeAt(state.position)))return!1;for(ch=state.input.charCodeAt(++state.position),_position=state.position;0!==ch&&!is_WS_OR_EOL(ch)&&!is_FLOW_INDICATOR(ch);)ch=state.input.charCodeAt(++state.position);return state.position===_position&&throwError(state,"name of an alias node must contain at least one character"),alias=state.input.slice(_position,state.position),_hasOwnProperty$1.call(state.anchorMap,alias)||throwError(state,'unidentified alias "'+alias+'"'),state.result=state.anchorMap[alias],skipSeparationSpace(state,!0,-1),!0}(state)?(hasContent=!0,null===state.tag&&null===state.anchor||throwError(state,"alias node should not have any properties")):function(state,nodeIndent,withinFlowCollection){var following,captureStart,captureEnd,hasPendingContent,_line,_lineStart,_lineIndent,ch,_kind=state.kind,_result=state.result;if(is_WS_OR_EOL(ch=state.input.charCodeAt(state.position))||is_FLOW_INDICATOR(ch)||35===ch||38===ch||42===ch||33===ch||124===ch||62===ch||39===ch||34===ch||37===ch||64===ch||96===ch)return!1;if((63===ch||45===ch)&&(is_WS_OR_EOL(following=state.input.charCodeAt(state.position+1))||withinFlowCollection&&is_FLOW_INDICATOR(following)))return!1;for(state.kind="scalar",state.result="",captureStart=captureEnd=state.position,hasPendingContent=!1;0!==ch;){if(58===ch){if(is_WS_OR_EOL(following=state.input.charCodeAt(state.position+1))||withinFlowCollection&&is_FLOW_INDICATOR(following))break}else if(35===ch){if(is_WS_OR_EOL(state.input.charCodeAt(state.position-1)))break}else{if(state.position===state.lineStart&&testDocumentSeparator(state)||withinFlowCollection&&is_FLOW_INDICATOR(ch))break;if(is_EOL(ch)){if(_line=state.line,_lineStart=state.lineStart,_lineIndent=state.lineIndent,skipSeparationSpace(state,!1,-1),state.lineIndent>=nodeIndent){hasPendingContent=!0,ch=state.input.charCodeAt(state.position);continue}state.position=captureEnd,state.line=_line,state.lineStart=_lineStart,state.lineIndent=_lineIndent;break}}hasPendingContent&&(captureSegment(state,captureStart,captureEnd,!1),writeFoldedLines(state,state.line-_line),captureStart=captureEnd=state.position,hasPendingContent=!1),is_WHITE_SPACE(ch)||(captureEnd=state.position+1),ch=state.input.charCodeAt(++state.position)}return captureSegment(state,captureStart,captureEnd,!1),!!state.result||(state.kind=_kind,state.result=_result,!1)}(state,flowIndent,1===nodeContext)&&(hasContent=!0,null===state.tag&&(state.tag="?")),null!==state.anchor&&(state.anchorMap[state.anchor]=state.result)):0===indentStatus&&(hasContent=allowBlockCollections&&readBlockSequence(state,blockIndent))),null===state.tag)null!==state.anchor&&(state.anchorMap[state.anchor]=state.result);else if("?"===state.tag){for(null!==state.result&&"scalar"!==state.kind&&throwError(state,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+state.kind+'"'),typeIndex=0,typeQuantity=state.implicitTypes.length;typeIndex<typeQuantity;typeIndex+=1)if((type=state.implicitTypes[typeIndex]).resolve(state.result)){state.result=type.construct(state.result),state.tag=type.tag,null!==state.anchor&&(state.anchorMap[state.anchor]=state.result);break}}else if("!"!==state.tag){if(_hasOwnProperty$1.call(state.typeMap[state.kind||"fallback"],state.tag))type=state.typeMap[state.kind||"fallback"][state.tag];else for(type=null,typeIndex=0,typeQuantity=(typeList=state.typeMap.multi[state.kind||"fallback"]).length;typeIndex<typeQuantity;typeIndex+=1)if(state.tag.slice(0,typeList[typeIndex].tag.length)===typeList[typeIndex].tag){type=typeList[typeIndex];break}type||throwError(state,"unknown tag !<"+state.tag+">"),null!==state.result&&type.kind!==state.kind&&throwError(state,"unacceptable node kind for !<"+state.tag+'> tag; it should be "'+type.kind+'", not "'+state.kind+'"'),type.resolve(state.result,state.tag)?(state.result=type.construct(state.result,state.tag),null!==state.anchor&&(state.anchorMap[state.anchor]=state.result)):throwError(state,"cannot resolve a node with !<"+state.tag+"> explicit tag")}return null!==state.listener&&state.listener("close",state),null!==state.tag||null!==state.anchor||hasContent}function readDocument(state){var _position,directiveName,directiveArgs,ch,documentStart=state.position,hasDirectives=!1;for(state.version=null,state.checkLineBreaks=state.legacy,state.tagMap=Object.create(null),state.anchorMap=Object.create(null);0!==(ch=state.input.charCodeAt(state.position))&&(skipSeparationSpace(state,!0,-1),ch=state.input.charCodeAt(state.position),!(state.lineIndent>0||37!==ch));){for(hasDirectives=!0,ch=state.input.charCodeAt(++state.position),_position=state.position;0!==ch&&!is_WS_OR_EOL(ch);)ch=state.input.charCodeAt(++state.position);for(directiveArgs=[],(directiveName=state.input.slice(_position,state.position)).length<1&&throwError(state,"directive name must not be less than one character in length");0!==ch;){for(;is_WHITE_SPACE(ch);)ch=state.input.charCodeAt(++state.position);if(35===ch){do{ch=state.input.charCodeAt(++state.position)}while(0!==ch&&!is_EOL(ch));break}if(is_EOL(ch))break;for(_position=state.position;0!==ch&&!is_WS_OR_EOL(ch);)ch=state.input.charCodeAt(++state.position);directiveArgs.push(state.input.slice(_position,state.position))}0!==ch&&readLineBreak(state),_hasOwnProperty$1.call(directiveHandlers,directiveName)?directiveHandlers[directiveName](state,directiveName,directiveArgs):throwWarning(state,'unknown document directive "'+directiveName+'"')}skipSeparationSpace(state,!0,-1),0===state.lineIndent&&45===state.input.charCodeAt(state.position)&&45===state.input.charCodeAt(state.position+1)&&45===state.input.charCodeAt(state.position+2)?(state.position+=3,skipSeparationSpace(state,!0,-1)):hasDirectives&&throwError(state,"directives end mark is expected"),composeNode(state,state.lineIndent-1,4,!1,!0),skipSeparationSpace(state,!0,-1),state.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart,state.position))&&throwWarning(state,"non-ASCII line breaks are interpreted as content"),state.documents.push(state.result),state.position===state.lineStart&&testDocumentSeparator(state)?46===state.input.charCodeAt(state.position)&&(state.position+=3,skipSeparationSpace(state,!0,-1)):state.position<state.length-1&&throwError(state,"end of the stream or a document separator is expected")}function loadDocuments(input,options){options=options||{},0!==(input=String(input)).length&&(10!==input.charCodeAt(input.length-1)&&13!==input.charCodeAt(input.length-1)&&(input+="\n"),65279===input.charCodeAt(0)&&(input=input.slice(1)));var state=new State$1(input,options),nullpos=input.indexOf("\0");for(-1!==nullpos&&(state.position=nullpos,throwError(state,"null byte is not allowed in input")),state.input+="\0";32===state.input.charCodeAt(state.position);)state.lineIndent+=1,state.position+=1;for(;state.position<state.length-1;)readDocument(state);return state.documents}var loader_load=function(input,options){var documents=loadDocuments(input,options);if(0!==documents.length){if(1===documents.length)return documents[0];throw new exception("expected a single document in the stream, but found more")}},_toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function encodeHex(character){var string,handle,length;if(string=character.toString(16).toUpperCase(),character<=255)handle="x",length=2;else if(character<=65535)handle="u",length=4;else{if(!(character<=4294967295))throw new exception("code point within a string may not be greater than 0xFFFFFFFF");handle="U",length=8}return"\\"+handle+common.repeat("0",length-string.length)+string}function State(options){this.schema=options.schema||_default,this.indent=Math.max(1,options.indent||2),this.noArrayIndent=options.noArrayIndent||!1,this.skipInvalid=options.skipInvalid||!1,this.flowLevel=common.isNothing(options.flowLevel)?-1:options.flowLevel,this.styleMap=function(schema,map){var result,keys,index,length,tag,style,type;if(null===map)return{};for(result={},index=0,length=(keys=Object.keys(map)).length;index<length;index+=1)tag=keys[index],style=String(map[tag]),"!!"===tag.slice(0,2)&&(tag="tag:yaml.org,2002:"+tag.slice(2)),(type=schema.compiledTypeMap.fallback[tag])&&_hasOwnProperty.call(type.styleAliases,style)&&(style=type.styleAliases[style]),result[tag]=style;return result}(this.schema,options.styles||null),this.sortKeys=options.sortKeys||!1,this.lineWidth=options.lineWidth||80,this.noRefs=options.noRefs||!1,this.noCompatMode=options.noCompatMode||!1,this.condenseFlow=options.condenseFlow||!1,this.quotingType='"'===options.quotingType?2:1,this.forceQuotes=options.forceQuotes||!1,this.replacer="function"==typeof options.replacer?options.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(string,spaces){for(var line,ind=common.repeat(" ",spaces),position=0,next=-1,result="",length=string.length;position<length;)-1===(next=string.indexOf("\n",position))?(line=string.slice(position),position=length):(line=string.slice(position,next+1),position=next+1),line.length&&"\n"!==line&&(result+=ind),result+=line;return result}function generateNextLine(state,level){return"\n"+common.repeat(" ",state.indent*level)}function isWhitespace(c){return 32===c||9===c}function isPrintable(c){return 32<=c&&c<=126||161<=c&&c<=55295&&8232!==c&&8233!==c||57344<=c&&c<=65533&&65279!==c||65536<=c&&c<=1114111}function isNsCharOrWhitespace(c){return isPrintable(c)&&65279!==c&&13!==c&&10!==c}function isPlainSafe(c,prev,inblock){var cIsNsCharOrWhitespace=isNsCharOrWhitespace(c),cIsNsChar=cIsNsCharOrWhitespace&&!isWhitespace(c);return(inblock?cIsNsCharOrWhitespace:cIsNsCharOrWhitespace&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c)&&35!==c&&!(58===prev&&!cIsNsChar)||isNsCharOrWhitespace(prev)&&!isWhitespace(prev)&&35===c||58===prev&&cIsNsChar}function codePointAt(string,pos){var second,first=string.charCodeAt(pos);return first>=55296&&first<=56319&&pos+1<string.length&&(second=string.charCodeAt(pos+1))>=56320&&second<=57343?1024*(first-55296)+second-56320+65536:first}function needIndentIndicator(string){return/^\n* /.test(string)}function writeScalar(state,string,level,iskey,inblock){state.dump=function(){if(0===string.length)return 2===state.quotingType?'""':"''";if(!state.noCompatMode&&(-1!==DEPRECATED_BOOLEANS_SYNTAX.indexOf(string)||DEPRECATED_BASE60_SYNTAX.test(string)))return 2===state.quotingType?'"'+string+'"':"'"+string+"'";var indent=state.indent*Math.max(1,level),lineWidth=-1===state.lineWidth?-1:Math.max(Math.min(state.lineWidth,40),state.lineWidth-indent),singleLineOnly=iskey||state.flowLevel>-1&&level>=state.flowLevel;switch(function(string,singleLineOnly,indentPerLevel,lineWidth,testAmbiguousType,quotingType,forceQuotes,inblock){var i,c,char=0,prevChar=null,hasLineBreak=!1,hasFoldableLine=!1,shouldTrackWidth=-1!==lineWidth,previousLineBreak=-1,plain=isPrintable(c=codePointAt(string,0))&&65279!==c&&!isWhitespace(c)&&45!==c&&63!==c&&58!==c&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c&&35!==c&&38!==c&&42!==c&&33!==c&&124!==c&&61!==c&&62!==c&&39!==c&&34!==c&&37!==c&&64!==c&&96!==c&&function(c){return!isWhitespace(c)&&58!==c}(codePointAt(string,string.length-1));if(singleLineOnly||forceQuotes)for(i=0;i<string.length;char>=65536?i+=2:i++){if(!isPrintable(char=codePointAt(string,i)))return 5;plain=plain&&isPlainSafe(char,prevChar,inblock),prevChar=char}else{for(i=0;i<string.length;char>=65536?i+=2:i++){if(10===(char=codePointAt(string,i)))hasLineBreak=!0,shouldTrackWidth&&(hasFoldableLine=hasFoldableLine||i-previousLineBreak-1>lineWidth&&" "!==string[previousLineBreak+1],previousLineBreak=i);else if(!isPrintable(char))return 5;plain=plain&&isPlainSafe(char,prevChar,inblock),prevChar=char}hasFoldableLine=hasFoldableLine||shouldTrackWidth&&i-previousLineBreak-1>lineWidth&&" "!==string[previousLineBreak+1]}return hasLineBreak||hasFoldableLine?indentPerLevel>9&&needIndentIndicator(string)?5:forceQuotes?2===quotingType?5:2:hasFoldableLine?4:3:!plain||forceQuotes||testAmbiguousType(string)?2===quotingType?5:2:1}(string,singleLineOnly,state.indent,lineWidth,(function(string){return function(state,str){var index,length;for(index=0,length=state.implicitTypes.length;index<length;index+=1)if(state.implicitTypes[index].resolve(str))return!0;return!1}(state,string)}),state.quotingType,state.forceQuotes&&!iskey,inblock)){case 1:return string;case 2:return"'"+string.replace(/'/g,"''")+"'";case 3:return"|"+blockHeader(string,state.indent)+dropEndingNewline(indentString(string,indent));case 4:return">"+blockHeader(string,state.indent)+dropEndingNewline(indentString(function(string,width){for(var moreIndented,match,nextLF,lineRe=/(\n+)([^\n]*)/g,result=(nextLF=-1!==(nextLF=string.indexOf("\n"))?nextLF:string.length,lineRe.lastIndex=nextLF,foldLine(string.slice(0,nextLF),width)),prevMoreIndented="\n"===string[0]||" "===string[0];match=lineRe.exec(string);){var prefix=match[1],line=match[2];moreIndented=" "===line[0],result+=prefix+(prevMoreIndented||moreIndented||""===line?"":"\n")+foldLine(line,width),prevMoreIndented=moreIndented}return result}(string,lineWidth),indent));case 5:return'"'+function(string){for(var escapeSeq,result="",char=0,i=0;i<string.length;char>=65536?i+=2:i++)char=codePointAt(string,i),!(escapeSeq=ESCAPE_SEQUENCES[char])&&isPrintable(char)?(result+=string[i],char>=65536&&(result+=string[i+1])):result+=escapeSeq||encodeHex(char);return result}(string)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(string,indentPerLevel){var indentIndicator=needIndentIndicator(string)?String(indentPerLevel):"",clip="\n"===string[string.length-1];return indentIndicator+(!clip||"\n"!==string[string.length-2]&&"\n"!==string?clip?"":"-":"+")+"\n"}function dropEndingNewline(string){return"\n"===string[string.length-1]?string.slice(0,-1):string}function foldLine(line,width){if(""===line||" "===line[0])return line;for(var match,end,breakRe=/ [^ ]/g,start=0,curr=0,next=0,result="";match=breakRe.exec(line);)(next=match.index)-start>width&&(end=curr>start?curr:next,result+="\n"+line.slice(start,end),start=end+1),curr=next;return result+="\n",line.length-start>width&&curr>start?result+=line.slice(start,curr)+"\n"+line.slice(curr+1):result+=line.slice(start),result.slice(1)}function writeBlockSequence(state,level,object,compact){var index,length,value,_result="",_tag=state.tag;for(index=0,length=object.length;index<length;index+=1)value=object[index],state.replacer&&(value=state.replacer.call(object,String(index),value)),(writeNode(state,level+1,value,!0,!0,!1,!0)||void 0===value&&writeNode(state,level+1,null,!0,!0,!1,!0))&&(compact&&""===_result||(_result+=generateNextLine(state,level)),state.dump&&10===state.dump.charCodeAt(0)?_result+="-":_result+="- ",_result+=state.dump);state.tag=_tag,state.dump=_result||"[]"}function detectType(state,object,explicit){var _result,typeList,index,length,type,style;for(index=0,length=(typeList=explicit?state.explicitTypes:state.implicitTypes).length;index<length;index+=1)if(((type=typeList[index]).instanceOf||type.predicate)&&(!type.instanceOf||"object"==typeof object&&object instanceof type.instanceOf)&&(!type.predicate||type.predicate(object))){if(explicit?type.multi&&type.representName?state.tag=type.representName(object):state.tag=type.tag:state.tag="?",type.represent){if(style=state.styleMap[type.tag]||type.defaultStyle,"[object Function]"===_toString.call(type.represent))_result=type.represent(object,style);else{if(!_hasOwnProperty.call(type.represent,style))throw new exception("!<"+type.tag+'> tag resolver accepts not "'+style+'" style');_result=type.represent[style](object,style)}state.dump=_result}return!0}return!1}function writeNode(state,level,object,block,compact,iskey,isblockseq){state.tag=null,state.dump=object,detectType(state,object,!1)||detectType(state,object,!0);var tagStr,type=_toString.call(state.dump),inblock=block;block&&(block=state.flowLevel<0||state.flowLevel>level);var duplicateIndex,duplicate,objectOrArray="[object Object]"===type||"[object Array]"===type;if(objectOrArray&&(duplicate=-1!==(duplicateIndex=state.duplicates.indexOf(object))),(null!==state.tag&&"?"!==state.tag||duplicate||2!==state.indent&&level>0)&&(compact=!1),duplicate&&state.usedDuplicates[duplicateIndex])state.dump="*ref_"+duplicateIndex;else{if(objectOrArray&&duplicate&&!state.usedDuplicates[duplicateIndex]&&(state.usedDuplicates[duplicateIndex]=!0),"[object Object]"===type)block&&0!==Object.keys(state.dump).length?(function(state,level,object,compact){var index,length,objectKey,objectValue,explicitPair,pairBuffer,_result="",_tag=state.tag,objectKeyList=Object.keys(object);if(!0===state.sortKeys)objectKeyList.sort();else if("function"==typeof state.sortKeys)objectKeyList.sort(state.sortKeys);else if(state.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(index=0,length=objectKeyList.length;index<length;index+=1)pairBuffer="",compact&&""===_result||(pairBuffer+=generateNextLine(state,level)),objectValue=object[objectKey=objectKeyList[index]],state.replacer&&(objectValue=state.replacer.call(object,objectKey,objectValue)),writeNode(state,level+1,objectKey,!0,!0,!0)&&((explicitPair=null!==state.tag&&"?"!==state.tag||state.dump&&state.dump.length>1024)&&(state.dump&&10===state.dump.charCodeAt(0)?pairBuffer+="?":pairBuffer+="? "),pairBuffer+=state.dump,explicitPair&&(pairBuffer+=generateNextLine(state,level)),writeNode(state,level+1,objectValue,!0,explicitPair)&&(state.dump&&10===state.dump.charCodeAt(0)?pairBuffer+=":":pairBuffer+=": ",_result+=pairBuffer+=state.dump));state.tag=_tag,state.dump=_result||"{}"}(state,level,state.dump,compact),duplicate&&(state.dump="&ref_"+duplicateIndex+state.dump)):(function(state,level,object){var index,length,objectKey,objectValue,pairBuffer,_result="",_tag=state.tag,objectKeyList=Object.keys(object);for(index=0,length=objectKeyList.length;index<length;index+=1)pairBuffer="",""!==_result&&(pairBuffer+=", "),state.condenseFlow&&(pairBuffer+='"'),objectValue=object[objectKey=objectKeyList[index]],state.replacer&&(objectValue=state.replacer.call(object,objectKey,objectValue)),writeNode(state,level,objectKey,!1,!1)&&(state.dump.length>1024&&(pairBuffer+="? "),pairBuffer+=state.dump+(state.condenseFlow?'"':"")+":"+(state.condenseFlow?"":" "),writeNode(state,level,objectValue,!1,!1)&&(_result+=pairBuffer+=state.dump));state.tag=_tag,state.dump="{"+_result+"}"}(state,level,state.dump),duplicate&&(state.dump="&ref_"+duplicateIndex+" "+state.dump));else if("[object Array]"===type)block&&0!==state.dump.length?(state.noArrayIndent&&!isblockseq&&level>0?writeBlockSequence(state,level-1,state.dump,compact):writeBlockSequence(state,level,state.dump,compact),duplicate&&(state.dump="&ref_"+duplicateIndex+state.dump)):(function(state,level,object){var index,length,value,_result="",_tag=state.tag;for(index=0,length=object.length;index<length;index+=1)value=object[index],state.replacer&&(value=state.replacer.call(object,String(index),value)),(writeNode(state,level,value,!1,!1)||void 0===value&&writeNode(state,level,null,!1,!1))&&(""!==_result&&(_result+=","+(state.condenseFlow?"":" ")),_result+=state.dump);state.tag=_tag,state.dump="["+_result+"]"}(state,level,state.dump),duplicate&&(state.dump="&ref_"+duplicateIndex+" "+state.dump));else{if("[object String]"!==type){if("[object Undefined]"===type)return!1;if(state.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+type)}"?"!==state.tag&&writeScalar(state,state.dump,level,iskey,inblock)}null!==state.tag&&"?"!==state.tag&&(tagStr=encodeURI("!"===state.tag[0]?state.tag.slice(1):state.tag).replace(/!/g,"%21"),tagStr="!"===state.tag[0]?"!"+tagStr:"tag:yaml.org,2002:"===tagStr.slice(0,18)?"!!"+tagStr.slice(18):"!<"+tagStr+">",state.dump=tagStr+" "+state.dump)}return!0}function getDuplicateReferences(object,state){var index,length,objects=[],duplicatesIndexes=[];for(inspectNode(object,objects,duplicatesIndexes),index=0,length=duplicatesIndexes.length;index<length;index+=1)state.duplicates.push(objects[duplicatesIndexes[index]]);state.usedDuplicates=new Array(length)}function inspectNode(object,objects,duplicatesIndexes){var objectKeyList,index,length;if(null!==object&&"object"==typeof object)if(-1!==(index=objects.indexOf(object)))-1===duplicatesIndexes.indexOf(index)&&duplicatesIndexes.push(index);else if(objects.push(object),Array.isArray(object))for(index=0,length=object.length;index<length;index+=1)inspectNode(object[index],objects,duplicatesIndexes);else for(index=0,length=(objectKeyList=Object.keys(object)).length;index<length;index+=1)inspectNode(object[objectKeyList[index]],objects,duplicatesIndexes)}var load=loader_load,dump=function(input,options){var state=new State(options=options||{});state.noRefs||getDuplicateReferences(input,state);var value=input;return state.replacer&&(value=state.replacer.call({"":value},"",value)),writeNode(state,0,value,!0,!0)?state.dump+"\n":""},YAMLException=exception;const headerRegex=/^(\s*)(#+)(\s+)(.*)$/,yamlRegex=/^---\n((?:(((?!---)(?:.|\n)*?)\n)?))---(?=\n|$)/,wikiLinkRegex=/(!?)(\[{2}[^[\n\]]*\]{2})/g,genericLinkRegex=/^!?\[.*\](.*)$/,wordSplitterRegex=/[,\s]+/;function escapeDollarSigns(str){return str.replace(/\$/g,"$$$$")}function initYAML(text){return null===text.match(yamlRegex)&&(text="---\n---\n"+text),text}function formatYAML(text,func){if(!text.match(yamlRegex))return text;const oldYaml=text.match(yamlRegex)[0],newYaml=func(oldYaml);return text.replace(oldYaml,escapeDollarSigns(newYaml))}function toYamlString(obj){return dump(obj,{lineWidth:-1}).slice(0,-1)}function getYamlSectionRegExp(rawKey){return new RegExp(`(?<=^|\\n)${rawKey}:[ \\t]*(\\S.*|(?:(?:\\n *- \\S.*)|((?:\\n *- *))*)*)\\n`)}function setYamlSection(yaml,rawKey,rawValue){const yamlSectionEscaped=`${rawKey}:${rawValue}\n`;let isReplaced=!1,result=yaml.replace(getYamlSectionRegExp(rawKey),(()=>(isReplaced=!0,yamlSectionEscaped)));return isReplaced||(result=`${yaml}${yamlSectionEscaped}`),result}function getYamlSectionValue(yaml,rawKey){const match=yaml.match(getYamlSectionRegExp(rawKey));return null==match?null:match[1]}function removeYamlSection(yaml,rawKey){return yaml.replace(getYamlSectionRegExp(rawKey),"")}function loadYAML(yaml_text){if(null==yaml_text)return null;const parsed_yaml=load(yaml_text.replace(/\n(\t)+/g,"\n  "));return null==parsed_yaml?{}:parsed_yaml}function formatYamlArrayValue(value,format){switch("string"==typeof value&&(value=[value]),format){case"single-line":return null==value||0===value.length?" []":" "+convertStringArrayToSingleLineArray(value);case"multi-line":return null==value||0===value.length?"\n  - ":"\n  - "+value.join("\n  - ");case"single string to single-line":return null==value||0===value.length?" ":1===value.length?" "+value[0]:" "+convertStringArrayToSingleLineArray(value);case"single string to multi-line":return null==value||0===value.length?" ":1===value.length?" "+value[0]:"\n  - "+value.join("\n  - ");case"single string space delimited":return null==value||0===value.length?" ":1===value.length?" "+value[0]:" "+value.join(" ");case"single string comma delimited":return null==value||0===value.length?" ":1===value.length?" "+value[0]:" "+value.join(", ");case"single-line space delimited":return null==value||0===value.length?" []":1===value.length?" "+value[0]:" "+convertStringArrayToSingleLineArray(value).replaceAll(", "," ")}}function convertStringArrayToSingleLineArray(arrayItems){return null==arrayItems||0===arrayItems.length?"[]":"["+arrayItems.join(", ")+"]"}function splitValueIfSingleOrMultilineArray(value){if(null==value||0===value.length)return null;if((value=value.trimEnd()).startsWith("[")){if((value=value.substring(1)).endsWith("]")&&(value=value.substring(0,value.length-1)),0===value.length)return null;let arrayItems=value.split(", ");return arrayItems=arrayItems.length>1?arrayItems:arrayItems[0].split(","),arrayItems.filter((el=>""!=el))}if(value.includes("\n")){let arrayItems=value.split(/[ \t]*\n[ \t]*-[ \t]*/);return arrayItems.splice(0,1),arrayItems=arrayItems.filter((el=>""!=el)),null==arrayItems||0===arrayItems.length?null:arrayItems}return value}class Option{constructor(name,description,defaultValue,ruleName){this.name=name,this.description=description,this.defaultValue=defaultValue,ruleName&&(this.ruleName=ruleName)}setOption(value,settings){settings.ruleConfigs[this.ruleName][this.name]=value}}class BooleanOption extends Option{display(containerEl,settings,plugin){new obsidian.Setting(containerEl).setName(this.name).setDesc(this.description).addToggle((toggle=>{toggle.setValue(settings.ruleConfigs[this.ruleName][this.name]),toggle.onChange((value=>{this.setOption(value,settings),plugin.settings=settings,plugin.saveData(plugin.settings)}))})).settingEl.style.border="none"}}class TextOption extends Option{display(containerEl,settings,plugin){new obsidian.Setting(containerEl).setName(this.name).setDesc(this.description).addText((textbox=>{textbox.setValue(settings.ruleConfigs[this.ruleName][this.name]),textbox.onChange((value=>{this.setOption(value,settings),plugin.settings=settings,plugin.saveData(plugin.settings)}))})).settingEl.style.border="none"}}class TextAreaOption extends Option{display(containerEl,settings,plugin){new obsidian.Setting(containerEl).setName(this.name).setDesc(this.description).addTextArea((textbox=>{textbox.setValue(settings.ruleConfigs[this.ruleName][this.name]),textbox.onChange((value=>{this.setOption(value,settings),plugin.settings=settings,plugin.saveData(plugin.settings)}))})).settingEl.style.border="none"}}class MomentFormatOption extends Option{display(containerEl,settings,plugin){new obsidian.Setting(containerEl).setName(this.name).setDesc(this.description).addMomentFormat((format=>{format.setValue(settings.ruleConfigs[this.ruleName][this.name]),format.setPlaceholder("dddd, MMMM Do YYYY, h:mm:ss a"),format.onChange((value=>{this.setOption(value,settings),plugin.settings=settings,plugin.saveData(plugin.settings)}))})).settingEl.style.border="none"}}class DropdownRecord{constructor(value,description){this.value=value,this.description=description}}class DropdownOption extends Option{constructor(name,description,defaultValue,options,ruleName){super(name,description,defaultValue,ruleName),this.options=options}display(containerEl,settings,plugin){new obsidian.Setting(containerEl).setName(this.name).setDesc(this.description).addDropdown((dropdown=>{for(const option of this.options)dropdown.addOption(option.value,option.value);dropdown.setValue(settings.ruleConfigs[this.ruleName][this.name]),dropdown.onChange((value=>{this.setOption(value,settings),plugin.settings=settings,plugin.saveData(plugin.settings)}))})).settingEl.style.border="none"}}var RuleType;!function(RuleType){RuleType.YAML="YAML",RuleType.HEADING="Heading",RuleType.FOOTNOTE="Footnote",RuleType.CONTENT="Content",RuleType.SPACING="Spacing"}(RuleType||(RuleType={}));class Rule{constructor(name,description,type,apply,examples,options=[],hasSpecialExecutionOrder=!1){this.name=name,this.description=description,this.type=type,this.apply=apply,this.examples=examples,options.unshift(new BooleanOption(this.description,"",!1));for(const option of options)option.ruleName=name;this.options=options,this.hasSpecialExecutionOrder=hasSpecialExecutionOrder}alias(){return this.name.replace(/ /g,"-").toLowerCase()}getDefaultOptions(){const options={};for(const option of this.options)options[option.name]=option.defaultValue;return options}getOptions(settings){return settings.ruleConfigs[this.name]}getURL(){return"https://github.com/platers/obsidian-linter/blob/master/docs/rules.md#"+this.alias()}enabledOptionName(){return this.options[0].name}}class Example{constructor(description,before,after,options={}){this.description=description,this.options=options,this.before=before,this.after=after}}const RuleTypeOrder=Object.values(RuleType),rules=[],rulesDict=rules.reduce(((dict,rule)=>(dict[rule.alias()]=rule,dict)),{});var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},diffMatchPatch={exports:{}};
/**
 * Diff Match and Patch
 * Copyright 2018 The diff-match-patch Authors.
 * https://github.com/google/diff-match-patch
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(module){var diff_match_patch=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};diff_match_patch.Diff=function(op,text){return[op,text]},diff_match_patch.prototype.diff_main=function(text1,text2,opt_checklines,opt_deadline){void 0===opt_deadline&&(opt_deadline=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var deadline=opt_deadline;if(null==text1||null==text2)throw new Error("Null input. (diff_main)");if(text1==text2)return text1?[new diff_match_patch.Diff(0,text1)]:[];void 0===opt_checklines&&(opt_checklines=!0);var checklines=opt_checklines,commonlength=this.diff_commonPrefix(text1,text2),commonprefix=text1.substring(0,commonlength);text1=text1.substring(commonlength),text2=text2.substring(commonlength),commonlength=this.diff_commonSuffix(text1,text2);var commonsuffix=text1.substring(text1.length-commonlength);text1=text1.substring(0,text1.length-commonlength),text2=text2.substring(0,text2.length-commonlength);var diffs=this.diff_compute_(text1,text2,checklines,deadline);return commonprefix&&diffs.unshift(new diff_match_patch.Diff(0,commonprefix)),commonsuffix&&diffs.push(new diff_match_patch.Diff(0,commonsuffix)),this.diff_cleanupMerge(diffs),diffs},diff_match_patch.prototype.diff_compute_=function(text1,text2,checklines,deadline){var diffs;if(!text1)return[new diff_match_patch.Diff(1,text2)];if(!text2)return[new diff_match_patch.Diff(-1,text1)];var longtext=text1.length>text2.length?text1:text2,shorttext=text1.length>text2.length?text2:text1,i=longtext.indexOf(shorttext);if(-1!=i)return diffs=[new diff_match_patch.Diff(1,longtext.substring(0,i)),new diff_match_patch.Diff(0,shorttext),new diff_match_patch.Diff(1,longtext.substring(i+shorttext.length))],text1.length>text2.length&&(diffs[0][0]=diffs[2][0]=-1),diffs;if(1==shorttext.length)return[new diff_match_patch.Diff(-1,text1),new diff_match_patch.Diff(1,text2)];var hm=this.diff_halfMatch_(text1,text2);if(hm){var text1_a=hm[0],text1_b=hm[1],text2_a=hm[2],text2_b=hm[3],mid_common=hm[4],diffs_a=this.diff_main(text1_a,text2_a,checklines,deadline),diffs_b=this.diff_main(text1_b,text2_b,checklines,deadline);return diffs_a.concat([new diff_match_patch.Diff(0,mid_common)],diffs_b)}return checklines&&text1.length>100&&text2.length>100?this.diff_lineMode_(text1,text2,deadline):this.diff_bisect_(text1,text2,deadline)},diff_match_patch.prototype.diff_lineMode_=function(text1,text2,deadline){var a=this.diff_linesToChars_(text1,text2);text1=a.chars1,text2=a.chars2;var linearray=a.lineArray,diffs=this.diff_main(text1,text2,!1,deadline);this.diff_charsToLines_(diffs,linearray),this.diff_cleanupSemantic(diffs),diffs.push(new diff_match_patch.Diff(0,""));for(var pointer=0,count_delete=0,count_insert=0,text_delete="",text_insert="";pointer<diffs.length;){switch(diffs[pointer][0]){case 1:count_insert++,text_insert+=diffs[pointer][1];break;case-1:count_delete++,text_delete+=diffs[pointer][1];break;case 0:if(count_delete>=1&&count_insert>=1){diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert),pointer=pointer-count_delete-count_insert;for(var subDiff=this.diff_main(text_delete,text_insert,!1,deadline),j=subDiff.length-1;j>=0;j--)diffs.splice(pointer,0,subDiff[j]);pointer+=subDiff.length}count_insert=0,count_delete=0,text_delete="",text_insert=""}pointer++}return diffs.pop(),diffs},diff_match_patch.prototype.diff_bisect_=function(text1,text2,deadline){for(var text1_length=text1.length,text2_length=text2.length,max_d=Math.ceil((text1_length+text2_length)/2),v_offset=max_d,v_length=2*max_d,v1=new Array(v_length),v2=new Array(v_length),x=0;x<v_length;x++)v1[x]=-1,v2[x]=-1;v1[v_offset+1]=0,v2[v_offset+1]=0;for(var delta=text1_length-text2_length,front=delta%2!=0,k1start=0,k1end=0,k2start=0,k2end=0,d=0;d<max_d&&!((new Date).getTime()>deadline);d++){for(var k1=-d+k1start;k1<=d-k1end;k1+=2){for(var k1_offset=v_offset+k1,y1=(x1=k1==-d||k1!=d&&v1[k1_offset-1]<v1[k1_offset+1]?v1[k1_offset+1]:v1[k1_offset-1]+1)-k1;x1<text1_length&&y1<text2_length&&text1.charAt(x1)==text2.charAt(y1);)x1++,y1++;if(v1[k1_offset]=x1,x1>text1_length)k1end+=2;else if(y1>text2_length)k1start+=2;else if(front&&(k2_offset=v_offset+delta-k1)>=0&&k2_offset<v_length&&-1!=v2[k2_offset]&&x1>=(x2=text1_length-v2[k2_offset]))return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}for(var k2=-d+k2start;k2<=d-k2end;k2+=2){for(var x2,k2_offset=v_offset+k2,y2=(x2=k2==-d||k2!=d&&v2[k2_offset-1]<v2[k2_offset+1]?v2[k2_offset+1]:v2[k2_offset-1]+1)-k2;x2<text1_length&&y2<text2_length&&text1.charAt(text1_length-x2-1)==text2.charAt(text2_length-y2-1);)x2++,y2++;if(v2[k2_offset]=x2,x2>text1_length)k2end+=2;else if(y2>text2_length)k2start+=2;else if(!front){var x1;if((k1_offset=v_offset+delta-k2)>=0&&k1_offset<v_length&&-1!=v1[k1_offset])if(y1=v_offset+(x1=v1[k1_offset])-k1_offset,x1>=(x2=text1_length-x2))return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}}}return[new diff_match_patch.Diff(-1,text1),new diff_match_patch.Diff(1,text2)]},diff_match_patch.prototype.diff_bisectSplit_=function(text1,text2,x,y,deadline){var text1a=text1.substring(0,x),text2a=text2.substring(0,y),text1b=text1.substring(x),text2b=text2.substring(y),diffs=this.diff_main(text1a,text2a,!1,deadline),diffsb=this.diff_main(text1b,text2b,!1,deadline);return diffs.concat(diffsb)},diff_match_patch.prototype.diff_linesToChars_=function(text1,text2){var lineArray=[],lineHash={};function diff_linesToCharsMunge_(text){for(var chars="",lineStart=0,lineEnd=-1,lineArrayLength=lineArray.length;lineEnd<text.length-1;){-1==(lineEnd=text.indexOf("\n",lineStart))&&(lineEnd=text.length-1);var line=text.substring(lineStart,lineEnd+1);(lineHash.hasOwnProperty?lineHash.hasOwnProperty(line):void 0!==lineHash[line])?chars+=String.fromCharCode(lineHash[line]):(lineArrayLength==maxLines&&(line=text.substring(lineStart),lineEnd=text.length),chars+=String.fromCharCode(lineArrayLength),lineHash[line]=lineArrayLength,lineArray[lineArrayLength++]=line),lineStart=lineEnd+1}return chars}lineArray[0]="";var maxLines=4e4,chars1=diff_linesToCharsMunge_(text1);return maxLines=65535,{chars1,chars2:diff_linesToCharsMunge_(text2),lineArray}},diff_match_patch.prototype.diff_charsToLines_=function(diffs,lineArray){for(var i=0;i<diffs.length;i++){for(var chars=diffs[i][1],text=[],j=0;j<chars.length;j++)text[j]=lineArray[chars.charCodeAt(j)];diffs[i][1]=text.join("")}},diff_match_patch.prototype.diff_commonPrefix=function(text1,text2){if(!text1||!text2||text1.charAt(0)!=text2.charAt(0))return 0;for(var pointermin=0,pointermax=Math.min(text1.length,text2.length),pointermid=pointermax,pointerstart=0;pointermin<pointermid;)text1.substring(pointerstart,pointermid)==text2.substring(pointerstart,pointermid)?pointerstart=pointermin=pointermid:pointermax=pointermid,pointermid=Math.floor((pointermax-pointermin)/2+pointermin);return pointermid},diff_match_patch.prototype.diff_commonSuffix=function(text1,text2){if(!text1||!text2||text1.charAt(text1.length-1)!=text2.charAt(text2.length-1))return 0;for(var pointermin=0,pointermax=Math.min(text1.length,text2.length),pointermid=pointermax,pointerend=0;pointermin<pointermid;)text1.substring(text1.length-pointermid,text1.length-pointerend)==text2.substring(text2.length-pointermid,text2.length-pointerend)?pointerend=pointermin=pointermid:pointermax=pointermid,pointermid=Math.floor((pointermax-pointermin)/2+pointermin);return pointermid},diff_match_patch.prototype.diff_commonOverlap_=function(text1,text2){var text1_length=text1.length,text2_length=text2.length;if(0==text1_length||0==text2_length)return 0;text1_length>text2_length?text1=text1.substring(text1_length-text2_length):text1_length<text2_length&&(text2=text2.substring(0,text1_length));var text_length=Math.min(text1_length,text2_length);if(text1==text2)return text_length;for(var best=0,length=1;;){var pattern=text1.substring(text_length-length),found=text2.indexOf(pattern);if(-1==found)return best;length+=found,0!=found&&text1.substring(text_length-length)!=text2.substring(0,length)||(best=length,length++)}},diff_match_patch.prototype.diff_halfMatch_=function(text1,text2){if(this.Diff_Timeout<=0)return null;var longtext=text1.length>text2.length?text1:text2,shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||2*shorttext.length<longtext.length)return null;var dmp=this;function diff_halfMatchI_(longtext,shorttext,i){for(var best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,seed=longtext.substring(i,i+Math.floor(longtext.length/4)),j=-1,best_common="";-1!=(j=shorttext.indexOf(seed,j+1));){var prefixLength=dmp.diff_commonPrefix(longtext.substring(i),shorttext.substring(j)),suffixLength=dmp.diff_commonSuffix(longtext.substring(0,i),shorttext.substring(0,j));best_common.length<suffixLength+prefixLength&&(best_common=shorttext.substring(j-suffixLength,j)+shorttext.substring(j,j+prefixLength),best_longtext_a=longtext.substring(0,i-suffixLength),best_longtext_b=longtext.substring(i+prefixLength),best_shorttext_a=shorttext.substring(0,j-suffixLength),best_shorttext_b=shorttext.substring(j+prefixLength))}return 2*best_common.length>=longtext.length?[best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,best_common]:null}var hm,text1_a,text1_b,text2_a,text2_b,hm1=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/4)),hm2=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/2));return hm1||hm2?(hm=hm2?hm1&&hm1[4].length>hm2[4].length?hm1:hm2:hm1,text1.length>text2.length?(text1_a=hm[0],text1_b=hm[1],text2_a=hm[2],text2_b=hm[3]):(text2_a=hm[0],text2_b=hm[1],text1_a=hm[2],text1_b=hm[3]),[text1_a,text1_b,text2_a,text2_b,hm[4]]):null},diff_match_patch.prototype.diff_cleanupSemantic=function(diffs){for(var changes=!1,equalities=[],equalitiesLength=0,lastEquality=null,pointer=0,length_insertions1=0,length_deletions1=0,length_insertions2=0,length_deletions2=0;pointer<diffs.length;)0==diffs[pointer][0]?(equalities[equalitiesLength++]=pointer,length_insertions1=length_insertions2,length_deletions1=length_deletions2,length_insertions2=0,length_deletions2=0,lastEquality=diffs[pointer][1]):(1==diffs[pointer][0]?length_insertions2+=diffs[pointer][1].length:length_deletions2+=diffs[pointer][1].length,lastEquality&&lastEquality.length<=Math.max(length_insertions1,length_deletions1)&&lastEquality.length<=Math.max(length_insertions2,length_deletions2)&&(diffs.splice(equalities[equalitiesLength-1],0,new diff_match_patch.Diff(-1,lastEquality)),diffs[equalities[equalitiesLength-1]+1][0]=1,equalitiesLength--,pointer=--equalitiesLength>0?equalities[equalitiesLength-1]:-1,length_insertions1=0,length_deletions1=0,length_insertions2=0,length_deletions2=0,lastEquality=null,changes=!0)),pointer++;for(changes&&this.diff_cleanupMerge(diffs),this.diff_cleanupSemanticLossless(diffs),pointer=1;pointer<diffs.length;){if(-1==diffs[pointer-1][0]&&1==diffs[pointer][0]){var deletion=diffs[pointer-1][1],insertion=diffs[pointer][1],overlap_length1=this.diff_commonOverlap_(deletion,insertion),overlap_length2=this.diff_commonOverlap_(insertion,deletion);overlap_length1>=overlap_length2?(overlap_length1>=deletion.length/2||overlap_length1>=insertion.length/2)&&(diffs.splice(pointer,0,new diff_match_patch.Diff(0,insertion.substring(0,overlap_length1))),diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlap_length1),diffs[pointer+1][1]=insertion.substring(overlap_length1),pointer++):(overlap_length2>=deletion.length/2||overlap_length2>=insertion.length/2)&&(diffs.splice(pointer,0,new diff_match_patch.Diff(0,deletion.substring(0,overlap_length2))),diffs[pointer-1][0]=1,diffs[pointer-1][1]=insertion.substring(0,insertion.length-overlap_length2),diffs[pointer+1][0]=-1,diffs[pointer+1][1]=deletion.substring(overlap_length2),pointer++),pointer++}pointer++}},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(diffs){function diff_cleanupSemanticScore_(one,two){if(!one||!two)return 6;var char1=one.charAt(one.length-1),char2=two.charAt(0),nonAlphaNumeric1=char1.match(diff_match_patch.nonAlphaNumericRegex_),nonAlphaNumeric2=char2.match(diff_match_patch.nonAlphaNumericRegex_),whitespace1=nonAlphaNumeric1&&char1.match(diff_match_patch.whitespaceRegex_),whitespace2=nonAlphaNumeric2&&char2.match(diff_match_patch.whitespaceRegex_),lineBreak1=whitespace1&&char1.match(diff_match_patch.linebreakRegex_),lineBreak2=whitespace2&&char2.match(diff_match_patch.linebreakRegex_),blankLine1=lineBreak1&&one.match(diff_match_patch.blanklineEndRegex_),blankLine2=lineBreak2&&two.match(diff_match_patch.blanklineStartRegex_);return blankLine1||blankLine2?5:lineBreak1||lineBreak2?4:nonAlphaNumeric1&&!whitespace1&&whitespace2?3:whitespace1||whitespace2?2:nonAlphaNumeric1||nonAlphaNumeric2?1:0}for(var pointer=1;pointer<diffs.length-1;){if(0==diffs[pointer-1][0]&&0==diffs[pointer+1][0]){var equality1=diffs[pointer-1][1],edit=diffs[pointer][1],equality2=diffs[pointer+1][1],commonOffset=this.diff_commonSuffix(equality1,edit);if(commonOffset){var commonString=edit.substring(edit.length-commonOffset);equality1=equality1.substring(0,equality1.length-commonOffset),edit=commonString+edit.substring(0,edit.length-commonOffset),equality2=commonString+equality2}for(var bestEquality1=equality1,bestEdit=edit,bestEquality2=equality2,bestScore=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);edit.charAt(0)===equality2.charAt(0);){equality1+=edit.charAt(0),edit=edit.substring(1)+equality2.charAt(0),equality2=equality2.substring(1);var score=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);score>=bestScore&&(bestScore=score,bestEquality1=equality1,bestEdit=edit,bestEquality2=equality2)}diffs[pointer-1][1]!=bestEquality1&&(bestEquality1?diffs[pointer-1][1]=bestEquality1:(diffs.splice(pointer-1,1),pointer--),diffs[pointer][1]=bestEdit,bestEquality2?diffs[pointer+1][1]=bestEquality2:(diffs.splice(pointer+1,1),pointer--))}pointer++}},diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,diff_match_patch.whitespaceRegex_=/\s/,diff_match_patch.linebreakRegex_=/[\r\n]/,diff_match_patch.blanklineEndRegex_=/\n\r?\n$/,diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/,diff_match_patch.prototype.diff_cleanupEfficiency=function(diffs){for(var changes=!1,equalities=[],equalitiesLength=0,lastEquality=null,pointer=0,pre_ins=!1,pre_del=!1,post_ins=!1,post_del=!1;pointer<diffs.length;)0==diffs[pointer][0]?(diffs[pointer][1].length<this.Diff_EditCost&&(post_ins||post_del)?(equalities[equalitiesLength++]=pointer,pre_ins=post_ins,pre_del=post_del,lastEquality=diffs[pointer][1]):(equalitiesLength=0,lastEquality=null),post_ins=post_del=!1):(-1==diffs[pointer][0]?post_del=!0:post_ins=!0,lastEquality&&(pre_ins&&pre_del&&post_ins&&post_del||lastEquality.length<this.Diff_EditCost/2&&pre_ins+pre_del+post_ins+post_del==3)&&(diffs.splice(equalities[equalitiesLength-1],0,new diff_match_patch.Diff(-1,lastEquality)),diffs[equalities[equalitiesLength-1]+1][0]=1,equalitiesLength--,lastEquality=null,pre_ins&&pre_del?(post_ins=post_del=!0,equalitiesLength=0):(pointer=--equalitiesLength>0?equalities[equalitiesLength-1]:-1,post_ins=post_del=!1),changes=!0)),pointer++;changes&&this.diff_cleanupMerge(diffs)},diff_match_patch.prototype.diff_cleanupMerge=function(diffs){diffs.push(new diff_match_patch.Diff(0,""));for(var commonlength,pointer=0,count_delete=0,count_insert=0,text_delete="",text_insert="";pointer<diffs.length;)switch(diffs[pointer][0]){case 1:count_insert++,text_insert+=diffs[pointer][1],pointer++;break;case-1:count_delete++,text_delete+=diffs[pointer][1],pointer++;break;case 0:count_delete+count_insert>1?(0!==count_delete&&0!==count_insert&&(0!==(commonlength=this.diff_commonPrefix(text_insert,text_delete))&&(pointer-count_delete-count_insert>0&&0==diffs[pointer-count_delete-count_insert-1][0]?diffs[pointer-count_delete-count_insert-1][1]+=text_insert.substring(0,commonlength):(diffs.splice(0,0,new diff_match_patch.Diff(0,text_insert.substring(0,commonlength))),pointer++),text_insert=text_insert.substring(commonlength),text_delete=text_delete.substring(commonlength)),0!==(commonlength=this.diff_commonSuffix(text_insert,text_delete))&&(diffs[pointer][1]=text_insert.substring(text_insert.length-commonlength)+diffs[pointer][1],text_insert=text_insert.substring(0,text_insert.length-commonlength),text_delete=text_delete.substring(0,text_delete.length-commonlength))),pointer-=count_delete+count_insert,diffs.splice(pointer,count_delete+count_insert),text_delete.length&&(diffs.splice(pointer,0,new diff_match_patch.Diff(-1,text_delete)),pointer++),text_insert.length&&(diffs.splice(pointer,0,new diff_match_patch.Diff(1,text_insert)),pointer++),pointer++):0!==pointer&&0==diffs[pointer-1][0]?(diffs[pointer-1][1]+=diffs[pointer][1],diffs.splice(pointer,1)):pointer++,count_insert=0,count_delete=0,text_delete="",text_insert=""}""===diffs[diffs.length-1][1]&&diffs.pop();var changes=!1;for(pointer=1;pointer<diffs.length-1;)0==diffs[pointer-1][0]&&0==diffs[pointer+1][0]&&(diffs[pointer][1].substring(diffs[pointer][1].length-diffs[pointer-1][1].length)==diffs[pointer-1][1]?(diffs[pointer][1]=diffs[pointer-1][1]+diffs[pointer][1].substring(0,diffs[pointer][1].length-diffs[pointer-1][1].length),diffs[pointer+1][1]=diffs[pointer-1][1]+diffs[pointer+1][1],diffs.splice(pointer-1,1),changes=!0):diffs[pointer][1].substring(0,diffs[pointer+1][1].length)==diffs[pointer+1][1]&&(diffs[pointer-1][1]+=diffs[pointer+1][1],diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+diffs[pointer+1][1],diffs.splice(pointer+1,1),changes=!0)),pointer++;changes&&this.diff_cleanupMerge(diffs)},diff_match_patch.prototype.diff_xIndex=function(diffs,loc){var x,chars1=0,chars2=0,last_chars1=0,last_chars2=0;for(x=0;x<diffs.length&&(1!==diffs[x][0]&&(chars1+=diffs[x][1].length),-1!==diffs[x][0]&&(chars2+=diffs[x][1].length),!(chars1>loc));x++)last_chars1=chars1,last_chars2=chars2;return diffs.length!=x&&-1===diffs[x][0]?last_chars2:last_chars2+(loc-last_chars1)},diff_match_patch.prototype.diff_prettyHtml=function(diffs){for(var html=[],pattern_amp=/&/g,pattern_lt=/</g,pattern_gt=/>/g,pattern_para=/\n/g,x=0;x<diffs.length;x++){var op=diffs[x][0],text=diffs[x][1].replace(pattern_amp,"&amp;").replace(pattern_lt,"&lt;").replace(pattern_gt,"&gt;").replace(pattern_para,"&para;<br>");switch(op){case 1:html[x]='<ins style="background:#e6ffe6;">'+text+"</ins>";break;case-1:html[x]='<del style="background:#ffe6e6;">'+text+"</del>";break;case 0:html[x]="<span>"+text+"</span>"}}return html.join("")},diff_match_patch.prototype.diff_text1=function(diffs){for(var text=[],x=0;x<diffs.length;x++)1!==diffs[x][0]&&(text[x]=diffs[x][1]);return text.join("")},diff_match_patch.prototype.diff_text2=function(diffs){for(var text=[],x=0;x<diffs.length;x++)-1!==diffs[x][0]&&(text[x]=diffs[x][1]);return text.join("")},diff_match_patch.prototype.diff_levenshtein=function(diffs){for(var levenshtein=0,insertions=0,deletions=0,x=0;x<diffs.length;x++){var op=diffs[x][0],data=diffs[x][1];switch(op){case 1:insertions+=data.length;break;case-1:deletions+=data.length;break;case 0:levenshtein+=Math.max(insertions,deletions),insertions=0,deletions=0}}return levenshtein+Math.max(insertions,deletions)},diff_match_patch.prototype.diff_toDelta=function(diffs){for(var text=[],x=0;x<diffs.length;x++)switch(diffs[x][0]){case 1:text[x]="+"+encodeURI(diffs[x][1]);break;case-1:text[x]="-"+diffs[x][1].length;break;case 0:text[x]="="+diffs[x][1].length}return text.join("\t").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(text1,delta){for(var diffs=[],diffsLength=0,pointer=0,tokens=delta.split(/\t/g),x=0;x<tokens.length;x++){var param=tokens[x].substring(1);switch(tokens[x].charAt(0)){case"+":try{diffs[diffsLength++]=new diff_match_patch.Diff(1,decodeURI(param))}catch(ex){throw new Error("Illegal escape in diff_fromDelta: "+param)}break;case"-":case"=":var n=parseInt(param,10);if(isNaN(n)||n<0)throw new Error("Invalid number in diff_fromDelta: "+param);var text=text1.substring(pointer,pointer+=n);"="==tokens[x].charAt(0)?diffs[diffsLength++]=new diff_match_patch.Diff(0,text):diffs[diffsLength++]=new diff_match_patch.Diff(-1,text);break;default:if(tokens[x])throw new Error("Invalid diff operation in diff_fromDelta: "+tokens[x])}}if(pointer!=text1.length)throw new Error("Delta length ("+pointer+") does not equal source text length ("+text1.length+").");return diffs},diff_match_patch.prototype.match_main=function(text,pattern,loc){if(null==text||null==pattern||null==loc)throw new Error("Null input. (match_main)");return loc=Math.max(0,Math.min(loc,text.length)),text==pattern?0:text.length?text.substring(loc,loc+pattern.length)==pattern?loc:this.match_bitap_(text,pattern,loc):-1},diff_match_patch.prototype.match_bitap_=function(text,pattern,loc){if(pattern.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var s=this.match_alphabet_(pattern),dmp=this;function match_bitapScore_(e,x){var accuracy=e/pattern.length,proximity=Math.abs(loc-x);return dmp.Match_Distance?accuracy+proximity/dmp.Match_Distance:proximity?1:accuracy}var score_threshold=this.Match_Threshold,best_loc=text.indexOf(pattern,loc);-1!=best_loc&&(score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold),-1!=(best_loc=text.lastIndexOf(pattern,loc+pattern.length))&&(score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold)));var bin_min,bin_mid,matchmask=1<<pattern.length-1;best_loc=-1;for(var last_rd,bin_max=pattern.length+text.length,d=0;d<pattern.length;d++){for(bin_min=0,bin_mid=bin_max;bin_min<bin_mid;)match_bitapScore_(d,loc+bin_mid)<=score_threshold?bin_min=bin_mid:bin_max=bin_mid,bin_mid=Math.floor((bin_max-bin_min)/2+bin_min);bin_max=bin_mid;var start=Math.max(1,loc-bin_mid+1),finish=Math.min(loc+bin_mid,text.length)+pattern.length,rd=Array(finish+2);rd[finish+1]=(1<<d)-1;for(var j=finish;j>=start;j--){var charMatch=s[text.charAt(j-1)];if(rd[j]=0===d?(rd[j+1]<<1|1)&charMatch:(rd[j+1]<<1|1)&charMatch|(last_rd[j+1]|last_rd[j])<<1|1|last_rd[j+1],rd[j]&matchmask){var score=match_bitapScore_(d,j-1);if(score<=score_threshold){if(score_threshold=score,!((best_loc=j-1)>loc))break;start=Math.max(1,2*loc-best_loc)}}}if(match_bitapScore_(d+1,loc)>score_threshold)break;last_rd=rd}return best_loc},diff_match_patch.prototype.match_alphabet_=function(pattern){for(var s={},i=0;i<pattern.length;i++)s[pattern.charAt(i)]=0;for(i=0;i<pattern.length;i++)s[pattern.charAt(i)]|=1<<pattern.length-i-1;return s},diff_match_patch.prototype.patch_addContext_=function(patch,text){if(0!=text.length){if(null===patch.start2)throw Error("patch not initialized");for(var pattern=text.substring(patch.start2,patch.start2+patch.length1),padding=0;text.indexOf(pattern)!=text.lastIndexOf(pattern)&&pattern.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)padding+=this.Patch_Margin,pattern=text.substring(patch.start2-padding,patch.start2+patch.length1+padding);padding+=this.Patch_Margin;var prefix=text.substring(patch.start2-padding,patch.start2);prefix&&patch.diffs.unshift(new diff_match_patch.Diff(0,prefix));var suffix=text.substring(patch.start2+patch.length1,patch.start2+patch.length1+padding);suffix&&patch.diffs.push(new diff_match_patch.Diff(0,suffix)),patch.start1-=prefix.length,patch.start2-=prefix.length,patch.length1+=prefix.length+suffix.length,patch.length2+=prefix.length+suffix.length}},diff_match_patch.prototype.patch_make=function(a,opt_b,opt_c){var text1,diffs;if("string"==typeof a&&"string"==typeof opt_b&&void 0===opt_c)text1=a,(diffs=this.diff_main(text1,opt_b,!0)).length>2&&(this.diff_cleanupSemantic(diffs),this.diff_cleanupEfficiency(diffs));else if(a&&"object"==typeof a&&void 0===opt_b&&void 0===opt_c)diffs=a,text1=this.diff_text1(diffs);else if("string"==typeof a&&opt_b&&"object"==typeof opt_b&&void 0===opt_c)text1=a,diffs=opt_b;else{if("string"!=typeof a||"string"!=typeof opt_b||!opt_c||"object"!=typeof opt_c)throw new Error("Unknown call format to patch_make.");text1=a,diffs=opt_c}if(0===diffs.length)return[];for(var patches=[],patch=new diff_match_patch.patch_obj,patchDiffLength=0,char_count1=0,char_count2=0,prepatch_text=text1,postpatch_text=text1,x=0;x<diffs.length;x++){var diff_type=diffs[x][0],diff_text=diffs[x][1];switch(patchDiffLength||0===diff_type||(patch.start1=char_count1,patch.start2=char_count2),diff_type){case 1:patch.diffs[patchDiffLength++]=diffs[x],patch.length2+=diff_text.length,postpatch_text=postpatch_text.substring(0,char_count2)+diff_text+postpatch_text.substring(char_count2);break;case-1:patch.length1+=diff_text.length,patch.diffs[patchDiffLength++]=diffs[x],postpatch_text=postpatch_text.substring(0,char_count2)+postpatch_text.substring(char_count2+diff_text.length);break;case 0:diff_text.length<=2*this.Patch_Margin&&patchDiffLength&&diffs.length!=x+1?(patch.diffs[patchDiffLength++]=diffs[x],patch.length1+=diff_text.length,patch.length2+=diff_text.length):diff_text.length>=2*this.Patch_Margin&&patchDiffLength&&(this.patch_addContext_(patch,prepatch_text),patches.push(patch),patch=new diff_match_patch.patch_obj,patchDiffLength=0,prepatch_text=postpatch_text,char_count1=char_count2)}1!==diff_type&&(char_count1+=diff_text.length),-1!==diff_type&&(char_count2+=diff_text.length)}return patchDiffLength&&(this.patch_addContext_(patch,prepatch_text),patches.push(patch)),patches},diff_match_patch.prototype.patch_deepCopy=function(patches){for(var patchesCopy=[],x=0;x<patches.length;x++){var patch=patches[x],patchCopy=new diff_match_patch.patch_obj;patchCopy.diffs=[];for(var y=0;y<patch.diffs.length;y++)patchCopy.diffs[y]=new diff_match_patch.Diff(patch.diffs[y][0],patch.diffs[y][1]);patchCopy.start1=patch.start1,patchCopy.start2=patch.start2,patchCopy.length1=patch.length1,patchCopy.length2=patch.length2,patchesCopy[x]=patchCopy}return patchesCopy},diff_match_patch.prototype.patch_apply=function(patches,text){if(0==patches.length)return[text,[]];patches=this.patch_deepCopy(patches);var nullPadding=this.patch_addPadding(patches);text=nullPadding+text+nullPadding,this.patch_splitMax(patches);for(var delta=0,results=[],x=0;x<patches.length;x++){var start_loc,text2,expected_loc=patches[x].start2+delta,text1=this.diff_text1(patches[x].diffs),end_loc=-1;if(text1.length>this.Match_MaxBits?-1!=(start_loc=this.match_main(text,text1.substring(0,this.Match_MaxBits),expected_loc))&&(-1==(end_loc=this.match_main(text,text1.substring(text1.length-this.Match_MaxBits),expected_loc+text1.length-this.Match_MaxBits))||start_loc>=end_loc)&&(start_loc=-1):start_loc=this.match_main(text,text1,expected_loc),-1==start_loc)results[x]=!1,delta-=patches[x].length2-patches[x].length1;else if(results[x]=!0,delta=start_loc-expected_loc,text1==(text2=-1==end_loc?text.substring(start_loc,start_loc+text1.length):text.substring(start_loc,end_loc+this.Match_MaxBits)))text=text.substring(0,start_loc)+this.diff_text2(patches[x].diffs)+text.substring(start_loc+text1.length);else{var diffs=this.diff_main(text1,text2,!1);if(text1.length>this.Match_MaxBits&&this.diff_levenshtein(diffs)/text1.length>this.Patch_DeleteThreshold)results[x]=!1;else{this.diff_cleanupSemanticLossless(diffs);for(var index2,index1=0,y=0;y<patches[x].diffs.length;y++){var mod=patches[x].diffs[y];0!==mod[0]&&(index2=this.diff_xIndex(diffs,index1)),1===mod[0]?text=text.substring(0,start_loc+index2)+mod[1]+text.substring(start_loc+index2):-1===mod[0]&&(text=text.substring(0,start_loc+index2)+text.substring(start_loc+this.diff_xIndex(diffs,index1+mod[1].length))),-1!==mod[0]&&(index1+=mod[1].length)}}}}return[text=text.substring(nullPadding.length,text.length-nullPadding.length),results]},diff_match_patch.prototype.patch_addPadding=function(patches){for(var paddingLength=this.Patch_Margin,nullPadding="",x=1;x<=paddingLength;x++)nullPadding+=String.fromCharCode(x);for(x=0;x<patches.length;x++)patches[x].start1+=paddingLength,patches[x].start2+=paddingLength;var patch=patches[0],diffs=patch.diffs;if(0==diffs.length||0!=diffs[0][0])diffs.unshift(new diff_match_patch.Diff(0,nullPadding)),patch.start1-=paddingLength,patch.start2-=paddingLength,patch.length1+=paddingLength,patch.length2+=paddingLength;else if(paddingLength>diffs[0][1].length){var extraLength=paddingLength-diffs[0][1].length;diffs[0][1]=nullPadding.substring(diffs[0][1].length)+diffs[0][1],patch.start1-=extraLength,patch.start2-=extraLength,patch.length1+=extraLength,patch.length2+=extraLength}return 0==(diffs=(patch=patches[patches.length-1]).diffs).length||0!=diffs[diffs.length-1][0]?(diffs.push(new diff_match_patch.Diff(0,nullPadding)),patch.length1+=paddingLength,patch.length2+=paddingLength):paddingLength>diffs[diffs.length-1][1].length&&(extraLength=paddingLength-diffs[diffs.length-1][1].length,diffs[diffs.length-1][1]+=nullPadding.substring(0,extraLength),patch.length1+=extraLength,patch.length2+=extraLength),nullPadding},diff_match_patch.prototype.patch_splitMax=function(patches){for(var patch_size=this.Match_MaxBits,x=0;x<patches.length;x++)if(!(patches[x].length1<=patch_size)){var bigpatch=patches[x];patches.splice(x--,1);for(var start1=bigpatch.start1,start2=bigpatch.start2,precontext="";0!==bigpatch.diffs.length;){var patch=new diff_match_patch.patch_obj,empty=!0;for(patch.start1=start1-precontext.length,patch.start2=start2-precontext.length,""!==precontext&&(patch.length1=patch.length2=precontext.length,patch.diffs.push(new diff_match_patch.Diff(0,precontext)));0!==bigpatch.diffs.length&&patch.length1<patch_size-this.Patch_Margin;){var diff_type=bigpatch.diffs[0][0],diff_text=bigpatch.diffs[0][1];1===diff_type?(patch.length2+=diff_text.length,start2+=diff_text.length,patch.diffs.push(bigpatch.diffs.shift()),empty=!1):-1===diff_type&&1==patch.diffs.length&&0==patch.diffs[0][0]&&diff_text.length>2*patch_size?(patch.length1+=diff_text.length,start1+=diff_text.length,empty=!1,patch.diffs.push(new diff_match_patch.Diff(diff_type,diff_text)),bigpatch.diffs.shift()):(diff_text=diff_text.substring(0,patch_size-patch.length1-this.Patch_Margin),patch.length1+=diff_text.length,start1+=diff_text.length,0===diff_type?(patch.length2+=diff_text.length,start2+=diff_text.length):empty=!1,patch.diffs.push(new diff_match_patch.Diff(diff_type,diff_text)),diff_text==bigpatch.diffs[0][1]?bigpatch.diffs.shift():bigpatch.diffs[0][1]=bigpatch.diffs[0][1].substring(diff_text.length))}precontext=(precontext=this.diff_text2(patch.diffs)).substring(precontext.length-this.Patch_Margin);var postcontext=this.diff_text1(bigpatch.diffs).substring(0,this.Patch_Margin);""!==postcontext&&(patch.length1+=postcontext.length,patch.length2+=postcontext.length,0!==patch.diffs.length&&0===patch.diffs[patch.diffs.length-1][0]?patch.diffs[patch.diffs.length-1][1]+=postcontext:patch.diffs.push(new diff_match_patch.Diff(0,postcontext))),empty||patches.splice(++x,0,patch)}}},diff_match_patch.prototype.patch_toText=function(patches){for(var text=[],x=0;x<patches.length;x++)text[x]=patches[x];return text.join("")},diff_match_patch.prototype.patch_fromText=function(textline){var patches=[];if(!textline)return patches;for(var text=textline.split("\n"),textPointer=0,patchHeader=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;textPointer<text.length;){var m=text[textPointer].match(patchHeader);if(!m)throw new Error("Invalid patch string: "+text[textPointer]);var patch=new diff_match_patch.patch_obj;for(patches.push(patch),patch.start1=parseInt(m[1],10),""===m[2]?(patch.start1--,patch.length1=1):"0"==m[2]?patch.length1=0:(patch.start1--,patch.length1=parseInt(m[2],10)),patch.start2=parseInt(m[3],10),""===m[4]?(patch.start2--,patch.length2=1):"0"==m[4]?patch.length2=0:(patch.start2--,patch.length2=parseInt(m[4],10)),textPointer++;textPointer<text.length;){var sign=text[textPointer].charAt(0);try{var line=decodeURI(text[textPointer].substring(1))}catch(ex){throw new Error("Illegal escape in patch_fromText: "+line)}if("-"==sign)patch.diffs.push(new diff_match_patch.Diff(-1,line));else if("+"==sign)patch.diffs.push(new diff_match_patch.Diff(1,line));else if(" "==sign)patch.diffs.push(new diff_match_patch.Diff(0,line));else{if("@"==sign)break;if(""!==sign)throw new Error('Invalid patch mode "'+sign+'" in: '+line)}textPointer++}}return patches},(diff_match_patch.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var op,text=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],x=0;x<this.diffs.length;x++){switch(this.diffs[x][0]){case 1:op="+";break;case-1:op="-";break;case 0:op=" "}text[x+1]=op+encodeURI(this.diffs[x][1])+"\n"}return text.join("").replace(/%20/g," ")},module.exports=diff_match_patch,module.exports.diff_match_patch=diff_match_patch,module.exports.DIFF_DELETE=-1,module.exports.DIFF_INSERT=1,module.exports.DIFF_EQUAL=0}(diffMatchPatch);var DiffMatchPatch=diffMatchPatch.exports;function dedent(templ){for(var values=[],_i=1;_i<arguments.length;_i++)values[_i-1]=arguments[_i];var strings=Array.from("string"==typeof templ?[templ]:templ);strings[strings.length-1]=strings[strings.length-1].replace(/\r?\n([\t ]*)$/,"");var indentLengths=strings.reduce((function(arr,str){var matches=str.match(/\n([\t ]+|(?!\s).)/g);return matches?arr.concat(matches.map((function(match){var _a,_b;return null!==(_b=null===(_a=match.match(/[\t ]/g))||void 0===_a?void 0:_a.length)&&void 0!==_b?_b:0}))):arr}),[]);if(indentLengths.length){var pattern_1=new RegExp("\n[\t ]{"+Math.min.apply(Math,indentLengths)+"}","g");strings=strings.map((function(str){return str.replace(pattern_1,"\n")}))}strings[0]=strings[0].replace(/^\r?\n/,"");var string=strings[0];return values.forEach((function(value,i){var endentations=string.match(/(?:^|\n)( *)$/),endentation=endentations?endentations[1]:"",indentedValue=value;"string"==typeof value&&value.includes("\n")&&(indentedValue=String(value).split("\n").map((function(str,i){return 0===i?str:""+endentation+str})).join("\n")),string+=indentedValue+strings[i+1]})),string}function insert(str,index,value){return str.substring(0,index)+value+str.substring(index)}function replaceTextBetweenStartAndEndWithNewValue(str,start,end,value){return str.substring(0,start)+value+str.substring(end)}var loglevel={exports:{}};
/*
* loglevel - https://github.com/pimterry/loglevel
*
* Copyright (c) 2013 Tim Perry
* Licensed under the MIT license.
*/!function(module){var root,definition;root=commonjsGlobal,definition=function(){var noop=function(){},isIE="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),logMethods=["trace","debug","info","warn","error"];function bindMethod(obj,methodName){var method=obj[methodName];if("function"==typeof method.bind)return method.bind(obj);try{return Function.prototype.bind.call(method,obj)}catch(e){return function(){return Function.prototype.apply.apply(method,[obj,arguments])}}}function traceForIE(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function realMethod(methodName){return"debug"===methodName&&(methodName="log"),"undefined"!=typeof console&&("trace"===methodName&&isIE?traceForIE:void 0!==console[methodName]?bindMethod(console,methodName):void 0!==console.log?bindMethod(console,"log"):noop)}function replaceLoggingMethods(level,loggerName){for(var i=0;i<logMethods.length;i++){var methodName=logMethods[i];this[methodName]=i<level?noop:this.methodFactory(methodName,level,loggerName)}this.log=this.debug}function enableLoggingWhenConsoleArrives(methodName,level,loggerName){return function(){"undefined"!=typeof console&&(replaceLoggingMethods.call(this,level,loggerName),this[methodName].apply(this,arguments))}}function defaultMethodFactory(methodName,level,loggerName){return realMethod(methodName)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(name,defaultLevel,factory){var currentLevel,self=this;defaultLevel=null==defaultLevel?"WARN":defaultLevel;var storageKey="loglevel";function getPersistedLevel(){var storedLevel;if("undefined"!=typeof window&&storageKey){try{storedLevel=window.localStorage[storageKey]}catch(ignore){}if(void 0===storedLevel)try{var cookie=window.document.cookie,location=cookie.indexOf(encodeURIComponent(storageKey)+"=");-1!==location&&(storedLevel=/^([^;]+)/.exec(cookie.slice(location))[1])}catch(ignore){}return void 0===self.levels[storedLevel]&&(storedLevel=void 0),storedLevel}}"string"==typeof name?storageKey+=":"+name:"symbol"==typeof name&&(storageKey=void 0),self.name=name,self.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},self.methodFactory=factory||defaultMethodFactory,self.getLevel=function(){return currentLevel},self.setLevel=function(level,persist){if("string"==typeof level&&void 0!==self.levels[level.toUpperCase()]&&(level=self.levels[level.toUpperCase()]),!("number"==typeof level&&level>=0&&level<=self.levels.SILENT))throw"log.setLevel() called with invalid level: "+level;if(currentLevel=level,!1!==persist&&function(levelNum){var levelName=(logMethods[levelNum]||"silent").toUpperCase();if("undefined"!=typeof window&&storageKey){try{return void(window.localStorage[storageKey]=levelName)}catch(ignore){}try{window.document.cookie=encodeURIComponent(storageKey)+"="+levelName+";"}catch(ignore){}}}(level),replaceLoggingMethods.call(self,level,name),"undefined"==typeof console&&level<self.levels.SILENT)return"No console available for logging"},self.setDefaultLevel=function(level){defaultLevel=level,getPersistedLevel()||self.setLevel(level,!1)},self.resetLevel=function(){self.setLevel(defaultLevel,!1),function(){if("undefined"!=typeof window&&storageKey){try{return void window.localStorage.removeItem(storageKey)}catch(ignore){}try{window.document.cookie=encodeURIComponent(storageKey)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(ignore){}}}()},self.enableAll=function(persist){self.setLevel(self.levels.TRACE,persist)},self.disableAll=function(persist){self.setLevel(self.levels.SILENT,persist)};var initialLevel=getPersistedLevel();null==initialLevel&&(initialLevel=defaultLevel),self.setLevel(initialLevel,!1)}var defaultLogger=new Logger,_loggersByName={};defaultLogger.getLogger=function(name){if("symbol"!=typeof name&&"string"!=typeof name||""===name)throw new TypeError("You must supply a name when creating a logger.");var logger=_loggersByName[name];return logger||(logger=_loggersByName[name]=new Logger(name,defaultLogger.getLevel(),defaultLogger.methodFactory)),logger};var _log="undefined"!=typeof window?window.log:void 0;return defaultLogger.noConflict=function(){return"undefined"!=typeof window&&window.log===defaultLogger&&(window.log=_log),defaultLogger},defaultLogger.getLoggers=function(){return _loggersByName},defaultLogger.default=defaultLogger,defaultLogger},module.exports?module.exports=definition():root.log=definition()}(loglevel);var _a,_RuleBuilderBase_ruleMap,_ExampleBuilder__,_OptionBuilder_option,log=loglevel.exports;function logInfo(message){log.info(`[Obsidian Linter] ${message}`)}function logDebug(message){log.debug(`[Obsidian Linter] ${message}`)}class RuleBuilderBase{static getRule(){if(!__classPrivateFieldGet(RuleBuilderBase,_a,"f",_RuleBuilderBase_ruleMap).has(this.name)){const builder=new this,rule=new Rule(builder.name,builder.description,builder.type,builder.safeApply.bind(builder),builder.exampleBuilders.map((b=>b.example)),builder.optionBuilders.map((b=>b.option)),builder.hasSpecialExecutionOrder);__classPrivateFieldGet(RuleBuilderBase,_a,"f",_RuleBuilderBase_ruleMap).set(this.name,rule)}return __classPrivateFieldGet(RuleBuilderBase,_a,"f",_RuleBuilderBase_ruleMap).get(this.name)}static applyIfEnabledBase(rule,text,settings,extraOptions){const optionsFromSettings=rule.getOptions(settings);if(optionsFromSettings[rule.enabledOptionName()]){const options=Object.assign({},optionsFromSettings,extraOptions);return logDebug(`Running ${rule.name}`),[rule.apply(text,options),!0]}return[text,!1]}}_a=RuleBuilderBase,_RuleBuilderBase_ruleMap={value:new Map};class RuleBuilder extends RuleBuilderBase{static register(RuleBuilderClass){var rule;rule=RuleBuilderClass.getRule(),rules.push(rule),rules.sort(((a,b)=>RuleTypeOrder.indexOf(a.type)-RuleTypeOrder.indexOf(b.type)||a.name.localeCompare(b.name))),rulesDict[rule.alias()]=rule}safeApply(text,options){return this.apply(text,this.buildRuleOptions(options))}buildRuleOptions(options){options=null!=options?options:{};const defaultOptions=new this.OptionsClass,ruleOptions=Object.assign(defaultOptions,options);for(const optionBuilder of this.optionBuilders)optionBuilder.setRuleOption(ruleOptions,options);return ruleOptions}get hasSpecialExecutionOrder(){return!1}static applyIfEnabled(text,settings,disabledRules,extraOptions){const rule=this.getRule();return disabledRules.includes(rule.alias())?(logDebug(rule.alias()+" is disabled"),[text,!1]):RuleBuilderBase.applyIfEnabledBase(rule,text,settings,extraOptions)}static getRuleOptions(settings){const rule=RuleBuilderBase.getRule.bind(this)(),builder=new this,optionsFromSettings=rule.getOptions(settings);return builder.buildRuleOptions(optionsFromSettings)}}class ExampleBuilder{constructor(args){_ExampleBuilder__.set(this,void 0),this.example=new Example(args.description,args.before,args.after,args.options)}}_ExampleBuilder__=new WeakMap;class OptionBuilder{constructor(args){_OptionBuilder_option.set(this,void 0),this.OptionsClass=args.OptionsClass,this.name=args.name,this.description=args.description,this.optionsKey=args.optionsKey}get defaultValue(){return(new this.OptionsClass)[this.optionsKey]}get option(){return __classPrivateFieldGet(this,_OptionBuilder_option,"f")||function(receiver,state,value,kind,f){if("function"==typeof state||!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");state.set(receiver,value)}(this,_OptionBuilder_option,this.buildOption()),__classPrivateFieldGet(this,_OptionBuilder_option,"f")}setRuleOption(ruleOptions,options){const optionValue=options[this.name];void 0!==optionValue&&(ruleOptions[this.optionsKey]=optionValue)}}_OptionBuilder_option=new WeakMap;class BooleanOptionBuilder extends OptionBuilder{buildOption(){return new BooleanOption(this.name,this.description,this.defaultValue)}}class NumberOptionBuilder extends OptionBuilder{buildOption(){return new TextOption(this.name,this.description,this.defaultValue)}}class DropdownOptionBuilder extends OptionBuilder{constructor(args){super(args),this.records=args.records.map((record=>new DropdownRecord(record.value,record.description)))}buildOption(){return new DropdownOption(this.name,this.description,this.defaultValue,this.records)}}class TextAreaOptionBuilder extends OptionBuilder{constructor(args){var _b,_c;super(args),this.separator=null!==(_b=args.separator)&&void 0!==_b?_b:"\n",this.splitter=null!==(_c=args.splitter)&&void 0!==_c?_c:/\n/}buildOption(){return new TextAreaOption(this.name,this.description,this.defaultValue.join(this.separator))}setRuleOption(ruleOptions,options){void 0!==options[this.name]&&(ruleOptions[this.optionsKey]=options[this.name].split(this.splitter))}}class TextOptionBuilder extends OptionBuilder{buildOption(){return new TextOption(this.name,this.description,this.defaultValue)}}class MomentFormatOptionBuilder extends OptionBuilder{buildOption(){return new MomentFormatOption(this.name,this.description,this.defaultValue)}}const convert=function(test){if(null==test)return ok;if("string"==typeof test)return check=test,castFactory((function(node){return node&&node.type===check}));var check;if("object"==typeof test)return Array.isArray(test)?function(tests){const checks=[];let index=-1;for(;++index<tests.length;)checks[index]=convert(tests[index]);return castFactory((function(...parameters){let index=-1;for(;++index<checks.length;)if(checks[index].call(this,...parameters))return!0;return!1}))}(test):function(check){return castFactory((function(node){let key;for(key in check)if(node[key]!==check[key])return!1;return!0}))}(test);if("function"==typeof test)return castFactory(test);throw new Error("Expected function, string, or object as test")};function castFactory(check){return function(...parameters){return Boolean(check.call(this,...parameters))}}function ok(){return!0}const visitParents=function(tree,test,visitor,reverse){"function"==typeof test&&"function"!=typeof visitor&&(reverse=visitor,visitor=test,test=null);const is=convert(test),step=reverse?-1:1;!function factory(node,index,parents){const value="object"==typeof node&&null!==node?node:{};let name;return"string"==typeof value.type&&(name="string"==typeof value.tagName?value.tagName:"string"==typeof value.name?value.name:void 0,Object.defineProperty(visit,"name",{value:"node ("+value.type+(name?"<"+name+">":"")+")"})),visit;function visit(){let subresult,offset,grandparents,result=[];if((!test||is(node,index,parents[parents.length-1]||null))&&(result=function(value){return Array.isArray(value)?value:"number"==typeof value?[!0,value]:[value]}(visitor(node,parents)),!1===result[0]))return result;if(node.children&&"skip"!==result[0])for(offset=(reverse?node.children.length:-1)+step,grandparents=parents.concat(node);offset>-1&&offset<node.children.length;){if(subresult=factory(node.children[offset],offset,grandparents)(),!1===subresult[0])return subresult;offset="number"==typeof subresult[1]?subresult[1]:offset+step}return result}}(tree,null,[])()},visit=function(tree,test,visitor,reverse){"function"==typeof test&&"function"!=typeof visitor&&(reverse=visitor,visitor=test,test=null),visitParents(tree,test,(function(node,parents){const parent=parents[parents.length-1];return visitor(node,parent?parent.children.indexOf(node):null,parent)}),reverse)};function bail(error){if(error)throw error}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var isBuffer=function(obj){return null!=obj&&null!=obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)},hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray=function(arr){return"function"==typeof Array.isArray?Array.isArray(arr):"[object Array]"===toStr.call(arr)},isPlainObject$1=function(obj){if(!obj||"[object Object]"!==toStr.call(obj))return!1;var key,hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf)return!1;for(key in obj);return void 0===key||hasOwn.call(obj,key)},setProperty=function(target,options){defineProperty&&"__proto__"===options.name?defineProperty(target,options.name,{enumerable:!0,configurable:!0,value:options.newValue,writable:!0}):target[options.name]=options.newValue},getProperty=function(obj,name){if("__proto__"===name){if(!hasOwn.call(obj,name))return;if(gOPD)return gOPD(obj,name).value}return obj[name]},extend=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),(null==target||"object"!=typeof target&&"function"!=typeof target)&&(target={});i<length;++i)if(null!=(options=arguments[i]))for(name in options)src=getProperty(target,name),target!==(copy=getProperty(options,name))&&(deep&&copy&&(isPlainObject$1(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject$1(src)?src:{},setProperty(target,{name,newValue:extend(deep,clone,copy)})):void 0!==copy&&setProperty(target,{name,newValue:copy}));return target};function isPlainObject(value){if("[object Object]"!==Object.prototype.toString.call(value))return!1;const prototype=Object.getPrototypeOf(value);return null===prototype||prototype===Object.prototype}var own$4={}.hasOwnProperty;function stringifyPosition(value){return value&&"object"==typeof value?own$4.call(value,"position")||own$4.call(value,"type")?position(value.position):own$4.call(value,"start")||own$4.call(value,"end")?position(value):own$4.call(value,"line")||own$4.call(value,"column")?point(value):"":""}function point(point){return index(point&&point.line)+":"+index(point&&point.column)}function position(pos){return point(pos&&pos.start)+"-"+point(pos&&pos.end)}function index(value){return value&&"number"==typeof value?value:1}class VFileMessage extends Error{constructor(reason,place,origin){var index,parts=[null,null],position={start:{line:null,column:null},end:{line:null,column:null}};super(),"string"==typeof place&&(origin=place,place=null),"string"==typeof origin&&(-1===(index=origin.indexOf(":"))?parts[1]=origin:(parts[0]=origin.slice(0,index),parts[1]=origin.slice(index+1))),place&&("type"in place||"position"in place?place.position&&(position=place.position):"start"in place||"end"in place?position=place:("line"in place||"column"in place)&&(position.start=place)),this.name=stringifyPosition(place)||"1:1",this.message="object"==typeof reason?reason.message:reason,this.stack="object"==typeof reason?reason.stack:"",this.reason=this.message,this.line=position.start.line,this.column=position.start.column,this.source=parts[0],this.ruleId=parts[1],this.position=position,this.file,this.fatal,this.url,this.note}}VFileMessage.prototype.file="",VFileMessage.prototype.name="",VFileMessage.prototype.reason="",VFileMessage.prototype.message="",VFileMessage.prototype.stack="",VFileMessage.prototype.fatal=null,VFileMessage.prototype.column=null,VFileMessage.prototype.line=null,VFileMessage.prototype.source=null,VFileMessage.prototype.ruleId=null,VFileMessage.prototype.position=null;
// Which is licensed:
// Copyright (c) 2013 James Halliday
// use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
// Which is licensed:
// Copyright Joyent, Inc. and other Node contributors.
// distribute, sublicense, and/or sell copies of the Software, and to permit
const path$1_basename=function(path,ext){if(void 0!==ext&&"string"!=typeof ext)throw new TypeError('"ext" argument must be a string');assertPath$1(path);let seenNonSlash,start=0,end=-1,index=path.length;if(void 0===ext||0===ext.length||ext.length>path.length){for(;index--;)if(47===path.charCodeAt(index)){if(seenNonSlash){start=index+1;break}}else end<0&&(seenNonSlash=!0,end=index+1);return end<0?"":path.slice(start,end)}if(ext===path)return"";let firstNonSlashEnd=-1,extIndex=ext.length-1;for(;index--;)if(47===path.charCodeAt(index)){if(seenNonSlash){start=index+1;break}}else firstNonSlashEnd<0&&(seenNonSlash=!0,firstNonSlashEnd=index+1),extIndex>-1&&(path.charCodeAt(index)===ext.charCodeAt(extIndex--)?extIndex<0&&(end=index):(extIndex=-1,end=firstNonSlashEnd));return start===end?end=firstNonSlashEnd:end<0&&(end=path.length),path.slice(start,end)},path$1_dirname=function(path){if(assertPath$1(path),0===path.length)return".";let unmatchedSlash,end=-1,index=path.length;for(;--index;)if(47===path.charCodeAt(index)){if(unmatchedSlash){end=index;break}}else unmatchedSlash||(unmatchedSlash=!0);return end<0?47===path.charCodeAt(0)?"/":".":1===end&&47===path.charCodeAt(0)?"//":path.slice(0,end)},path$1_extname=function(path){assertPath$1(path);let unmatchedSlash,index=path.length,end=-1,startPart=0,startDot=-1,preDotState=0;for(;index--;){const code=path.charCodeAt(index);if(47!==code)end<0&&(unmatchedSlash=!0,end=index+1),46===code?startDot<0?startDot=index:1!==preDotState&&(preDotState=1):startDot>-1&&(preDotState=-1);else if(unmatchedSlash){startPart=index+1;break}}return startDot<0||end<0||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)},path$1_join=function(...segments){let joined,index=-1;for(;++index<segments.length;)assertPath$1(segments[index]),segments[index]&&(joined=void 0===joined?segments[index]:joined+"/"+segments[index]);return void 0===joined?".":function(path){assertPath$1(path);const absolute=47===path.charCodeAt(0);let value=function(path,allowAboveRoot){let code,lastSlashIndex,result="",lastSegmentLength=0,lastSlash=-1,dots=0,index=-1;for(;++index<=path.length;){if(index<path.length)code=path.charCodeAt(index);else{if(47===code)break;code=47}if(47===code){if(lastSlash===index-1||1===dots);else if(lastSlash!==index-1&&2===dots){if(result.length<2||2!==lastSegmentLength||46!==result.charCodeAt(result.length-1)||46!==result.charCodeAt(result.length-2))if(result.length>2){if(lastSlashIndex=result.lastIndexOf("/"),lastSlashIndex!==result.length-1){lastSlashIndex<0?(result="",lastSegmentLength=0):(result=result.slice(0,lastSlashIndex),lastSegmentLength=result.length-1-result.lastIndexOf("/")),lastSlash=index,dots=0;continue}}else if(result.length>0){result="",lastSegmentLength=0,lastSlash=index,dots=0;continue}allowAboveRoot&&(result=result.length>0?result+"/..":"..",lastSegmentLength=2)}else result.length>0?result+="/"+path.slice(lastSlash+1,index):result=path.slice(lastSlash+1,index),lastSegmentLength=index-lastSlash-1;lastSlash=index,dots=0}else 46===code&&dots>-1?dots++:dots=-1}return result}(path,!absolute);return 0!==value.length||absolute||(value="."),value.length>0&&47===path.charCodeAt(path.length-1)&&(value+="/"),absolute?"/"+value:value}(joined)},path$1_sep="/";function assertPath$1(path){if("string"!=typeof path)throw new TypeError("Path must be a string. Received "+JSON.stringify(path))}const proc_cwd=function(){return"/"};function isUrl(fileURLOrPath){return null!==fileURLOrPath&&"object"==typeof fileURLOrPath&&fileURLOrPath.href&&fileURLOrPath.origin}const order=["history","path","basename","stem","extname","dirname"];class VFile{constructor(value){let options;options=value?"string"==typeof value||isBuffer(value)?{value}:isUrl(value)?{path:value}:value:{},this.data={},this.messages=[],this.history=[],this.cwd=proc_cwd(),this.value,this.stored,this.result,this.map;let prop,index=-1;for(;++index<order.length;){const prop=order[index];prop in options&&void 0!==options[prop]&&(this[prop]="history"===prop?[...options[prop]]:options[prop])}for(prop in options)order.includes(prop)||(this[prop]=options[prop])}get path(){return this.history[this.history.length-1]}set path(path){isUrl(path)&&(path=function(path){if("string"==typeof path)path=new URL(path);else if(!isUrl(path)){const error=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+path+"`");throw error.code="ERR_INVALID_ARG_TYPE",error}if("file:"!==path.protocol){const error=new TypeError("The URL must be of scheme file");throw error.code="ERR_INVALID_URL_SCHEME",error}return function(url){if(""!==url.hostname){const error=new TypeError('File URL host must be "localhost" or empty on darwin');throw error.code="ERR_INVALID_FILE_URL_HOST",error}const pathname=url.pathname;let index=-1;for(;++index<pathname.length;)if(37===pathname.charCodeAt(index)&&50===pathname.charCodeAt(index+1)){const third=pathname.charCodeAt(index+2);if(70===third||102===third){const error=new TypeError("File URL path must not include encoded / characters");throw error.code="ERR_INVALID_FILE_URL_PATH",error}}return decodeURIComponent(pathname)}(path)}(path)),assertNonEmpty(path,"path"),this.path!==path&&this.history.push(path)}get dirname(){return"string"==typeof this.path?path$1_dirname(this.path):void 0}set dirname(dirname){assertPath(this.basename,"dirname"),this.path=path$1_join(dirname||"",this.basename)}get basename(){return"string"==typeof this.path?path$1_basename(this.path):void 0}set basename(basename){assertNonEmpty(basename,"basename"),assertPart(basename,"basename"),this.path=path$1_join(this.dirname||"",basename)}get extname(){return"string"==typeof this.path?path$1_extname(this.path):void 0}set extname(extname){if(assertPart(extname,"extname"),assertPath(this.dirname,"extname"),extname){if(46!==extname.charCodeAt(0))throw new Error("`extname` must start with `.`");if(extname.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=path$1_join(this.dirname,this.stem+(extname||""))}get stem(){return"string"==typeof this.path?path$1_basename(this.path,this.extname):void 0}set stem(stem){assertNonEmpty(stem,"stem"),assertPart(stem,"stem"),this.path=path$1_join(this.dirname||"",stem+(this.extname||""))}toString(encoding){return(this.value||"").toString(encoding)}message(reason,place,origin){const message=new VFileMessage(reason,place,origin);return this.path&&(message.name=this.path+":"+message.name,message.file=this.path),message.fatal=!1,this.messages.push(message),message}info(reason,place,origin){const message=this.message(reason,place,origin);return message.fatal=null,message}fail(reason,place,origin){const message=this.message(reason,place,origin);throw message.fatal=!0,message}}function assertPart(part,name){if(part&&part.includes(path$1_sep))throw new Error("`"+name+"` cannot be a path: did not expect `"+path$1_sep+"`")}function assertNonEmpty(part,name){if(!part)throw new Error("`"+name+"` cannot be empty")}function assertPath(path,name){if(!path)throw new Error("Setting `"+name+"` requires `path` to be set too")}const unified=function base(){const transformers=function(){const fns=[],pipeline={run:function(...values){let middlewareIndex=-1;const callback=values.pop();if("function"!=typeof callback)throw new TypeError("Expected function as last argument, not "+callback);!function next(error,...output){const fn=fns[++middlewareIndex];let index=-1;if(error)callback(error);else{for(;++index<values.length;)null!==output[index]&&void 0!==output[index]||(output[index]=values[index]);values=output,fn?function(middleware,callback){let called;return function(...parameters){const fnExpectsCallback=middleware.length>parameters.length;let result;fnExpectsCallback&&parameters.push(done);try{result=middleware(...parameters)}catch(error){const exception=error;if(fnExpectsCallback&&called)throw exception;return done(exception)}fnExpectsCallback||(result instanceof Promise?result.then(then,done):result instanceof Error?done(result):then(result))};function done(error,...output){called||(called=!0,callback(error,...output))}function then(value){done(null,value)}}(fn,next)(...output):callback(null,...output)}}(null,...values)},use:function(middelware){if("function"!=typeof middelware)throw new TypeError("Expected `middelware` to be a function, not "+middelware);return fns.push(middelware),pipeline}};return pipeline}(),attachers=[];let frozen,namespace={},freezeIndex=-1;return processor.data=function(key,value){return"string"==typeof key?2===arguments.length?(assertUnfrozen("data",frozen),namespace[key]=value,processor):own$3.call(namespace,key)&&namespace[key]||null:key?(assertUnfrozen("data",frozen),namespace=key,processor):namespace},processor.Parser=void 0,processor.Compiler=void 0,processor.freeze=function(){if(frozen)return processor;for(;++freezeIndex<attachers.length;){const[attacher,...options]=attachers[freezeIndex];if(!1===options[0])continue;!0===options[0]&&(options[0]=void 0);const transformer=attacher.call(processor,...options);"function"==typeof transformer&&transformers.use(transformer)}return frozen=!0,freezeIndex=Number.POSITIVE_INFINITY,processor},processor.attachers=attachers,processor.use=function(value,...options){let settings;if(assertUnfrozen("use",frozen),null==value);else if("function"==typeof value)addPlugin(value,...options);else{if("object"!=typeof value)throw new TypeError("Expected usable value, not `"+value+"`");Array.isArray(value)?addList(value):addPreset(value)}return settings&&(namespace.settings=Object.assign(namespace.settings||{},settings)),processor;function add(value){if("function"==typeof value)addPlugin(value);else{if("object"!=typeof value)throw new TypeError("Expected usable value, not `"+value+"`");if(Array.isArray(value)){const[plugin,...options]=value;addPlugin(plugin,...options)}else addPreset(value)}}function addPreset(result){addList(result.plugins),result.settings&&(settings=Object.assign(settings||{},result.settings))}function addList(plugins){let index=-1;if(null==plugins);else{if(!Array.isArray(plugins))throw new TypeError("Expected a list of plugins, not `"+plugins+"`");for(;++index<plugins.length;)add(plugins[index])}}function addPlugin(plugin,value){let entry,index=-1;for(;++index<attachers.length;)if(attachers[index][0]===plugin){entry=attachers[index];break}entry?(isPlainObject(entry[1])&&isPlainObject(value)&&(value=extend(!0,entry[1],value)),entry[1]=value):attachers.push([...arguments])}},processor.parse=function(doc){processor.freeze();const file=vfile(doc),Parser=processor.Parser;return assertParser("parse",Parser),newable(Parser,"parse")?new Parser(String(file),file).parse():Parser(String(file),file)},processor.stringify=function(node,doc){processor.freeze();const file=vfile(doc),Compiler=processor.Compiler;return assertCompiler("stringify",Compiler),assertNode(node),newable(Compiler,"compile")?new Compiler(node,file).compile():Compiler(node,file)},processor.run=function(node,doc,callback){if(assertNode(node),processor.freeze(),callback||"function"!=typeof doc||(callback=doc,doc=void 0),!callback)return new Promise(executor);function executor(resolve,reject){transformers.run(node,vfile(doc),(function(error,tree,file){tree=tree||node,error?reject(error):resolve?resolve(tree):callback(null,tree,file)}))}executor(null,callback)},processor.runSync=function(node,file){let result,complete;return processor.run(node,file,(function(error,tree){bail(error),result=tree,complete=!0})),assertDone("runSync","run",complete),result},processor.process=function(doc,callback){if(processor.freeze(),assertParser("process",processor.Parser),assertCompiler("process",processor.Compiler),!callback)return new Promise(executor);function executor(resolve,reject){const file=vfile(doc);function done(error,file){error||!file?reject(error):resolve?resolve(file):callback(null,file)}processor.run(processor.parse(file),file,((error,tree,file)=>{if(!error&&tree&&file){const result=processor.stringify(tree,file);null==result||("string"==typeof(value=result)||isBuffer(value)?file.value=result:file.result=result),done(error,file)}else done(error);var value}))}executor(null,callback)},processor.processSync=function(doc){let complete;processor.freeze(),assertParser("processSync",processor.Parser),assertCompiler("processSync",processor.Compiler);const file=vfile(doc);return processor.process(file,(function(error){complete=!0,bail(error)})),assertDone("processSync","process",complete),file},processor;function processor(){const destination=base();let index=-1;for(;++index<attachers.length;)destination.use(...attachers[index]);return destination.data(extend(!0,{},namespace)),destination}}().freeze(),own$3={}.hasOwnProperty;function newable(value,name){return"function"==typeof value&&value.prototype&&(function(value){let key;for(key in value)if(own$3.call(value,key))return!0;return!1}(value.prototype)||name in value.prototype)}function assertParser(name,value){if("function"!=typeof value)throw new TypeError("Cannot `"+name+"` without `Parser`")}function assertCompiler(name,value){if("function"!=typeof value)throw new TypeError("Cannot `"+name+"` without `Compiler`")}function assertUnfrozen(name,frozen){if(frozen)throw new Error("Cannot call `"+name+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function assertNode(node){if(!isPlainObject(node)||"string"!=typeof node.type)throw new TypeError("Expected node, got `"+node+"`")}function assertDone(name,asyncName,complete){if(!complete)throw new Error("`"+name+"` finished async. Use `"+asyncName+"` instead")}function vfile(value){return function(value){return Boolean(value&&"object"==typeof value&&"message"in value&&"messages"in value)}(value)?value:new VFile(value)}function toString(node,options){var{includeImageAlt=!0}=options||{};return one(node,includeImageAlt)}function one(node,includeImageAlt){return node&&"object"==typeof node&&(node.value||(includeImageAlt?node.alt:"")||"children"in node&&all(node.children,includeImageAlt)||Array.isArray(node)&&all(node,includeImageAlt))||""}function all(values,includeImageAlt){for(var result=[],index=-1;++index<values.length;)result[index]=one(values[index],includeImageAlt);return result.join("")}function splice(list,start,remove,items){const end=list.length;let parameters,chunkStart=0;if(start=start<0?-start>end?0:end+start:start>end?end:start,remove=remove>0?remove:0,items.length<1e4)parameters=Array.from(items),parameters.unshift(start,remove),[].splice.apply(list,parameters);else for(remove&&[].splice.apply(list,[start,remove]);chunkStart<items.length;)parameters=items.slice(chunkStart,chunkStart+1e4),parameters.unshift(start,0),[].splice.apply(list,parameters),chunkStart+=1e4,start+=1e4}function push(list,items){return list.length>0?(splice(list,list.length,0,items),list):items}const hasOwnProperty={}.hasOwnProperty;function combineExtensions(extensions){const all={};let index=-1;for(;++index<extensions.length;)syntaxExtension(all,extensions[index]);return all}function syntaxExtension(all,extension){let hook;for(hook in extension){const left=(hasOwnProperty.call(all,hook)?all[hook]:void 0)||(all[hook]={}),right=extension[hook];let code;for(code in right){hasOwnProperty.call(left,code)||(left[code]=[]);const value=right[code];constructs(left[code],Array.isArray(value)?value:value?[value]:[])}}}function constructs(existing,list){let index=-1;const before=[];for(;++index<list.length;)("after"===list[index].add?existing:before).push(list[index]);splice(existing,0,0,before)}const asciiAlpha=regexCheck(/[A-Za-z]/),asciiDigit=regexCheck(/\d/),asciiHexDigit=regexCheck(/[\dA-Fa-f]/),asciiAlphanumeric=regexCheck(/[\dA-Za-z]/),asciiPunctuation=regexCheck(/[!-/:-@[-`{-~]/),asciiAtext=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(code){return null!==code&&(code<32||127===code)}function markdownLineEndingOrSpace(code){return null!==code&&(code<0||32===code)}function markdownLineEnding(code){return null!==code&&code<-2}function markdownSpace(code){return-2===code||-1===code||32===code}const unicodeWhitespace=regexCheck(/\s/),unicodePunctuation=regexCheck(/[!-/:-@[-`{-~\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/);function regexCheck(regex){return function(code){return null!==code&&regex.test(String.fromCharCode(code))}}function factorySpace(effects,ok,type,max){const limit=max?max-1:Number.POSITIVE_INFINITY;let size=0;return function(code){return markdownSpace(code)?(effects.enter(type),prefix(code)):ok(code)};function prefix(code){return markdownSpace(code)&&size++<limit?(effects.consume(code),prefix):(effects.exit(type),ok(code))}}const content$1={tokenize:function(effects){const contentStart=effects.attempt(this.parser.constructs.contentInitial,(function(code){if(null!==code)return effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),factorySpace(effects,contentStart,"linePrefix");effects.consume(code)}),(function(code){return effects.enter("paragraph"),lineStart(code)}));let previous;return contentStart;function lineStart(code){const token=effects.enter("chunkText",{contentType:"text",previous});return previous&&(previous.next=token),previous=token,data(code)}function data(code){return null===code?(effects.exit("chunkText"),effects.exit("paragraph"),void effects.consume(code)):markdownLineEnding(code)?(effects.consume(code),effects.exit("chunkText"),lineStart):(effects.consume(code),data)}}},document$2={tokenize:function(effects){const self=this,stack=[];let childFlow,childToken,lineStartOffset,continued=0;return start;function start(code){if(continued<stack.length){const item=stack[continued];return self.containerState=item[1],effects.attempt(item[0].continuation,documentContinue,checkNewContainers)(code)}return checkNewContainers(code)}function documentContinue(code){if(continued++,self.containerState._closeFlow){self.containerState._closeFlow=void 0,childFlow&&closeFlow();const indexBeforeExits=self.events.length;let point,indexBeforeFlow=indexBeforeExits;for(;indexBeforeFlow--;)if("exit"===self.events[indexBeforeFlow][0]&&"chunkFlow"===self.events[indexBeforeFlow][1].type){point=self.events[indexBeforeFlow][1].end;break}exitContainers(continued);let index=indexBeforeExits;for(;index<self.events.length;)self.events[index][1].end=Object.assign({},point),index++;return splice(self.events,indexBeforeFlow+1,0,self.events.slice(indexBeforeExits)),self.events.length=index,checkNewContainers(code)}return start(code)}function checkNewContainers(code){if(continued===stack.length){if(!childFlow)return documentContinued(code);if(childFlow.currentConstruct&&childFlow.currentConstruct.concrete)return flowStart(code);self.interrupt=Boolean(childFlow.currentConstruct)}return self.containerState={},effects.check(containerConstruct,thereIsANewContainer,thereIsNoNewContainer)(code)}function thereIsANewContainer(code){return childFlow&&closeFlow(),exitContainers(continued),documentContinued(code)}function thereIsNoNewContainer(code){return self.parser.lazy[self.now().line]=continued!==stack.length,lineStartOffset=self.now().offset,flowStart(code)}function documentContinued(code){return self.containerState={},effects.attempt(containerConstruct,containerContinue,flowStart)(code)}function containerContinue(code){return continued++,stack.push([self.currentConstruct,self.containerState]),documentContinued(code)}function flowStart(code){return null===code?(childFlow&&closeFlow(),exitContainers(0),void effects.consume(code)):(childFlow=childFlow||self.parser.flow(self.now()),effects.enter("chunkFlow",{contentType:"flow",previous:childToken,_tokenizer:childFlow}),flowContinue(code))}function flowContinue(code){return null===code?(writeToChild(effects.exit("chunkFlow"),!0),exitContainers(0),void effects.consume(code)):markdownLineEnding(code)?(effects.consume(code),writeToChild(effects.exit("chunkFlow")),continued=0,self.interrupt=void 0,start):(effects.consume(code),flowContinue)}function writeToChild(token,eof){const stream=self.sliceStream(token);if(eof&&stream.push(null),token.previous=childToken,childToken&&(childToken.next=token),childToken=token,childFlow.defineSkip(token.start),childFlow.write(stream),self.parser.lazy[token.start.line]){let index=childFlow.events.length;for(;index--;)if(childFlow.events[index][1].start.offset<lineStartOffset&&(!childFlow.events[index][1].end||childFlow.events[index][1].end.offset>lineStartOffset))return;const indexBeforeExits=self.events.length;let seen,point,indexBeforeFlow=indexBeforeExits;for(;indexBeforeFlow--;)if("exit"===self.events[indexBeforeFlow][0]&&"chunkFlow"===self.events[indexBeforeFlow][1].type){if(seen){point=self.events[indexBeforeFlow][1].end;break}seen=!0}for(exitContainers(continued),index=indexBeforeExits;index<self.events.length;)self.events[index][1].end=Object.assign({},point),index++;splice(self.events,indexBeforeFlow+1,0,self.events.slice(indexBeforeExits)),self.events.length=index}}function exitContainers(size){let index=stack.length;for(;index-- >size;){const entry=stack[index];self.containerState=entry[1],entry[0].exit.call(self,effects)}stack.length=size}function closeFlow(){childFlow.write([null]),childToken=void 0,childFlow=void 0,self.containerState._closeFlow=void 0}}},containerConstruct={tokenize:function(effects,ok,nok){return factorySpace(effects,effects.attempt(this.parser.constructs.document,ok,nok),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};function classifyCharacter(code){return null===code||markdownLineEndingOrSpace(code)||unicodeWhitespace(code)?1:unicodePunctuation(code)?2:void 0}function resolveAll(constructs,events,context){const called=[];let index=-1;for(;++index<constructs.length;){const resolve=constructs[index].resolveAll;resolve&&!called.includes(resolve)&&(events=resolve(events,context),called.push(resolve))}return events}const attention={name:"attention",tokenize:function(effects,ok){const attentionMarkers=this.parser.constructs.attentionMarkers.null,previous=this.previous,before=classifyCharacter(previous);let marker;return function(code){return effects.enter("attentionSequence"),marker=code,sequence(code)};function sequence(code){if(code===marker)return effects.consume(code),sequence;const token=effects.exit("attentionSequence"),after=classifyCharacter(code),open=!after||2===after&&before||attentionMarkers.includes(code),close=!before||2===before&&after||attentionMarkers.includes(previous);return token._open=Boolean(42===marker?open:open&&(before||!close)),token._close=Boolean(42===marker?close:close&&(after||!open)),ok(code)}},resolveAll:function(events,context){let open,group,text,openingSequence,closingSequence,use,nextEvents,offset,index=-1;for(;++index<events.length;)if("enter"===events[index][0]&&"attentionSequence"===events[index][1].type&&events[index][1]._close)for(open=index;open--;)if("exit"===events[open][0]&&"attentionSequence"===events[open][1].type&&events[open][1]._open&&context.sliceSerialize(events[open][1]).charCodeAt(0)===context.sliceSerialize(events[index][1]).charCodeAt(0)){if((events[open][1]._close||events[index][1]._open)&&(events[index][1].end.offset-events[index][1].start.offset)%3&&!((events[open][1].end.offset-events[open][1].start.offset+events[index][1].end.offset-events[index][1].start.offset)%3))continue;use=events[open][1].end.offset-events[open][1].start.offset>1&&events[index][1].end.offset-events[index][1].start.offset>1?2:1;const start=Object.assign({},events[open][1].end),end=Object.assign({},events[index][1].start);movePoint(start,-use),movePoint(end,use),openingSequence={type:use>1?"strongSequence":"emphasisSequence",start,end:Object.assign({},events[open][1].end)},closingSequence={type:use>1?"strongSequence":"emphasisSequence",start:Object.assign({},events[index][1].start),end},text={type:use>1?"strongText":"emphasisText",start:Object.assign({},events[open][1].end),end:Object.assign({},events[index][1].start)},group={type:use>1?"strong":"emphasis",start:Object.assign({},openingSequence.start),end:Object.assign({},closingSequence.end)},events[open][1].end=Object.assign({},openingSequence.start),events[index][1].start=Object.assign({},closingSequence.end),nextEvents=[],events[open][1].end.offset-events[open][1].start.offset&&(nextEvents=push(nextEvents,[["enter",events[open][1],context],["exit",events[open][1],context]])),nextEvents=push(nextEvents,[["enter",group,context],["enter",openingSequence,context],["exit",openingSequence,context],["enter",text,context]]),nextEvents=push(nextEvents,resolveAll(context.parser.constructs.insideSpan.null,events.slice(open+1,index),context)),nextEvents=push(nextEvents,[["exit",text,context],["enter",closingSequence,context],["exit",closingSequence,context],["exit",group,context]]),events[index][1].end.offset-events[index][1].start.offset?(offset=2,nextEvents=push(nextEvents,[["enter",events[index][1],context],["exit",events[index][1],context]])):offset=0,splice(events,open-1,index-open+3,nextEvents),index=open+nextEvents.length-offset-2;break}for(index=-1;++index<events.length;)"attentionSequence"===events[index][1].type&&(events[index][1].type="data");return events}};function movePoint(point,offset){point.column+=offset,point.offset+=offset,point._bufferIndex+=offset}const autolink={name:"autolink",tokenize:function(effects,ok,nok){let size=1;return function(code){return effects.enter("autolink"),effects.enter("autolinkMarker"),effects.consume(code),effects.exit("autolinkMarker"),effects.enter("autolinkProtocol"),open};function open(code){return asciiAlpha(code)?(effects.consume(code),schemeOrEmailAtext):asciiAtext(code)?emailAtext(code):nok(code)}function schemeOrEmailAtext(code){return 43===code||45===code||46===code||asciiAlphanumeric(code)?schemeInsideOrEmailAtext(code):emailAtext(code)}function schemeInsideOrEmailAtext(code){return 58===code?(effects.consume(code),urlInside):(43===code||45===code||46===code||asciiAlphanumeric(code))&&size++<32?(effects.consume(code),schemeInsideOrEmailAtext):emailAtext(code)}function urlInside(code){return 62===code?(effects.exit("autolinkProtocol"),end(code)):null===code||32===code||60===code||asciiControl(code)?nok(code):(effects.consume(code),urlInside)}function emailAtext(code){return 64===code?(effects.consume(code),size=0,emailAtSignOrDot):asciiAtext(code)?(effects.consume(code),emailAtext):nok(code)}function emailAtSignOrDot(code){return asciiAlphanumeric(code)?emailLabel(code):nok(code)}function emailLabel(code){return 46===code?(effects.consume(code),size=0,emailAtSignOrDot):62===code?(effects.exit("autolinkProtocol").type="autolinkEmail",end(code)):emailValue(code)}function emailValue(code){return(45===code||asciiAlphanumeric(code))&&size++<63?(effects.consume(code),45===code?emailValue:emailLabel):nok(code)}function end(code){return effects.enter("autolinkMarker"),effects.consume(code),effects.exit("autolinkMarker"),effects.exit("autolink"),ok}}},blankLine={tokenize:function(effects,ok,nok){return factorySpace(effects,(function(code){return null===code||markdownLineEnding(code)?ok(code):nok(code)}),"linePrefix")},partial:!0},blockQuote={name:"blockQuote",tokenize:function(effects,ok,nok){const self=this;return function(code){if(62===code){const state=self.containerState;return state.open||(effects.enter("blockQuote",{_container:!0}),state.open=!0),effects.enter("blockQuotePrefix"),effects.enter("blockQuoteMarker"),effects.consume(code),effects.exit("blockQuoteMarker"),after}return nok(code)};function after(code){return markdownSpace(code)?(effects.enter("blockQuotePrefixWhitespace"),effects.consume(code),effects.exit("blockQuotePrefixWhitespace"),effects.exit("blockQuotePrefix"),ok):(effects.exit("blockQuotePrefix"),ok(code))}},continuation:{tokenize:function(effects,ok,nok){return factorySpace(effects,effects.attempt(blockQuote,ok,nok),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}},exit:function(effects){effects.exit("blockQuote")}},characterEscape={name:"characterEscape",tokenize:function(effects,ok,nok){return function(code){return effects.enter("characterEscape"),effects.enter("escapeMarker"),effects.consume(code),effects.exit("escapeMarker"),open};function open(code){return asciiPunctuation(code)?(effects.enter("characterEscapeValue"),effects.consume(code),effects.exit("characterEscapeValue"),effects.exit("characterEscape"),ok):nok(code)}}};var element;function decodeEntity(characters){var char,entity="&"+characters+";";return(element=element||document.createElement("i")).innerHTML=entity,(59!==(char=element.textContent).charCodeAt(char.length-1)||"semi"===characters)&&char!==entity&&char}const characterReference={name:"characterReference",tokenize:function(effects,ok,nok){const self=this;let max,test,size=0;return function(code){return effects.enter("characterReference"),effects.enter("characterReferenceMarker"),effects.consume(code),effects.exit("characterReferenceMarker"),open};function open(code){return 35===code?(effects.enter("characterReferenceMarkerNumeric"),effects.consume(code),effects.exit("characterReferenceMarkerNumeric"),numeric):(effects.enter("characterReferenceValue"),max=31,test=asciiAlphanumeric,value(code))}function numeric(code){return 88===code||120===code?(effects.enter("characterReferenceMarkerHexadecimal"),effects.consume(code),effects.exit("characterReferenceMarkerHexadecimal"),effects.enter("characterReferenceValue"),max=6,test=asciiHexDigit,value):(effects.enter("characterReferenceValue"),max=7,test=asciiDigit,value(code))}function value(code){let token;return 59===code&&size?(token=effects.exit("characterReferenceValue"),test!==asciiAlphanumeric||decodeEntity(self.sliceSerialize(token))?(effects.enter("characterReferenceMarker"),effects.consume(code),effects.exit("characterReferenceMarker"),effects.exit("characterReference"),ok):nok(code)):test(code)&&size++<max?(effects.consume(code),value):nok(code)}}},codeFenced={name:"codeFenced",tokenize:function(effects,ok,nok){const self=this,closingFenceConstruct={tokenize:function(effects,ok,nok){let size=0;return factorySpace(effects,(function(code){return effects.enter("codeFencedFence"),effects.enter("codeFencedFenceSequence"),closingSequence(code)}),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function closingSequence(code){return code===marker?(effects.consume(code),size++,closingSequence):size<sizeOpen?nok(code):(effects.exit("codeFencedFenceSequence"),factorySpace(effects,closingSequenceEnd,"whitespace")(code))}function closingSequenceEnd(code){return null===code||markdownLineEnding(code)?(effects.exit("codeFencedFence"),ok(code)):nok(code)}},partial:!0},nonLazyLine={tokenize:function(effects,ok,nok){const self=this;return function(code){return effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),lineStart};function lineStart(code){return self.parser.lazy[self.now().line]?nok(code):ok(code)}},partial:!0},tail=this.events[this.events.length-1],initialPrefix=tail&&"linePrefix"===tail[1].type?tail[2].sliceSerialize(tail[1],!0).length:0;let marker,sizeOpen=0;return function(code){return effects.enter("codeFenced"),effects.enter("codeFencedFence"),effects.enter("codeFencedFenceSequence"),marker=code,sequenceOpen(code)};function sequenceOpen(code){return code===marker?(effects.consume(code),sizeOpen++,sequenceOpen):(effects.exit("codeFencedFenceSequence"),sizeOpen<3?nok(code):factorySpace(effects,infoOpen,"whitespace")(code))}function infoOpen(code){return null===code||markdownLineEnding(code)?openAfter(code):(effects.enter("codeFencedFenceInfo"),effects.enter("chunkString",{contentType:"string"}),info(code))}function info(code){return null===code||markdownLineEndingOrSpace(code)?(effects.exit("chunkString"),effects.exit("codeFencedFenceInfo"),factorySpace(effects,infoAfter,"whitespace")(code)):96===code&&code===marker?nok(code):(effects.consume(code),info)}function infoAfter(code){return null===code||markdownLineEnding(code)?openAfter(code):(effects.enter("codeFencedFenceMeta"),effects.enter("chunkString",{contentType:"string"}),meta(code))}function meta(code){return null===code||markdownLineEnding(code)?(effects.exit("chunkString"),effects.exit("codeFencedFenceMeta"),openAfter(code)):96===code&&code===marker?nok(code):(effects.consume(code),meta)}function openAfter(code){return effects.exit("codeFencedFence"),self.interrupt?ok(code):contentStart(code)}function contentStart(code){return null===code?after(code):markdownLineEnding(code)?effects.attempt(nonLazyLine,effects.attempt(closingFenceConstruct,after,initialPrefix?factorySpace(effects,contentStart,"linePrefix",initialPrefix+1):contentStart),after)(code):(effects.enter("codeFlowValue"),contentContinue(code))}function contentContinue(code){return null===code||markdownLineEnding(code)?(effects.exit("codeFlowValue"),contentStart(code)):(effects.consume(code),contentContinue)}function after(code){return effects.exit("codeFenced"),ok(code)}},concrete:!0},codeIndented={name:"codeIndented",tokenize:function(effects,ok,nok){const self=this;return function(code){return effects.enter("codeIndented"),factorySpace(effects,afterStartPrefix,"linePrefix",5)(code)};function afterStartPrefix(code){const tail=self.events[self.events.length-1];return tail&&"linePrefix"===tail[1].type&&tail[2].sliceSerialize(tail[1],!0).length>=4?afterPrefix(code):nok(code)}function afterPrefix(code){return null===code?after(code):markdownLineEnding(code)?effects.attempt(indentedContent,afterPrefix,after)(code):(effects.enter("codeFlowValue"),content(code))}function content(code){return null===code||markdownLineEnding(code)?(effects.exit("codeFlowValue"),afterPrefix(code)):(effects.consume(code),content)}function after(code){return effects.exit("codeIndented"),ok(code)}}},indentedContent={tokenize:function(effects,ok,nok){const self=this;return start;function start(code){return self.parser.lazy[self.now().line]?nok(code):markdownLineEnding(code)?(effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),start):factorySpace(effects,afterPrefix,"linePrefix",5)(code)}function afterPrefix(code){const tail=self.events[self.events.length-1];return tail&&"linePrefix"===tail[1].type&&tail[2].sliceSerialize(tail[1],!0).length>=4?ok(code):markdownLineEnding(code)?start(code):nok(code)}},partial:!0},codeText={name:"codeText",tokenize:function(effects,ok,nok){let size,token,sizeOpen=0;return function(code){return effects.enter("codeText"),effects.enter("codeTextSequence"),openingSequence(code)};function openingSequence(code){return 96===code?(effects.consume(code),sizeOpen++,openingSequence):(effects.exit("codeTextSequence"),gap(code))}function gap(code){return null===code?nok(code):96===code?(token=effects.enter("codeTextSequence"),size=0,closingSequence(code)):32===code?(effects.enter("space"),effects.consume(code),effects.exit("space"),gap):markdownLineEnding(code)?(effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),gap):(effects.enter("codeTextData"),data(code))}function data(code){return null===code||32===code||96===code||markdownLineEnding(code)?(effects.exit("codeTextData"),gap(code)):(effects.consume(code),data)}function closingSequence(code){return 96===code?(effects.consume(code),size++,closingSequence):size===sizeOpen?(effects.exit("codeTextSequence"),effects.exit("codeText"),ok(code)):(token.type="codeTextData",data(code))}},resolve:function(events){let index,enter,tailExitIndex=events.length-4,headEnterIndex=3;if(!("lineEnding"!==events[headEnterIndex][1].type&&"space"!==events[headEnterIndex][1].type||"lineEnding"!==events[tailExitIndex][1].type&&"space"!==events[tailExitIndex][1].type))for(index=headEnterIndex;++index<tailExitIndex;)if("codeTextData"===events[index][1].type){events[headEnterIndex][1].type="codeTextPadding",events[tailExitIndex][1].type="codeTextPadding",headEnterIndex+=2,tailExitIndex-=2;break}for(index=headEnterIndex-1,tailExitIndex++;++index<=tailExitIndex;)void 0===enter?index!==tailExitIndex&&"lineEnding"!==events[index][1].type&&(enter=index):index!==tailExitIndex&&"lineEnding"!==events[index][1].type||(events[enter][1].type="codeTextData",index!==enter+2&&(events[enter][1].end=events[index-1][1].end,events.splice(enter+2,index-enter-2),tailExitIndex-=index-enter-2,index=enter+2),enter=void 0);return events},previous:function(code){return 96!==code||"characterEscape"===this.events[this.events.length-1][1].type}};function subtokenize(events){const jumps={};let event,lineIndex,otherIndex,otherEvent,parameters,subevents,more,index=-1;for(;++index<events.length;){for(;index in jumps;)index=jumps[index];if(event=events[index],index&&"chunkFlow"===event[1].type&&"listItemPrefix"===events[index-1][1].type&&(subevents=event[1]._tokenizer.events,otherIndex=0,otherIndex<subevents.length&&"lineEndingBlank"===subevents[otherIndex][1].type&&(otherIndex+=2),otherIndex<subevents.length&&"content"===subevents[otherIndex][1].type))for(;++otherIndex<subevents.length&&"content"!==subevents[otherIndex][1].type;)"chunkText"===subevents[otherIndex][1].type&&(subevents[otherIndex][1]._isInFirstContentOfListItem=!0,otherIndex++);if("enter"===event[0])event[1].contentType&&(Object.assign(jumps,subcontent(events,index)),index=jumps[index],more=!0);else if(event[1]._container){for(otherIndex=index,lineIndex=void 0;otherIndex--&&(otherEvent=events[otherIndex],"lineEnding"===otherEvent[1].type||"lineEndingBlank"===otherEvent[1].type);)"enter"===otherEvent[0]&&(lineIndex&&(events[lineIndex][1].type="lineEndingBlank"),otherEvent[1].type="lineEnding",lineIndex=otherIndex);lineIndex&&(event[1].end=Object.assign({},events[lineIndex][1].start),parameters=events.slice(lineIndex,index),parameters.unshift(event),splice(events,lineIndex,index-lineIndex+1,parameters))}}return!more}function subcontent(events,eventIndex){const token=events[eventIndex][1],context=events[eventIndex][2];let startPosition=eventIndex-1;const startPositions=[],tokenizer=token._tokenizer||context.parser[token.contentType](token.start),childEvents=tokenizer.events,jumps=[],gaps={};let stream,previous,index=-1,current=token,adjust=0,start=0;const breaks=[start];for(;current;){for(;events[++startPosition][1]!==current;);startPositions.push(startPosition),current._tokenizer||(stream=context.sliceStream(current),current.next||stream.push(null),previous&&tokenizer.defineSkip(current.start),current._isInFirstContentOfListItem&&(tokenizer._gfmTasklistFirstContentOfListItem=!0),tokenizer.write(stream),current._isInFirstContentOfListItem&&(tokenizer._gfmTasklistFirstContentOfListItem=void 0)),previous=current,current=current.next}for(current=token;++index<childEvents.length;)"exit"===childEvents[index][0]&&"enter"===childEvents[index-1][0]&&childEvents[index][1].type===childEvents[index-1][1].type&&childEvents[index][1].start.line!==childEvents[index][1].end.line&&(start=index+1,breaks.push(start),current._tokenizer=void 0,current.previous=void 0,current=current.next);for(tokenizer.events=[],current?(current._tokenizer=void 0,current.previous=void 0):breaks.pop(),index=breaks.length;index--;){const slice=childEvents.slice(breaks[index],breaks[index+1]),start=startPositions.pop();jumps.unshift([start,start+slice.length-1]),splice(events,start,2,slice)}for(index=-1;++index<jumps.length;)gaps[adjust+jumps[index][0]]=adjust+jumps[index][1],adjust+=jumps[index][1]-jumps[index][0]-1;return gaps}const content={tokenize:function(effects,ok){let previous;return function(code){return effects.enter("content"),previous=effects.enter("chunkContent",{contentType:"content"}),data(code)};function data(code){return null===code?contentEnd(code):markdownLineEnding(code)?effects.check(continuationConstruct,contentContinue,contentEnd)(code):(effects.consume(code),data)}function contentEnd(code){return effects.exit("chunkContent"),effects.exit("content"),ok(code)}function contentContinue(code){return effects.consume(code),effects.exit("chunkContent"),previous.next=effects.enter("chunkContent",{contentType:"content",previous}),previous=previous.next,data}},resolve:function(events){return subtokenize(events),events}},continuationConstruct={tokenize:function(effects,ok,nok){const self=this;return function(code){return effects.exit("chunkContent"),effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),factorySpace(effects,prefixed,"linePrefix")};function prefixed(code){if(null===code||markdownLineEnding(code))return nok(code);const tail=self.events[self.events.length-1];return!self.parser.constructs.disable.null.includes("codeIndented")&&tail&&"linePrefix"===tail[1].type&&tail[2].sliceSerialize(tail[1],!0).length>=4?ok(code):effects.interrupt(self.parser.constructs.flow,nok,ok)(code)}},partial:!0};function factoryDestination(effects,ok,nok,type,literalType,literalMarkerType,rawType,stringType,max){const limit=max||Number.POSITIVE_INFINITY;let balance=0;return function(code){return 60===code?(effects.enter(type),effects.enter(literalType),effects.enter(literalMarkerType),effects.consume(code),effects.exit(literalMarkerType),destinationEnclosedBefore):null===code||41===code||asciiControl(code)?nok(code):(effects.enter(type),effects.enter(rawType),effects.enter(stringType),effects.enter("chunkString",{contentType:"string"}),destinationRaw(code))};function destinationEnclosedBefore(code){return 62===code?(effects.enter(literalMarkerType),effects.consume(code),effects.exit(literalMarkerType),effects.exit(literalType),effects.exit(type),ok):(effects.enter(stringType),effects.enter("chunkString",{contentType:"string"}),destinationEnclosed(code))}function destinationEnclosed(code){return 62===code?(effects.exit("chunkString"),effects.exit(stringType),destinationEnclosedBefore(code)):null===code||60===code||markdownLineEnding(code)?nok(code):(effects.consume(code),92===code?destinationEnclosedEscape:destinationEnclosed)}function destinationEnclosedEscape(code){return 60===code||62===code||92===code?(effects.consume(code),destinationEnclosed):destinationEnclosed(code)}function destinationRaw(code){return 40===code?++balance>limit?nok(code):(effects.consume(code),destinationRaw):41===code?balance--?(effects.consume(code),destinationRaw):(effects.exit("chunkString"),effects.exit(stringType),effects.exit(rawType),effects.exit(type),ok(code)):null===code||markdownLineEndingOrSpace(code)?balance?nok(code):(effects.exit("chunkString"),effects.exit(stringType),effects.exit(rawType),effects.exit(type),ok(code)):asciiControl(code)?nok(code):(effects.consume(code),92===code?destinationRawEscape:destinationRaw)}function destinationRawEscape(code){return 40===code||41===code||92===code?(effects.consume(code),destinationRaw):destinationRaw(code)}}function factoryLabel(effects,ok,nok,type,markerType,stringType){const self=this;let data,size=0;return function(code){return effects.enter(type),effects.enter(markerType),effects.consume(code),effects.exit(markerType),effects.enter(stringType),atBreak};function atBreak(code){return null===code||91===code||93===code&&!data||94===code&&!size&&"_hiddenFootnoteSupport"in self.parser.constructs||size>999?nok(code):93===code?(effects.exit(stringType),effects.enter(markerType),effects.consume(code),effects.exit(markerType),effects.exit(type),ok):markdownLineEnding(code)?(effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),atBreak):(effects.enter("chunkString",{contentType:"string"}),label(code))}function label(code){return null===code||91===code||93===code||markdownLineEnding(code)||size++>999?(effects.exit("chunkString"),atBreak(code)):(effects.consume(code),data=data||!markdownSpace(code),92===code?labelEscape:label)}function labelEscape(code){return 91===code||92===code||93===code?(effects.consume(code),size++,label):label(code)}}function factoryTitle(effects,ok,nok,type,markerType,stringType){let marker;return function(code){return effects.enter(type),effects.enter(markerType),effects.consume(code),effects.exit(markerType),marker=40===code?41:code,atFirstTitleBreak};function atFirstTitleBreak(code){return code===marker?(effects.enter(markerType),effects.consume(code),effects.exit(markerType),effects.exit(type),ok):(effects.enter(stringType),atTitleBreak(code))}function atTitleBreak(code){return code===marker?(effects.exit(stringType),atFirstTitleBreak(marker)):null===code?nok(code):markdownLineEnding(code)?(effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),factorySpace(effects,atTitleBreak,"linePrefix")):(effects.enter("chunkString",{contentType:"string"}),title(code))}function title(code){return code===marker||null===code||markdownLineEnding(code)?(effects.exit("chunkString"),atTitleBreak(code)):(effects.consume(code),92===code?titleEscape:title)}function titleEscape(code){return code===marker||92===code?(effects.consume(code),title):title(code)}}function factoryWhitespace(effects,ok){let seen;return function start(code){return markdownLineEnding(code)?(effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),seen=!0,start):markdownSpace(code)?factorySpace(effects,start,seen?"linePrefix":"lineSuffix")(code):ok(code)}}function normalizeIdentifier(value){return value.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const definition$1={name:"definition",tokenize:function(effects,ok,nok){const self=this;let identifier;return function(code){return effects.enter("definition"),factoryLabel.call(self,effects,labelAfter,nok,"definitionLabel","definitionLabelMarker","definitionLabelString")(code)};function labelAfter(code){return identifier=normalizeIdentifier(self.sliceSerialize(self.events[self.events.length-1][1]).slice(1,-1)),58===code?(effects.enter("definitionMarker"),effects.consume(code),effects.exit("definitionMarker"),factoryWhitespace(effects,factoryDestination(effects,effects.attempt(titleConstruct,factorySpace(effects,after,"whitespace"),factorySpace(effects,after,"whitespace")),nok,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):nok(code)}function after(code){return null===code||markdownLineEnding(code)?(effects.exit("definition"),self.parser.defined.includes(identifier)||self.parser.defined.push(identifier),ok(code)):nok(code)}}},titleConstruct={tokenize:function(effects,ok,nok){return function(code){return markdownLineEndingOrSpace(code)?factoryWhitespace(effects,before)(code):nok(code)};function before(code){return 34===code||39===code||40===code?factoryTitle(effects,factorySpace(effects,after,"whitespace"),nok,"definitionTitle","definitionTitleMarker","definitionTitleString")(code):nok(code)}function after(code){return null===code||markdownLineEnding(code)?ok(code):nok(code)}},partial:!0},hardBreakEscape={name:"hardBreakEscape",tokenize:function(effects,ok,nok){return function(code){return effects.enter("hardBreakEscape"),effects.enter("escapeMarker"),effects.consume(code),open};function open(code){return markdownLineEnding(code)?(effects.exit("escapeMarker"),effects.exit("hardBreakEscape"),ok(code)):nok(code)}}},headingAtx={name:"headingAtx",tokenize:function(effects,ok,nok){const self=this;let size=0;return function(code){return effects.enter("atxHeading"),effects.enter("atxHeadingSequence"),fenceOpenInside(code)};function fenceOpenInside(code){return 35===code&&size++<6?(effects.consume(code),fenceOpenInside):null===code||markdownLineEndingOrSpace(code)?(effects.exit("atxHeadingSequence"),self.interrupt?ok(code):headingBreak(code)):nok(code)}function headingBreak(code){return 35===code?(effects.enter("atxHeadingSequence"),sequence(code)):null===code||markdownLineEnding(code)?(effects.exit("atxHeading"),ok(code)):markdownSpace(code)?factorySpace(effects,headingBreak,"whitespace")(code):(effects.enter("atxHeadingText"),data(code))}function sequence(code){return 35===code?(effects.consume(code),sequence):(effects.exit("atxHeadingSequence"),headingBreak(code))}function data(code){return null===code||35===code||markdownLineEndingOrSpace(code)?(effects.exit("atxHeadingText"),headingBreak(code)):(effects.consume(code),data)}},resolve:function(events,context){let content,text,contentEnd=events.length-2,contentStart=3;return"whitespace"===events[contentStart][1].type&&(contentStart+=2),contentEnd-2>contentStart&&"whitespace"===events[contentEnd][1].type&&(contentEnd-=2),"atxHeadingSequence"===events[contentEnd][1].type&&(contentStart===contentEnd-1||contentEnd-4>contentStart&&"whitespace"===events[contentEnd-2][1].type)&&(contentEnd-=contentStart+1===contentEnd?2:4),contentEnd>contentStart&&(content={type:"atxHeadingText",start:events[contentStart][1].start,end:events[contentEnd][1].end},text={type:"chunkText",start:events[contentStart][1].start,end:events[contentEnd][1].end,contentType:"text"},splice(events,contentStart,contentEnd-contentStart+1,[["enter",content,context],["enter",text,context],["exit",text,context],["exit",content,context]])),events}},htmlBlockNames=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],htmlRawNames=["pre","script","style","textarea"],htmlFlow={name:"htmlFlow",tokenize:function(effects,ok,nok){const self=this;let kind,startTag,buffer,index,marker;return function(code){return effects.enter("htmlFlow"),effects.enter("htmlFlowData"),effects.consume(code),open};function open(code){return 33===code?(effects.consume(code),declarationStart):47===code?(effects.consume(code),tagCloseStart):63===code?(effects.consume(code),kind=3,self.interrupt?ok:continuationDeclarationInside):asciiAlpha(code)?(effects.consume(code),buffer=String.fromCharCode(code),startTag=!0,tagName):nok(code)}function declarationStart(code){return 45===code?(effects.consume(code),kind=2,commentOpenInside):91===code?(effects.consume(code),kind=5,buffer="CDATA[",index=0,cdataOpenInside):asciiAlpha(code)?(effects.consume(code),kind=4,self.interrupt?ok:continuationDeclarationInside):nok(code)}function commentOpenInside(code){return 45===code?(effects.consume(code),self.interrupt?ok:continuationDeclarationInside):nok(code)}function cdataOpenInside(code){return code===buffer.charCodeAt(index++)?(effects.consume(code),index===buffer.length?self.interrupt?ok:continuation:cdataOpenInside):nok(code)}function tagCloseStart(code){return asciiAlpha(code)?(effects.consume(code),buffer=String.fromCharCode(code),tagName):nok(code)}function tagName(code){return null===code||47===code||62===code||markdownLineEndingOrSpace(code)?47!==code&&startTag&&htmlRawNames.includes(buffer.toLowerCase())?(kind=1,self.interrupt?ok(code):continuation(code)):htmlBlockNames.includes(buffer.toLowerCase())?(kind=6,47===code?(effects.consume(code),basicSelfClosing):self.interrupt?ok(code):continuation(code)):(kind=7,self.interrupt&&!self.parser.lazy[self.now().line]?nok(code):startTag?completeAttributeNameBefore(code):completeClosingTagAfter(code)):45===code||asciiAlphanumeric(code)?(effects.consume(code),buffer+=String.fromCharCode(code),tagName):nok(code)}function basicSelfClosing(code){return 62===code?(effects.consume(code),self.interrupt?ok:continuation):nok(code)}function completeClosingTagAfter(code){return markdownSpace(code)?(effects.consume(code),completeClosingTagAfter):completeEnd(code)}function completeAttributeNameBefore(code){return 47===code?(effects.consume(code),completeEnd):58===code||95===code||asciiAlpha(code)?(effects.consume(code),completeAttributeName):markdownSpace(code)?(effects.consume(code),completeAttributeNameBefore):completeEnd(code)}function completeAttributeName(code){return 45===code||46===code||58===code||95===code||asciiAlphanumeric(code)?(effects.consume(code),completeAttributeName):completeAttributeNameAfter(code)}function completeAttributeNameAfter(code){return 61===code?(effects.consume(code),completeAttributeValueBefore):markdownSpace(code)?(effects.consume(code),completeAttributeNameAfter):completeAttributeNameBefore(code)}function completeAttributeValueBefore(code){return null===code||60===code||61===code||62===code||96===code?nok(code):34===code||39===code?(effects.consume(code),marker=code,completeAttributeValueQuoted):markdownSpace(code)?(effects.consume(code),completeAttributeValueBefore):(marker=null,completeAttributeValueUnquoted(code))}function completeAttributeValueQuoted(code){return null===code||markdownLineEnding(code)?nok(code):code===marker?(effects.consume(code),completeAttributeValueQuotedAfter):(effects.consume(code),completeAttributeValueQuoted)}function completeAttributeValueUnquoted(code){return null===code||34===code||39===code||60===code||61===code||62===code||96===code||markdownLineEndingOrSpace(code)?completeAttributeNameAfter(code):(effects.consume(code),completeAttributeValueUnquoted)}function completeAttributeValueQuotedAfter(code){return 47===code||62===code||markdownSpace(code)?completeAttributeNameBefore(code):nok(code)}function completeEnd(code){return 62===code?(effects.consume(code),completeAfter):nok(code)}function completeAfter(code){return markdownSpace(code)?(effects.consume(code),completeAfter):null===code||markdownLineEnding(code)?continuation(code):nok(code)}function continuation(code){return 45===code&&2===kind?(effects.consume(code),continuationCommentInside):60===code&&1===kind?(effects.consume(code),continuationRawTagOpen):62===code&&4===kind?(effects.consume(code),continuationClose):63===code&&3===kind?(effects.consume(code),continuationDeclarationInside):93===code&&5===kind?(effects.consume(code),continuationCharacterDataInside):!markdownLineEnding(code)||6!==kind&&7!==kind?null===code||markdownLineEnding(code)?continuationAtLineEnding(code):(effects.consume(code),continuation):effects.check(nextBlankConstruct,continuationClose,continuationAtLineEnding)(code)}function continuationAtLineEnding(code){return effects.exit("htmlFlowData"),htmlContinueStart(code)}function htmlContinueStart(code){return null===code?done(code):markdownLineEnding(code)?effects.attempt({tokenize:htmlLineEnd,partial:!0},htmlContinueStart,done)(code):(effects.enter("htmlFlowData"),continuation(code))}function htmlLineEnd(effects,ok,nok){return function(code){return effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),lineStart};function lineStart(code){return self.parser.lazy[self.now().line]?nok(code):ok(code)}}function continuationCommentInside(code){return 45===code?(effects.consume(code),continuationDeclarationInside):continuation(code)}function continuationRawTagOpen(code){return 47===code?(effects.consume(code),buffer="",continuationRawEndTag):continuation(code)}function continuationRawEndTag(code){return 62===code&&htmlRawNames.includes(buffer.toLowerCase())?(effects.consume(code),continuationClose):asciiAlpha(code)&&buffer.length<8?(effects.consume(code),buffer+=String.fromCharCode(code),continuationRawEndTag):continuation(code)}function continuationCharacterDataInside(code){return 93===code?(effects.consume(code),continuationDeclarationInside):continuation(code)}function continuationDeclarationInside(code){return 62===code?(effects.consume(code),continuationClose):continuation(code)}function continuationClose(code){return null===code||markdownLineEnding(code)?(effects.exit("htmlFlowData"),done(code)):(effects.consume(code),continuationClose)}function done(code){return effects.exit("htmlFlow"),ok(code)}},resolveTo:function(events){let index=events.length;for(;index--&&("enter"!==events[index][0]||"htmlFlow"!==events[index][1].type););return index>1&&"linePrefix"===events[index-2][1].type&&(events[index][1].start=events[index-2][1].start,events[index+1][1].start=events[index-2][1].start,events.splice(index-2,2)),events},concrete:!0},nextBlankConstruct={tokenize:function(effects,ok,nok){return function(code){return effects.exit("htmlFlowData"),effects.enter("lineEndingBlank"),effects.consume(code),effects.exit("lineEndingBlank"),effects.attempt(blankLine,ok,nok)}},partial:!0},htmlText={name:"htmlText",tokenize:function(effects,ok,nok){const self=this;let marker,buffer,index,returnState;return function(code){return effects.enter("htmlText"),effects.enter("htmlTextData"),effects.consume(code),open};function open(code){return 33===code?(effects.consume(code),declarationOpen):47===code?(effects.consume(code),tagCloseStart):63===code?(effects.consume(code),instruction):asciiAlpha(code)?(effects.consume(code),tagOpen):nok(code)}function declarationOpen(code){return 45===code?(effects.consume(code),commentOpen):91===code?(effects.consume(code),buffer="CDATA[",index=0,cdataOpen):asciiAlpha(code)?(effects.consume(code),declaration):nok(code)}function commentOpen(code){return 45===code?(effects.consume(code),commentStart):nok(code)}function commentStart(code){return null===code||62===code?nok(code):45===code?(effects.consume(code),commentStartDash):comment(code)}function commentStartDash(code){return null===code||62===code?nok(code):comment(code)}function comment(code){return null===code?nok(code):45===code?(effects.consume(code),commentClose):markdownLineEnding(code)?(returnState=comment,atLineEnding(code)):(effects.consume(code),comment)}function commentClose(code){return 45===code?(effects.consume(code),end):comment(code)}function cdataOpen(code){return code===buffer.charCodeAt(index++)?(effects.consume(code),index===buffer.length?cdata:cdataOpen):nok(code)}function cdata(code){return null===code?nok(code):93===code?(effects.consume(code),cdataClose):markdownLineEnding(code)?(returnState=cdata,atLineEnding(code)):(effects.consume(code),cdata)}function cdataClose(code){return 93===code?(effects.consume(code),cdataEnd):cdata(code)}function cdataEnd(code){return 62===code?end(code):93===code?(effects.consume(code),cdataEnd):cdata(code)}function declaration(code){return null===code||62===code?end(code):markdownLineEnding(code)?(returnState=declaration,atLineEnding(code)):(effects.consume(code),declaration)}function instruction(code){return null===code?nok(code):63===code?(effects.consume(code),instructionClose):markdownLineEnding(code)?(returnState=instruction,atLineEnding(code)):(effects.consume(code),instruction)}function instructionClose(code){return 62===code?end(code):instruction(code)}function tagCloseStart(code){return asciiAlpha(code)?(effects.consume(code),tagClose):nok(code)}function tagClose(code){return 45===code||asciiAlphanumeric(code)?(effects.consume(code),tagClose):tagCloseBetween(code)}function tagCloseBetween(code){return markdownLineEnding(code)?(returnState=tagCloseBetween,atLineEnding(code)):markdownSpace(code)?(effects.consume(code),tagCloseBetween):end(code)}function tagOpen(code){return 45===code||asciiAlphanumeric(code)?(effects.consume(code),tagOpen):47===code||62===code||markdownLineEndingOrSpace(code)?tagOpenBetween(code):nok(code)}function tagOpenBetween(code){return 47===code?(effects.consume(code),end):58===code||95===code||asciiAlpha(code)?(effects.consume(code),tagOpenAttributeName):markdownLineEnding(code)?(returnState=tagOpenBetween,atLineEnding(code)):markdownSpace(code)?(effects.consume(code),tagOpenBetween):end(code)}function tagOpenAttributeName(code){return 45===code||46===code||58===code||95===code||asciiAlphanumeric(code)?(effects.consume(code),tagOpenAttributeName):tagOpenAttributeNameAfter(code)}function tagOpenAttributeNameAfter(code){return 61===code?(effects.consume(code),tagOpenAttributeValueBefore):markdownLineEnding(code)?(returnState=tagOpenAttributeNameAfter,atLineEnding(code)):markdownSpace(code)?(effects.consume(code),tagOpenAttributeNameAfter):tagOpenBetween(code)}function tagOpenAttributeValueBefore(code){return null===code||60===code||61===code||62===code||96===code?nok(code):34===code||39===code?(effects.consume(code),marker=code,tagOpenAttributeValueQuoted):markdownLineEnding(code)?(returnState=tagOpenAttributeValueBefore,atLineEnding(code)):markdownSpace(code)?(effects.consume(code),tagOpenAttributeValueBefore):(effects.consume(code),marker=void 0,tagOpenAttributeValueUnquoted)}function tagOpenAttributeValueQuoted(code){return code===marker?(effects.consume(code),tagOpenAttributeValueQuotedAfter):null===code?nok(code):markdownLineEnding(code)?(returnState=tagOpenAttributeValueQuoted,atLineEnding(code)):(effects.consume(code),tagOpenAttributeValueQuoted)}function tagOpenAttributeValueQuotedAfter(code){return 62===code||47===code||markdownLineEndingOrSpace(code)?tagOpenBetween(code):nok(code)}function tagOpenAttributeValueUnquoted(code){return null===code||34===code||39===code||60===code||61===code||96===code?nok(code):62===code||markdownLineEndingOrSpace(code)?tagOpenBetween(code):(effects.consume(code),tagOpenAttributeValueUnquoted)}function atLineEnding(code){return effects.exit("htmlTextData"),effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),factorySpace(effects,afterPrefix,"linePrefix",self.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function afterPrefix(code){return effects.enter("htmlTextData"),returnState(code)}function end(code){return 62===code?(effects.consume(code),effects.exit("htmlTextData"),effects.exit("htmlText"),ok):nok(code)}}},labelEnd={name:"labelEnd",tokenize:function(effects,ok,nok){const self=this;let labelStart,defined,index=self.events.length;for(;index--;)if(("labelImage"===self.events[index][1].type||"labelLink"===self.events[index][1].type)&&!self.events[index][1]._balanced){labelStart=self.events[index][1];break}return function(code){return labelStart?labelStart._inactive?balanced(code):(defined=self.parser.defined.includes(normalizeIdentifier(self.sliceSerialize({start:labelStart.end,end:self.now()}))),effects.enter("labelEnd"),effects.enter("labelMarker"),effects.consume(code),effects.exit("labelMarker"),effects.exit("labelEnd"),afterLabelEnd):nok(code)};function afterLabelEnd(code){return 40===code?effects.attempt(resourceConstruct,ok,defined?ok:balanced)(code):91===code?effects.attempt(fullReferenceConstruct,ok,defined?effects.attempt(collapsedReferenceConstruct,ok,balanced):balanced)(code):defined?ok(code):balanced(code)}function balanced(code){return labelStart._balanced=!0,nok(code)}},resolveTo:function(events,context){let token,open,close,media,index=events.length,offset=0;for(;index--;)if(token=events[index][1],open){if("link"===token.type||"labelLink"===token.type&&token._inactive)break;"enter"===events[index][0]&&"labelLink"===token.type&&(token._inactive=!0)}else if(close){if("enter"===events[index][0]&&("labelImage"===token.type||"labelLink"===token.type)&&!token._balanced&&(open=index,"labelLink"!==token.type)){offset=2;break}}else"labelEnd"===token.type&&(close=index);const group={type:"labelLink"===events[open][1].type?"link":"image",start:Object.assign({},events[open][1].start),end:Object.assign({},events[events.length-1][1].end)},label={type:"label",start:Object.assign({},events[open][1].start),end:Object.assign({},events[close][1].end)},text={type:"labelText",start:Object.assign({},events[open+offset+2][1].end),end:Object.assign({},events[close-2][1].start)};return media=[["enter",group,context],["enter",label,context]],media=push(media,events.slice(open+1,open+offset+3)),media=push(media,[["enter",text,context]]),media=push(media,resolveAll(context.parser.constructs.insideSpan.null,events.slice(open+offset+4,close-3),context)),media=push(media,[["exit",text,context],events[close-2],events[close-1],["exit",label,context]]),media=push(media,events.slice(close+1)),media=push(media,[["exit",group,context]]),splice(events,open,events.length,media),events},resolveAll:function(events){let token,index=-1;for(;++index<events.length;)token=events[index][1],"labelImage"!==token.type&&"labelLink"!==token.type&&"labelEnd"!==token.type||(events.splice(index+1,"labelImage"===token.type?4:2),token.type="data",index++);return events}},resourceConstruct={tokenize:function(effects,ok,nok){return function(code){return effects.enter("resource"),effects.enter("resourceMarker"),effects.consume(code),effects.exit("resourceMarker"),factoryWhitespace(effects,open)};function open(code){return 41===code?end(code):factoryDestination(effects,destinationAfter,nok,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(code)}function destinationAfter(code){return markdownLineEndingOrSpace(code)?factoryWhitespace(effects,between)(code):end(code)}function between(code){return 34===code||39===code||40===code?factoryTitle(effects,factoryWhitespace(effects,end),nok,"resourceTitle","resourceTitleMarker","resourceTitleString")(code):end(code)}function end(code){return 41===code?(effects.enter("resourceMarker"),effects.consume(code),effects.exit("resourceMarker"),effects.exit("resource"),ok):nok(code)}}},fullReferenceConstruct={tokenize:function(effects,ok,nok){const self=this;return function(code){return factoryLabel.call(self,effects,afterLabel,nok,"reference","referenceMarker","referenceString")(code)};function afterLabel(code){return self.parser.defined.includes(normalizeIdentifier(self.sliceSerialize(self.events[self.events.length-1][1]).slice(1,-1)))?ok(code):nok(code)}}},collapsedReferenceConstruct={tokenize:function(effects,ok,nok){return function(code){return effects.enter("reference"),effects.enter("referenceMarker"),effects.consume(code),effects.exit("referenceMarker"),open};function open(code){return 93===code?(effects.enter("referenceMarker"),effects.consume(code),effects.exit("referenceMarker"),effects.exit("reference"),ok):nok(code)}}},labelStartImage={name:"labelStartImage",tokenize:function(effects,ok,nok){const self=this;return function(code){return effects.enter("labelImage"),effects.enter("labelImageMarker"),effects.consume(code),effects.exit("labelImageMarker"),open};function open(code){return 91===code?(effects.enter("labelMarker"),effects.consume(code),effects.exit("labelMarker"),effects.exit("labelImage"),after):nok(code)}function after(code){return 94===code&&"_hiddenFootnoteSupport"in self.parser.constructs?nok(code):ok(code)}},resolveAll:labelEnd.resolveAll},labelStartLink={name:"labelStartLink",tokenize:function(effects,ok,nok){const self=this;return function(code){return effects.enter("labelLink"),effects.enter("labelMarker"),effects.consume(code),effects.exit("labelMarker"),effects.exit("labelLink"),after};function after(code){return 94===code&&"_hiddenFootnoteSupport"in self.parser.constructs?nok(code):ok(code)}},resolveAll:labelEnd.resolveAll},lineEnding={name:"lineEnding",tokenize:function(effects,ok){return function(code){return effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),factorySpace(effects,ok,"linePrefix")}}},thematicBreak$1={name:"thematicBreak",tokenize:function(effects,ok,nok){let marker,size=0;return function(code){return effects.enter("thematicBreak"),marker=code,atBreak(code)};function atBreak(code){return code===marker?(effects.enter("thematicBreakSequence"),sequence(code)):markdownSpace(code)?factorySpace(effects,atBreak,"whitespace")(code):size<3||null!==code&&!markdownLineEnding(code)?nok(code):(effects.exit("thematicBreak"),ok(code))}function sequence(code){return code===marker?(effects.consume(code),size++,sequence):(effects.exit("thematicBreakSequence"),atBreak(code))}}},list$1={name:"list",tokenize:function(effects,ok,nok){const self=this,tail=self.events[self.events.length-1];let initialSize=tail&&"linePrefix"===tail[1].type?tail[2].sliceSerialize(tail[1],!0).length:0,size=0;return function(code){const kind=self.containerState.type||(42===code||43===code||45===code?"listUnordered":"listOrdered");if("listUnordered"===kind?!self.containerState.marker||code===self.containerState.marker:asciiDigit(code)){if(self.containerState.type||(self.containerState.type=kind,effects.enter(kind,{_container:!0})),"listUnordered"===kind)return effects.enter("listItemPrefix"),42===code||45===code?effects.check(thematicBreak$1,nok,atMarker)(code):atMarker(code);if(!self.interrupt||49===code)return effects.enter("listItemPrefix"),effects.enter("listItemValue"),inside(code)}return nok(code)};function inside(code){return asciiDigit(code)&&++size<10?(effects.consume(code),inside):(!self.interrupt||size<2)&&(self.containerState.marker?code===self.containerState.marker:41===code||46===code)?(effects.exit("listItemValue"),atMarker(code)):nok(code)}function atMarker(code){return effects.enter("listItemMarker"),effects.consume(code),effects.exit("listItemMarker"),self.containerState.marker=self.containerState.marker||code,effects.check(blankLine,self.interrupt?nok:onBlank,effects.attempt(listItemPrefixWhitespaceConstruct,endOfPrefix,otherPrefix))}function onBlank(code){return self.containerState.initialBlankLine=!0,initialSize++,endOfPrefix(code)}function otherPrefix(code){return markdownSpace(code)?(effects.enter("listItemPrefixWhitespace"),effects.consume(code),effects.exit("listItemPrefixWhitespace"),endOfPrefix):nok(code)}function endOfPrefix(code){return self.containerState.size=initialSize+self.sliceSerialize(effects.exit("listItemPrefix"),!0).length,ok(code)}},continuation:{tokenize:function(effects,ok,nok){const self=this;return self.containerState._closeFlow=void 0,effects.check(blankLine,(function(code){return self.containerState.furtherBlankLines=self.containerState.furtherBlankLines||self.containerState.initialBlankLine,factorySpace(effects,ok,"listItemIndent",self.containerState.size+1)(code)}),(function(code){return self.containerState.furtherBlankLines||!markdownSpace(code)?(self.containerState.furtherBlankLines=void 0,self.containerState.initialBlankLine=void 0,notInCurrentItem(code)):(self.containerState.furtherBlankLines=void 0,self.containerState.initialBlankLine=void 0,effects.attempt(indentConstruct,ok,notInCurrentItem)(code))}));function notInCurrentItem(code){return self.containerState._closeFlow=!0,self.interrupt=void 0,factorySpace(effects,effects.attempt(list$1,ok,nok),"linePrefix",self.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(code)}}},exit:function(effects){effects.exit(this.containerState.type)}},listItemPrefixWhitespaceConstruct={tokenize:function(effects,ok,nok){const self=this;return factorySpace(effects,(function(code){const tail=self.events[self.events.length-1];return!markdownSpace(code)&&tail&&"listItemPrefixWhitespace"===tail[1].type?ok(code):nok(code)}),"listItemPrefixWhitespace",self.parser.constructs.disable.null.includes("codeIndented")?void 0:5)},partial:!0},indentConstruct={tokenize:function(effects,ok,nok){const self=this;return factorySpace(effects,(function(code){const tail=self.events[self.events.length-1];return tail&&"listItemIndent"===tail[1].type&&tail[2].sliceSerialize(tail[1],!0).length===self.containerState.size?ok(code):nok(code)}),"listItemIndent",self.containerState.size+1)},partial:!0},setextUnderline={name:"setextUnderline",tokenize:function(effects,ok,nok){const self=this;let marker,paragraph,index=self.events.length;for(;index--;)if("lineEnding"!==self.events[index][1].type&&"linePrefix"!==self.events[index][1].type&&"content"!==self.events[index][1].type){paragraph="paragraph"===self.events[index][1].type;break}return function(code){return self.parser.lazy[self.now().line]||!self.interrupt&&!paragraph?nok(code):(effects.enter("setextHeadingLine"),effects.enter("setextHeadingLineSequence"),marker=code,closingSequence(code))};function closingSequence(code){return code===marker?(effects.consume(code),closingSequence):(effects.exit("setextHeadingLineSequence"),factorySpace(effects,closingSequenceEnd,"lineSuffix")(code))}function closingSequenceEnd(code){return null===code||markdownLineEnding(code)?(effects.exit("setextHeadingLine"),ok(code)):nok(code)}},resolveTo:function(events,context){let content,text,definition,index=events.length;for(;index--;)if("enter"===events[index][0]){if("content"===events[index][1].type){content=index;break}"paragraph"===events[index][1].type&&(text=index)}else"content"===events[index][1].type&&events.splice(index,1),definition||"definition"!==events[index][1].type||(definition=index);const heading={type:"setextHeading",start:Object.assign({},events[text][1].start),end:Object.assign({},events[events.length-1][1].end)};return events[text][1].type="setextHeadingText",definition?(events.splice(text,0,["enter",heading,context]),events.splice(definition+1,0,["exit",events[content][1],context]),events[content][1].end=Object.assign({},events[definition][1].end)):events[content][1]=heading,events.push(["exit",heading,context]),events}},flow$1={tokenize:function(effects){const self=this,initial=effects.attempt(blankLine,(function(code){if(null!==code)return effects.enter("lineEndingBlank"),effects.consume(code),effects.exit("lineEndingBlank"),self.currentConstruct=void 0,initial;effects.consume(code)}),effects.attempt(this.parser.constructs.flowInitial,afterConstruct,factorySpace(effects,effects.attempt(this.parser.constructs.flow,afterConstruct,effects.attempt(content,afterConstruct)),"linePrefix")));return initial;function afterConstruct(code){if(null!==code)return effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),self.currentConstruct=void 0,initial;effects.consume(code)}}},resolver={resolveAll:createResolver()},string$1=initializeFactory("string"),text$3=initializeFactory("text");function initializeFactory(field){return{tokenize:function(effects){const self=this,constructs=this.parser.constructs[field],text=effects.attempt(constructs,start,notText);return start;function start(code){return atBreak(code)?text(code):notText(code)}function notText(code){if(null!==code)return effects.enter("data"),effects.consume(code),data;effects.consume(code)}function data(code){return atBreak(code)?(effects.exit("data"),text(code)):(effects.consume(code),data)}function atBreak(code){if(null===code)return!0;const list=constructs[code];let index=-1;if(list)for(;++index<list.length;){const item=list[index];if(!item.previous||item.previous.call(self,self.previous))return!0}return!1}},resolveAll:createResolver("text"===field?resolveAllLineSuffixes:void 0)}}function createResolver(extraResolver){return function(events,context){let enter,index=-1;for(;++index<=events.length;)void 0===enter?events[index]&&"data"===events[index][1].type&&(enter=index,index++):events[index]&&"data"===events[index][1].type||(index!==enter+2&&(events[enter][1].end=events[index-1][1].end,events.splice(enter+2,index-enter-2),index=enter+2),enter=void 0);return extraResolver?extraResolver(events,context):events}}function resolveAllLineSuffixes(events,context){let eventIndex=-1;for(;++eventIndex<=events.length;)if((eventIndex===events.length||"lineEnding"===events[eventIndex][1].type)&&"data"===events[eventIndex-1][1].type){const data=events[eventIndex-1][1],chunks=context.sliceStream(data);let tabs,index=chunks.length,bufferIndex=-1,size=0;for(;index--;){const chunk=chunks[index];if("string"==typeof chunk){for(bufferIndex=chunk.length;32===chunk.charCodeAt(bufferIndex-1);)size++,bufferIndex--;if(bufferIndex)break;bufferIndex=-1}else if(-2===chunk)tabs=!0,size++;else if(-1!==chunk){index++;break}}if(size){const token={type:eventIndex===events.length||tabs||size<2?"lineSuffix":"hardBreakTrailing",start:{line:data.end.line,column:data.end.column-size,offset:data.end.offset-size,_index:data.start._index+index,_bufferIndex:index?bufferIndex:data.start._bufferIndex+bufferIndex},end:Object.assign({},data.end)};data.end=Object.assign({},token.start),data.start.offset===data.end.offset?Object.assign(data,token):(events.splice(eventIndex,0,["enter",token,context],["exit",token,context]),eventIndex+=2)}eventIndex++}return events}function createTokenizer(parser,initialize,from){let point=Object.assign(from?Object.assign({},from):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const columnStart={},resolveAllConstructs=[];let chunks=[],stack=[];const effects={consume:function(code){markdownLineEnding(code)?(point.line++,point.column=1,point.offset+=-3===code?2:1,accountForPotentialSkip()):-1!==code&&(point.column++,point.offset++),point._bufferIndex<0?point._index++:(point._bufferIndex++,point._bufferIndex===chunks[point._index].length&&(point._bufferIndex=-1,point._index++)),context.previous=code},enter:function(type,fields){const token=fields||{};return token.type=type,token.start=now(),context.events.push(["enter",token,context]),stack.push(token),token},exit:function(type){const token=stack.pop();return token.end=now(),context.events.push(["exit",token,context]),token},attempt:constructFactory((function(construct,info){addResult(construct,info.from)})),check:constructFactory(onsuccessfulcheck),interrupt:constructFactory(onsuccessfulcheck,{interrupt:!0})},context={previous:null,code:null,containerState:{},events:[],parser,sliceStream,sliceSerialize:function(token,expandTabs){return function(chunks,expandTabs){let index=-1;const result=[];let atTab;for(;++index<chunks.length;){const chunk=chunks[index];let value;if("string"==typeof chunk)value=chunk;else switch(chunk){case-5:value="\r";break;case-4:value="\n";break;case-3:value="\r\n";break;case-2:value=expandTabs?" ":"\t";break;case-1:if(!expandTabs&&atTab)continue;value=" ";break;default:value=String.fromCharCode(chunk)}atTab=-2===chunk,result.push(value)}return result.join("")}(sliceStream(token),expandTabs)},now,defineSkip:function(value){columnStart[value.line]=value.column,accountForPotentialSkip()},write:function(slice){return chunks=push(chunks,slice),function(){let chunkIndex;for(;point._index<chunks.length;){const chunk=chunks[point._index];if("string"==typeof chunk)for(chunkIndex=point._index,point._bufferIndex<0&&(point._bufferIndex=0);point._index===chunkIndex&&point._bufferIndex<chunk.length;)go(chunk.charCodeAt(point._bufferIndex));else go(chunk)}}(),null!==chunks[chunks.length-1]?[]:(addResult(initialize,0),context.events=resolveAll(resolveAllConstructs,context.events,context),context.events)}};let state=initialize.tokenize.call(context,effects);return initialize.resolveAll&&resolveAllConstructs.push(initialize),context;function sliceStream(token){return function(chunks,token){const startIndex=token.start._index,startBufferIndex=token.start._bufferIndex,endIndex=token.end._index,endBufferIndex=token.end._bufferIndex;let view;return startIndex===endIndex?view=[chunks[startIndex].slice(startBufferIndex,endBufferIndex)]:(view=chunks.slice(startIndex,endIndex),startBufferIndex>-1&&(view[0]=view[0].slice(startBufferIndex)),endBufferIndex>0&&view.push(chunks[endIndex].slice(0,endBufferIndex))),view}(chunks,token)}function now(){return Object.assign({},point)}function go(code){state=state(code)}function onsuccessfulcheck(_,info){info.restore()}function constructFactory(onreturn,fields){return function(constructs,returnState,bogusState){let listOfConstructs,constructIndex,currentConstruct,info;return Array.isArray(constructs)?handleListOfConstructs(constructs):"tokenize"in constructs?handleListOfConstructs([constructs]):function(map){return function(code){const def=null!==code&&map[code],all=null!==code&&map.null;return handleListOfConstructs([...Array.isArray(def)?def:def?[def]:[],...Array.isArray(all)?all:all?[all]:[]])(code)}}(constructs);function handleListOfConstructs(list){return listOfConstructs=list,constructIndex=0,0===list.length?bogusState:handleConstruct(list[constructIndex])}function handleConstruct(construct){return function(code){return info=function(){const startPoint=now(),startPrevious=context.previous,startCurrentConstruct=context.currentConstruct,startEventsIndex=context.events.length,startStack=Array.from(stack);return{restore:function(){point=startPoint,context.previous=startPrevious,context.currentConstruct=startCurrentConstruct,context.events.length=startEventsIndex,stack=startStack,accountForPotentialSkip()},from:startEventsIndex}}(),currentConstruct=construct,construct.partial||(context.currentConstruct=construct),construct.name&&context.parser.constructs.disable.null.includes(construct.name)?nok():construct.tokenize.call(fields?Object.assign(Object.create(context),fields):context,effects,ok,nok)(code)}}function ok(code){return onreturn(currentConstruct,info),returnState}function nok(code){return info.restore(),++constructIndex<listOfConstructs.length?handleConstruct(listOfConstructs[constructIndex]):bogusState}}}function addResult(construct,from){construct.resolveAll&&!resolveAllConstructs.includes(construct)&&resolveAllConstructs.push(construct),construct.resolve&&splice(context.events,from,context.events.length-from,construct.resolve(context.events.slice(from),context)),construct.resolveTo&&(context.events=construct.resolveTo(context.events,context))}function accountForPotentialSkip(){point.line in columnStart&&point.column<2&&(point.column=columnStart[point.line],point.offset+=columnStart[point.line]-1)}}const document$1={42:list$1,43:list$1,45:list$1,48:list$1,49:list$1,50:list$1,51:list$1,52:list$1,53:list$1,54:list$1,55:list$1,56:list$1,57:list$1,62:blockQuote},contentInitial={91:definition$1},flowInitial={[-2]:codeIndented,[-1]:codeIndented,32:codeIndented},flow={35:headingAtx,42:thematicBreak$1,45:[setextUnderline,thematicBreak$1],60:htmlFlow,61:setextUnderline,95:thematicBreak$1,96:codeFenced,126:codeFenced},string={38:characterReference,92:characterEscape},text$2={[-5]:lineEnding,[-4]:lineEnding,[-3]:lineEnding,33:labelStartImage,38:characterReference,42:attention,60:[autolink,htmlText],91:labelStartLink,92:[hardBreakEscape,characterEscape],93:labelEnd,95:attention,96:codeText},insideSpan={null:[attention,resolver]};var defaultConstructs=Object.freeze({__proto__:null,document:document$1,contentInitial,flowInitial,flow,string,text:text$2,insideSpan,attentionMarkers:{null:[42,95]},disable:{null:[]}});const search=/[\0\t\n\r]/g;function decodeNumericCharacterReference(value,base){const code=Number.parseInt(value,base);return code<9||11===code||code>13&&code<32||code>126&&code<160||code>55295&&code<57344||code>64975&&code<65008||65535==(65535&code)||65534==(65535&code)||code>1114111?"ï¿½":String.fromCharCode(code)}const characterEscapeOrReference=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decodeString(value){return value.replace(characterEscapeOrReference,decode)}function decode($0,$1,$2){if($1)return $1;if(35===$2.charCodeAt(0)){const head=$2.charCodeAt(1),hex=120===head||88===head;return decodeNumericCharacterReference($2.slice(hex?2:1),hex?16:10)}return decodeEntity($2)||$0}const own$2={}.hasOwnProperty,fromMarkdown=function(value,encoding,options){return"string"!=typeof encoding&&(options=encoding,encoding=void 0),function(options={}){const config=configure$1({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:opener(link),autolinkProtocol:onenterdata,autolinkEmail:onenterdata,atxHeading:opener(heading),blockQuote:opener((function(){return{type:"blockquote",children:[]}})),characterEscape:onenterdata,characterReference:onenterdata,codeFenced:opener(codeFlow),codeFencedFenceInfo:buffer,codeFencedFenceMeta:buffer,codeIndented:opener(codeFlow,buffer),codeText:opener((function(){return{type:"inlineCode",value:""}}),buffer),codeTextData:onenterdata,data:onenterdata,codeFlowValue:onenterdata,definition:opener((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:buffer,definitionLabelString:buffer,definitionTitleString:buffer,emphasis:opener((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:opener(hardBreak),hardBreakTrailing:opener(hardBreak),htmlFlow:opener(html,buffer),htmlFlowData:onenterdata,htmlText:opener(html,buffer),htmlTextData:onenterdata,image:opener((function(){return{type:"image",title:null,url:"",alt:null}})),label:buffer,link:opener(link),listItem:opener((function(token){return{type:"listItem",spread:token._spread,checked:null,children:[]}})),listItemValue:function(token){getData("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(token),10),setData("expectingFirstListItemValue"))},listOrdered:opener(list,(function(){setData("expectingFirstListItemValue",!0)})),listUnordered:opener(list),paragraph:opener((function(){return{type:"paragraph",children:[]}})),reference:function(){setData("referenceType","collapsed")},referenceString:buffer,resourceDestinationString:buffer,resourceTitleString:buffer,setextHeading:opener(heading),strong:opener((function(){return{type:"strong",children:[]}})),thematicBreak:opener((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:closer(),atxHeadingSequence:function(token){const node=this.stack[this.stack.length-1];if(!node.depth){const depth=this.sliceSerialize(token).length;node.depth=depth}},autolink:closer(),autolinkEmail:function(token){onexitdata.call(this,token),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(token)},autolinkProtocol:function(token){onexitdata.call(this,token),this.stack[this.stack.length-1].url=this.sliceSerialize(token)},blockQuote:closer(),characterEscapeValue:onexitdata,characterReferenceMarkerHexadecimal:onexitcharacterreferencemarker,characterReferenceMarkerNumeric:onexitcharacterreferencemarker,characterReferenceValue:function(token){const data=this.sliceSerialize(token),type=getData("characterReferenceType");let value;type?(value=decodeNumericCharacterReference(data,"characterReferenceMarkerNumeric"===type?10:16),setData("characterReferenceType")):value=decodeEntity(data);const tail=this.stack.pop();tail.value+=value,tail.position.end=point(token.end)},codeFenced:closer((function(){const data=this.resume();this.stack[this.stack.length-1].value=data.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),setData("flowCodeInside")})),codeFencedFence:function(){getData("flowCodeInside")||(this.buffer(),setData("flowCodeInside",!0))},codeFencedFenceInfo:function(){const data=this.resume();this.stack[this.stack.length-1].lang=data},codeFencedFenceMeta:function(){const data=this.resume();this.stack[this.stack.length-1].meta=data},codeFlowValue:onexitdata,codeIndented:closer((function(){const data=this.resume();this.stack[this.stack.length-1].value=data.replace(/(\r?\n|\r)$/g,"")})),codeText:closer((function(){const data=this.resume();this.stack[this.stack.length-1].value=data})),codeTextData:onexitdata,data:onexitdata,definition:closer(),definitionDestinationString:function(){const data=this.resume();this.stack[this.stack.length-1].url=data},definitionLabelString:function(token){const label=this.resume(),node=this.stack[this.stack.length-1];node.label=label,node.identifier=normalizeIdentifier(this.sliceSerialize(token)).toLowerCase()},definitionTitleString:function(){const data=this.resume();this.stack[this.stack.length-1].title=data},emphasis:closer(),hardBreakEscape:closer(onexithardbreak),hardBreakTrailing:closer(onexithardbreak),htmlFlow:closer((function(){const data=this.resume();this.stack[this.stack.length-1].value=data})),htmlFlowData:onexitdata,htmlText:closer((function(){const data=this.resume();this.stack[this.stack.length-1].value=data})),htmlTextData:onexitdata,image:closer((function(){const context=this.stack[this.stack.length-1];getData("inReference")?(context.type+="Reference",context.referenceType=getData("referenceType")||"shortcut",delete context.url,delete context.title):(delete context.identifier,delete context.label),setData("referenceType")})),label:function(){const fragment=this.stack[this.stack.length-1],value=this.resume(),node=this.stack[this.stack.length-1];setData("inReference",!0),"link"===node.type?node.children=fragment.children:node.alt=value},labelText:function(token){const ancestor=this.stack[this.stack.length-2],string=this.sliceSerialize(token);ancestor.label=decodeString(string),ancestor.identifier=normalizeIdentifier(string).toLowerCase()},lineEnding:function(token){const context=this.stack[this.stack.length-1];if(getData("atHardBreak"))return context.children[context.children.length-1].position.end=point(token.end),void setData("atHardBreak");!getData("setextHeadingSlurpLineEnding")&&config.canContainEols.includes(context.type)&&(onenterdata.call(this,token),onexitdata.call(this,token))},link:closer((function(){const context=this.stack[this.stack.length-1];getData("inReference")?(context.type+="Reference",context.referenceType=getData("referenceType")||"shortcut",delete context.url,delete context.title):(delete context.identifier,delete context.label),setData("referenceType")})),listItem:closer(),listOrdered:closer(),listUnordered:closer(),paragraph:closer(),referenceString:function(token){const label=this.resume(),node=this.stack[this.stack.length-1];node.label=label,node.identifier=normalizeIdentifier(this.sliceSerialize(token)).toLowerCase(),setData("referenceType","full")},resourceDestinationString:function(){const data=this.resume();this.stack[this.stack.length-1].url=data},resourceTitleString:function(){const data=this.resume();this.stack[this.stack.length-1].title=data},resource:function(){setData("inReference")},setextHeading:closer((function(){setData("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(token){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(token).charCodeAt(0)?1:2},setextHeadingText:function(){setData("setextHeadingSlurpLineEnding",!0)},strong:closer(),thematicBreak:closer()}},options.mdastExtensions||[]),data={};return function(events){let tree={type:"root",children:[]};const tokenStack=[],listStack=[],context={stack:[tree],tokenStack,config,enter,exit,buffer,resume,setData,getData};let index=-1;for(;++index<events.length;)"listOrdered"!==events[index][1].type&&"listUnordered"!==events[index][1].type||("enter"===events[index][0]?listStack.push(index):index=prepareList(events,listStack.pop(),index));for(index=-1;++index<events.length;){const handler=config[events[index][0]];own$2.call(handler,events[index][1].type)&&handler[events[index][1].type].call(Object.assign({sliceSerialize:events[index][2].sliceSerialize},context),events[index][1])}if(tokenStack.length>0)throw new Error("Cannot close document, a token (`"+tokenStack[tokenStack.length-1].type+"`, "+stringifyPosition({start:tokenStack[tokenStack.length-1].start,end:tokenStack[tokenStack.length-1].end})+") is still open");for(tree.position={start:point(events.length>0?events[0][1].start:{line:1,column:1,offset:0}),end:point(events.length>0?events[events.length-2][1].end:{line:1,column:1,offset:0})},index=-1;++index<config.transforms.length;)tree=config.transforms[index](tree)||tree;return tree};function prepareList(events,start,length){let listItem,lineIndex,firstBlankLineIndex,atMarker,index=start-1,containerBalance=-1,listSpread=!1;for(;++index<=length;){const event=events[index];if("listUnordered"===event[1].type||"listOrdered"===event[1].type||"blockQuote"===event[1].type?("enter"===event[0]?containerBalance++:containerBalance--,atMarker=void 0):"lineEndingBlank"===event[1].type?"enter"===event[0]&&(!listItem||atMarker||containerBalance||firstBlankLineIndex||(firstBlankLineIndex=index),atMarker=void 0):"linePrefix"===event[1].type||"listItemValue"===event[1].type||"listItemMarker"===event[1].type||"listItemPrefix"===event[1].type||"listItemPrefixWhitespace"===event[1].type||(atMarker=void 0),!containerBalance&&"enter"===event[0]&&"listItemPrefix"===event[1].type||-1===containerBalance&&"exit"===event[0]&&("listUnordered"===event[1].type||"listOrdered"===event[1].type)){if(listItem){let tailIndex=index;for(lineIndex=void 0;tailIndex--;){const tailEvent=events[tailIndex];if("lineEnding"===tailEvent[1].type||"lineEndingBlank"===tailEvent[1].type){if("exit"===tailEvent[0])continue;lineIndex&&(events[lineIndex][1].type="lineEndingBlank",listSpread=!0),tailEvent[1].type="lineEnding",lineIndex=tailIndex}else if("linePrefix"!==tailEvent[1].type&&"blockQuotePrefix"!==tailEvent[1].type&&"blockQuotePrefixWhitespace"!==tailEvent[1].type&&"blockQuoteMarker"!==tailEvent[1].type&&"listItemIndent"!==tailEvent[1].type)break}firstBlankLineIndex&&(!lineIndex||firstBlankLineIndex<lineIndex)&&(listItem._spread=!0),listItem.end=Object.assign({},lineIndex?events[lineIndex][1].start:event[1].end),events.splice(lineIndex||index,0,["exit",listItem,event[2]]),index++,length++}"listItemPrefix"===event[1].type&&(listItem={type:"listItem",_spread:!1,start:Object.assign({},event[1].start)},events.splice(index,0,["enter",listItem,event[2]]),index++,length++,firstBlankLineIndex=void 0,atMarker=!0)}}return events[start][1]._spread=listSpread,length}function setData(key,value){data[key]=value}function getData(key){return data[key]}function point(d){return{line:d.line,column:d.column,offset:d.offset}}function opener(create,and){return function(token){enter.call(this,create(token),token),and&&and.call(this,token)}}function buffer(){this.stack.push({type:"fragment",children:[]})}function enter(node,token){return this.stack[this.stack.length-1].children.push(node),this.stack.push(node),this.tokenStack.push(token),node.position={start:point(token.start)},node}function closer(and){return function(token){and&&and.call(this,token),exit.call(this,token)}}function exit(token){const node=this.stack.pop(),open=this.tokenStack.pop();if(!open)throw new Error("Cannot close `"+token.type+"` ("+stringifyPosition({start:token.start,end:token.end})+"): itâ€™s not open");if(open.type!==token.type)throw new Error("Cannot close `"+token.type+"` ("+stringifyPosition({start:token.start,end:token.end})+"): a different token (`"+open.type+"`, "+stringifyPosition({start:open.start,end:open.end})+") is open");return node.position.end=point(token.end),node}function resume(){return toString(this.stack.pop())}function onenterdata(token){const parent=this.stack[this.stack.length-1];let tail=parent.children[parent.children.length-1];tail&&"text"===tail.type||(tail={type:"text",value:""},tail.position={start:point(token.start)},parent.children.push(tail)),this.stack.push(tail)}function onexitdata(token){const tail=this.stack.pop();tail.value+=this.sliceSerialize(token),tail.position.end=point(token.end)}function onexithardbreak(){setData("atHardBreak",!0)}function onexitcharacterreferencemarker(token){setData("characterReferenceType",token.type)}function codeFlow(){return{type:"code",lang:null,meta:null,value:""}}function heading(){return{type:"heading",depth:void 0,children:[]}}function hardBreak(){return{type:"break"}}function html(){return{type:"html",value:""}}function link(){return{type:"link",title:null,url:"",children:[]}}function list(token){return{type:"list",ordered:"listOrdered"===token.type,start:null,spread:token._spread,children:[]}}}(options)(function(events){for(;!subtokenize(events););return events}(function(options={}){const parser={defined:[],lazy:{},constructs:combineExtensions([defaultConstructs].concat(options.extensions||[])),content:create(content$1),document:create(document$2),flow:create(flow$1),string:create(string$1),text:create(text$3)};return parser;function create(initial){return function(from){return createTokenizer(parser,initial,from)}}}(options).document().write(function(){let atCarriageReturn,column=1,buffer="",start=!0;return function(value,encoding,end){const chunks=[];let match,next,startPosition,endPosition,code;for(value=buffer+value.toString(encoding),startPosition=0,buffer="",start&&(65279===value.charCodeAt(0)&&startPosition++,start=void 0);startPosition<value.length;){if(search.lastIndex=startPosition,match=search.exec(value),endPosition=match&&void 0!==match.index?match.index:value.length,code=value.charCodeAt(endPosition),!match){buffer=value.slice(startPosition);break}if(10===code&&startPosition===endPosition&&atCarriageReturn)chunks.push(-3),atCarriageReturn=void 0;else switch(atCarriageReturn&&(chunks.push(-5),atCarriageReturn=void 0),startPosition<endPosition&&(chunks.push(value.slice(startPosition,endPosition)),column+=endPosition-startPosition),code){case 0:chunks.push(65533),column++;break;case 9:for(next=4*Math.ceil(column/4),chunks.push(-2);column++<next;)chunks.push(-1);break;case 10:chunks.push(-4),column=1;break;default:atCarriageReturn=!0,column=1}startPosition=endPosition+1}return end&&(atCarriageReturn&&chunks.push(-5),buffer&&chunks.push(buffer),chunks.push(null)),chunks}}()(value,encoding,!0))))};function configure$1(combined,extensions){let index=-1;for(;++index<extensions.length;){const value=extensions[index];Array.isArray(value)?configure$1(combined,value):extension(combined,value)}return combined}function extension(combined,extension){let key;for(key in extension)if(own$2.call(extension,key)){const list="canContainEols"===key||"transforms"===key,left=(own$2.call(combined,key)?combined[key]:void 0)||(combined[key]=list?[]:{}),right=extension[key];right&&(list?combined[key]=[...left,...right]:Object.assign(left,right))}}var own$1={}.hasOwnProperty;function configure(base,extension){let key,index=-1;if(extension.extensions)for(;++index<extension.extensions.length;)configure(base,extension.extensions[index]);for(key in extension)"extensions"===key||("unsafe"===key||"join"===key?base[key]=[...base[key]||[],...extension[key]||[]]:"handlers"===key?base[key]=Object.assign(base[key],extension[key]||{}):base.options[key]=extension[key]);return base}function track(options_){const options=options_||{},now=options.now||{};let lineShift=options.lineShift||0,line=now.line||1,column=now.column||1;return{move:function(value=""){const chunks=value.split(/\r?\n|\r/g),tail=chunks[chunks.length-1];return line+=chunks.length-1,column=1===chunks.length?column+tail.length:1+tail.length+lineShift,value},current:function(){return{now:{line,column},lineShift}},shift:function(value){lineShift+=value}}}function containerFlow(parent,context,safeOptions){const indexStack=context.indexStack,children=parent.children||[],tracker=track(safeOptions),results=[];let index=-1;for(indexStack.push(-1);++index<children.length;){const child=children[index];indexStack[indexStack.length-1]=index,results.push(tracker.move(context.handle(child,parent,context,{before:"\n",after:"\n",...tracker.current()}))),"list"!==child.type&&(context.bulletLastUsed=void 0),index<children.length-1&&results.push(tracker.move(between(child,children[index+1])))}return indexStack.pop(),results.join("");function between(left,right){let index=context.join.length;for(;index--;){const result=context.join[index](left,right,parent,context);if(!0===result||1===result)break;if("number"==typeof result)return"\n".repeat(1+result);if(!1===result)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}}const eol=/\r?\n|\r/g;function indentLines(value,map){const result=[];let match,start=0,line=0;for(;match=eol.exec(value);)one(value.slice(start,match.index)),result.push(match[0]),start=match.index+match[0].length,line++;return one(value.slice(start)),result.join("");function one(value){result.push(map(value,line,!value))}}function map$1(line,_,blank){return">"+(blank?"":" ")+line}function patternInScope(stack,pattern){return listInScope(stack,pattern.inConstruct,!0)&&!listInScope(stack,pattern.notInConstruct,!1)}function listInScope(stack,list,none){if(!list)return none;"string"==typeof list&&(list=[list]);let index=-1;for(;++index<list.length;)if(stack.includes(list[index]))return!0;return!1}function hardBreak(_,_1,context,safe){let index=-1;for(;++index<context.unsafe.length;)if("\n"===context.unsafe[index].character&&patternInScope(context.stack,context.unsafe[index]))return/[ \t]/.test(safe.before)?"":" ";return"\\\n"}function formatCodeAsIndented(node,context){return Boolean(!context.options.fences&&node.value&&!node.lang&&/[^ \r\n]/.test(node.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(node.value))}function patternCompile(pattern){if(!pattern._compiled){const before=(pattern.atBreak?"[\\r\\n][\\t ]*":"")+(pattern.before?"(?:"+pattern.before+")":"");pattern._compiled=new RegExp((before?"("+before+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(pattern.character)?"\\":"")+pattern.character+(pattern.after?"(?:"+pattern.after+")":""),"g")}return pattern._compiled}function safe(context,input,config){const value=(config.before||"")+(input||"")+(config.after||""),positions=[],result=[],infos={};let index=-1;for(;++index<context.unsafe.length;){const pattern=context.unsafe[index];if(!patternInScope(context.stack,pattern))continue;const expression=patternCompile(pattern);let match;for(;match=expression.exec(value);){const before="before"in pattern||Boolean(pattern.atBreak),after="after"in pattern,position=match.index+(before?match[1].length:0);positions.includes(position)?(infos[position].before&&!before&&(infos[position].before=!1),infos[position].after&&!after&&(infos[position].after=!1)):(positions.push(position),infos[position]={before,after})}}positions.sort(numerical);let start=config.before?config.before.length:0;const end=value.length-(config.after?config.after.length:0);for(index=-1;++index<positions.length;){const position=positions[index];position<start||position>=end||position+1<end&&positions[index+1]===position+1&&infos[position].after&&!infos[position+1].before&&!infos[position+1].after||positions[index-1]===position-1&&infos[position].before&&!infos[position-1].before&&!infos[position-1].after||(start!==position&&result.push(escapeBackslashes(value.slice(start,position),"\\")),start=position,!/[!-/:-@[-`{-~]/.test(value.charAt(position))||config.encode&&config.encode.includes(value.charAt(position))?(result.push("&#x"+value.charCodeAt(position).toString(16).toUpperCase()+";"),start++):result.push("\\"))}return result.push(escapeBackslashes(value.slice(start,end),config.after)),result.join("")}function numerical(a,b){return a-b}function escapeBackslashes(value,after){const expression=/\\(?=[!-/:-@[-`{-~])/g,positions=[],results=[],whole=value+after;let match,index=-1,start=0;for(;match=expression.exec(whole);)positions.push(match.index);for(;++index<positions.length;)start!==positions[index]&&results.push(value.slice(start,positions[index])),results.push("\\"),start=positions[index];return results.push(value.slice(start)),results.join("")}function map(line,_,blank){return(blank?"":"    ")+line}function association(node){return node.label||!node.identifier?node.label||"":decodeString(node.identifier)}function checkQuote(context){const marker=context.options.quote||'"';if('"'!==marker&&"'"!==marker)throw new Error("Cannot serialize title with `"+marker+"` for `options.quote`, expected `\"`, or `'`");return marker}function containerPhrasing(parent,context,safeOptions){const indexStack=context.indexStack,children=parent.children||[],results=[];let index=-1,before=safeOptions.before;indexStack.push(-1);let tracker=track(safeOptions);for(;++index<children.length;){const child=children[index];let after;if(indexStack[indexStack.length-1]=index,index+1<children.length){let handle=context.handle.handlers[children[index+1].type];handle&&handle.peek&&(handle=handle.peek),after=handle?handle(children[index+1],parent,context,{before:"",after:"",...tracker.current()}).charAt(0):""}else after=safeOptions.after;results.length>0&&("\r"===before||"\n"===before)&&"html"===child.type&&(results[results.length-1]=results[results.length-1].replace(/(\r?\n|\r)$/," "),before=" ",tracker=track(safeOptions),tracker.move(results.join(""))),results.push(tracker.move(context.handle(child,parent,context,{...tracker.current(),before,after}))),before=results[results.length-1].slice(-1)}return indexStack.pop(),results.join("")}function emphasis(node,_,context,safeOptions){const marker=function(context){const marker=context.options.emphasis||"*";if("*"!==marker&&"_"!==marker)throw new Error("Cannot serialize emphasis with `"+marker+"` for `options.emphasis`, expected `*`, or `_`");return marker}(context),exit=context.enter("emphasis"),tracker=track(safeOptions);let value=tracker.move(marker);return value+=tracker.move(containerPhrasing(node,context,{before:value,after:marker,...tracker.current()})),value+=tracker.move(marker),exit(),value}function formatHeadingAsSetext(node,context){let literalWithBreak=!1;return visit(node,(node=>{if("value"in node&&/\r?\n|\r/.test(node.value)||"break"===node.type)return literalWithBreak=!0,!1})),Boolean((!node.depth||node.depth<3)&&toString(node)&&(context.options.setext||literalWithBreak))}function html(node){return node.value||""}function image(node,_,context,safeOptions){const quote=checkQuote(context),suffix='"'===quote?"Quote":"Apostrophe",exit=context.enter("image");let subexit=context.enter("label");const tracker=track(safeOptions);let value=tracker.move("![");return value+=tracker.move(safe(context,node.alt,{before:value,after:"]",...tracker.current()})),value+=tracker.move("]("),subexit(),!node.url&&node.title||/[\0- \u007F]/.test(node.url)?(subexit=context.enter("destinationLiteral"),value+=tracker.move("<"),value+=tracker.move(safe(context,node.url,{before:value,after:">",...tracker.current()})),value+=tracker.move(">")):(subexit=context.enter("destinationRaw"),value+=tracker.move(safe(context,node.url,{before:value,after:node.title?" ":")",...tracker.current()}))),subexit(),node.title&&(subexit=context.enter("title"+suffix),value+=tracker.move(" "+quote),value+=tracker.move(safe(context,node.title,{before:value,after:quote,...tracker.current()})),value+=tracker.move(quote),subexit()),value+=tracker.move(")"),exit(),value}function imageReference(node,_,context,safeOptions){const type=node.referenceType,exit=context.enter("imageReference");let subexit=context.enter("label");const tracker=track(safeOptions);let value=tracker.move("![");const alt=safe(context,node.alt,{before:value,after:"]",...tracker.current()});value+=tracker.move(alt+"]["),subexit();const stack=context.stack;context.stack=[],subexit=context.enter("reference");const reference=safe(context,association(node),{before:value,after:"]",...tracker.current()});return subexit(),context.stack=stack,exit(),"full"!==type&&alt&&alt===reference?"shortcut"===type?value=value.slice(0,-1):value+=tracker.move("]"):value+=tracker.move(reference+"]"),value}function inlineCode(node,_,context){let value=node.value||"",sequence="`",index=-1;for(;new RegExp("(^|[^`])"+sequence+"([^`]|$)").test(value);)sequence+="`";for(/[^ \r\n]/.test(value)&&(/^[ \r\n]/.test(value)&&/[ \r\n]$/.test(value)||/^`|`$/.test(value))&&(value=" "+value+" ");++index<context.unsafe.length;){const pattern=context.unsafe[index],expression=patternCompile(pattern);let match;if(pattern.atBreak)for(;match=expression.exec(value);){let position=match.index;10===value.charCodeAt(position)&&13===value.charCodeAt(position-1)&&position--,value=value.slice(0,position)+" "+value.slice(match.index+1)}}return sequence+value+sequence}function formatLinkAsAutolink(node,context){const raw=toString(node);return Boolean(!context.options.resourceLink&&node.url&&!node.title&&node.children&&1===node.children.length&&"text"===node.children[0].type&&(raw===node.url||"mailto:"+raw===node.url)&&/^[a-z][a-z+.-]+:/i.test(node.url)&&!/[\0- <>\u007F]/.test(node.url))}function link(node,_,context,safeOptions){const quote=checkQuote(context),suffix='"'===quote?"Quote":"Apostrophe",tracker=track(safeOptions);let exit,subexit;if(formatLinkAsAutolink(node,context)){const stack=context.stack;context.stack=[],exit=context.enter("autolink");let value=tracker.move("<");return value+=tracker.move(containerPhrasing(node,context,{before:value,after:">",...tracker.current()})),value+=tracker.move(">"),exit(),context.stack=stack,value}exit=context.enter("link"),subexit=context.enter("label");let value=tracker.move("[");return value+=tracker.move(containerPhrasing(node,context,{before:value,after:"](",...tracker.current()})),value+=tracker.move("]("),subexit(),!node.url&&node.title||/[\0- \u007F]/.test(node.url)?(subexit=context.enter("destinationLiteral"),value+=tracker.move("<"),value+=tracker.move(safe(context,node.url,{before:value,after:">",...tracker.current()})),value+=tracker.move(">")):(subexit=context.enter("destinationRaw"),value+=tracker.move(safe(context,node.url,{before:value,after:node.title?" ":")",...tracker.current()}))),subexit(),node.title&&(subexit=context.enter("title"+suffix),value+=tracker.move(" "+quote),value+=tracker.move(safe(context,node.title,{before:value,after:quote,...tracker.current()})),value+=tracker.move(quote),subexit()),value+=tracker.move(")"),exit(),value}function linkReference(node,_,context,safeOptions){const type=node.referenceType,exit=context.enter("linkReference");let subexit=context.enter("label");const tracker=track(safeOptions);let value=tracker.move("[");const text=containerPhrasing(node,context,{before:value,after:"]",...tracker.current()});value+=tracker.move(text+"]["),subexit();const stack=context.stack;context.stack=[],subexit=context.enter("reference");const reference=safe(context,association(node),{before:value,after:"]",...tracker.current()});return subexit(),context.stack=stack,exit(),"full"!==type&&text&&text===reference?"shortcut"===type?value=value.slice(0,-1):value+=tracker.move("]"):value+=tracker.move(reference+"]"),value}function checkBullet(context){const marker=context.options.bullet||"*";if("*"!==marker&&"+"!==marker&&"-"!==marker)throw new Error("Cannot serialize items with `"+marker+"` for `options.bullet`, expected `*`, `+`, or `-`");return marker}function checkBulletOrdered(context){const marker=context.options.bulletOrdered||".";if("."!==marker&&")"!==marker)throw new Error("Cannot serialize items with `"+marker+"` for `options.bulletOrdered`, expected `.` or `)`");return marker}function checkRule(context){const marker=context.options.rule||"*";if("*"!==marker&&"-"!==marker&&"_"!==marker)throw new Error("Cannot serialize rules with `"+marker+"` for `options.rule`, expected `*`, `-`, or `_`");return marker}function listItem(node,parent,context,safeOptions){const listItemIndent=function(context){const style=context.options.listItemIndent||"tab";if(1===style||"1"===style)return"one";if("tab"!==style&&"one"!==style&&"mixed"!==style)throw new Error("Cannot serialize items with `"+style+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return style}(context);let bullet=context.bulletCurrent||checkBullet(context);parent&&"list"===parent.type&&parent.ordered&&(bullet=("number"==typeof parent.start&&parent.start>-1?parent.start:1)+(!1===context.options.incrementListMarker?0:parent.children.indexOf(node))+bullet);let size=bullet.length+1;("tab"===listItemIndent||"mixed"===listItemIndent&&(parent&&"list"===parent.type&&parent.spread||node.spread))&&(size=4*Math.ceil(size/4));const tracker=track(safeOptions);tracker.move(bullet+" ".repeat(size-bullet.length)),tracker.shift(size);const exit=context.enter("listItem"),value=indentLines(containerFlow(node,context,tracker.current()),(function(line,index,blank){return index?(blank?"":" ".repeat(size))+line:(blank?bullet:bullet+" ".repeat(size-bullet.length))+line}));return exit(),value}function strong(node,_,context,safeOptions){const marker=function(context){const marker=context.options.strong||"*";if("*"!==marker&&"_"!==marker)throw new Error("Cannot serialize strong with `"+marker+"` for `options.strong`, expected `*`, or `_`");return marker}(context),exit=context.enter("strong"),tracker=track(safeOptions);let value=tracker.move(marker+marker);return value+=tracker.move(containerPhrasing(node,context,{before:value,after:marker,...tracker.current()})),value+=tracker.move(marker+marker),exit(),value}emphasis.peek=function(_,_1,context){return context.options.emphasis||"*"},html.peek=function(){return"<"},image.peek=function(){return"!"},imageReference.peek=function(){return"!"},inlineCode.peek=function(){return"`"},link.peek=function(node,_,context){return formatLinkAsAutolink(node,context)?"<":"["},linkReference.peek=function(){return"["},strong.peek=function(_,_1,context){return context.options.strong||"*"};const handle={blockquote:function(node,_,context,safeOptions){const exit=context.enter("blockquote"),tracker=track(safeOptions);tracker.move("> "),tracker.shift(2);const value=indentLines(containerFlow(node,context,tracker.current()),map$1);return exit(),value},break:hardBreak,code:function(node,_,context,safeOptions){const marker=function(context){const marker=context.options.fence||"`";if("`"!==marker&&"~"!==marker)throw new Error("Cannot serialize code with `"+marker+"` for `options.fence`, expected `` ` `` or `~`");return marker}(context),raw=node.value||"",suffix="`"===marker?"GraveAccent":"Tilde";if(formatCodeAsIndented(node,context)){const exit=context.enter("codeIndented"),value=indentLines(raw,map);return exit(),value}const tracker=track(safeOptions),sequence=marker.repeat(Math.max(function(value,character){var source=String(value),index=source.indexOf(character),expected=index,count=0,max=0;if("string"!=typeof character||1!==character.length)throw new Error("Expected character");for(;-1!==index;)index===expected?++count>max&&(max=count):count=1,expected=index+1,index=source.indexOf(character,expected);return max}(raw,marker)+1,3)),exit=context.enter("codeFenced");let value=tracker.move(sequence);if(node.lang){const subexit=context.enter("codeFencedLang"+suffix);value+=tracker.move(safe(context,node.lang,{before:value,after:" ",encode:["`"],...tracker.current()})),subexit()}if(node.lang&&node.meta){const subexit=context.enter("codeFencedMeta"+suffix);value+=tracker.move(" "),value+=tracker.move(safe(context,node.meta,{before:value,after:"\n",encode:["`"],...tracker.current()})),subexit()}return value+=tracker.move("\n"),raw&&(value+=tracker.move(raw+"\n")),value+=tracker.move(sequence),exit(),value},definition:function(node,_,context,safeOptions){const quote=checkQuote(context),suffix='"'===quote?"Quote":"Apostrophe",exit=context.enter("definition");let subexit=context.enter("label");const tracker=track(safeOptions);let value=tracker.move("[");return value+=tracker.move(safe(context,association(node),{before:value,after:"]",...tracker.current()})),value+=tracker.move("]: "),subexit(),!node.url||/[\0- \u007F]/.test(node.url)?(subexit=context.enter("destinationLiteral"),value+=tracker.move("<"),value+=tracker.move(safe(context,node.url,{before:value,after:">",...tracker.current()})),value+=tracker.move(">")):(subexit=context.enter("destinationRaw"),value+=tracker.move(safe(context,node.url,{before:value,after:node.title?" ":"\n",...tracker.current()}))),subexit(),node.title&&(subexit=context.enter("title"+suffix),value+=tracker.move(" "+quote),value+=tracker.move(safe(context,node.title,{before:value,after:quote,...tracker.current()})),value+=tracker.move(quote),subexit()),exit(),value},emphasis,hardBreak,heading:function(node,_,context,safeOptions){const rank=Math.max(Math.min(6,node.depth||1),1),tracker=track(safeOptions);if(formatHeadingAsSetext(node,context)){const exit=context.enter("headingSetext"),subexit=context.enter("phrasing"),value=containerPhrasing(node,context,{...tracker.current(),before:"\n",after:"\n"});return subexit(),exit(),value+"\n"+(1===rank?"=":"-").repeat(value.length-(Math.max(value.lastIndexOf("\r"),value.lastIndexOf("\n"))+1))}const sequence="#".repeat(rank),exit=context.enter("headingAtx"),subexit=context.enter("phrasing");tracker.move(sequence+" ");let value=containerPhrasing(node,context,{before:"# ",after:"\n",...tracker.current()});return/^[\t ]/.test(value)&&(value="&#x"+value.charCodeAt(0).toString(16).toUpperCase()+";"+value.slice(1)),value=value?sequence+" "+value:sequence,context.options.closeAtx&&(value+=" "+sequence),subexit(),exit(),value},html,image,imageReference,inlineCode,link,linkReference,list:function(node,parent,context,safeOptions){const exit=context.enter("list"),bulletCurrent=context.bulletCurrent;let bullet=node.ordered?checkBulletOrdered(context):checkBullet(context);const bulletOther=node.ordered?function(context){const bulletOrdered=checkBulletOrdered(context),bulletOrderedOther=context.options.bulletOrderedOther;if(!bulletOrderedOther)return"."===bulletOrdered?")":".";if("."!==bulletOrderedOther&&")"!==bulletOrderedOther)throw new Error("Cannot serialize items with `"+bulletOrderedOther+"` for `options.bulletOrderedOther`, expected `*`, `+`, or `-`");if(bulletOrderedOther===bulletOrdered)throw new Error("Expected `bulletOrdered` (`"+bulletOrdered+"`) and `bulletOrderedOther` (`"+bulletOrderedOther+"`) to be different");return bulletOrderedOther}(context):function(context){const bullet=checkBullet(context),bulletOther=context.options.bulletOther;if(!bulletOther)return"*"===bullet?"-":"*";if("*"!==bulletOther&&"+"!==bulletOther&&"-"!==bulletOther)throw new Error("Cannot serialize items with `"+bulletOther+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(bulletOther===bullet)throw new Error("Expected `bullet` (`"+bullet+"`) and `bulletOther` (`"+bulletOther+"`) to be different");return bulletOther}(context),bulletLastUsed=context.bulletLastUsed;let useDifferentMarker=!1;if(parent&&(node.ordered?context.options.bulletOrderedOther:context.options.bulletOther)&&bulletLastUsed&&bullet===bulletLastUsed&&(useDifferentMarker=!0),!node.ordered){const firstListItem=node.children?node.children[0]:void 0;if("*"!==bullet&&"-"!==bullet||!firstListItem||firstListItem.children&&firstListItem.children[0]||"list"!==context.stack[context.stack.length-1]||"listItem"!==context.stack[context.stack.length-2]||"list"!==context.stack[context.stack.length-3]||"listItem"!==context.stack[context.stack.length-4]||0!==context.indexStack[context.indexStack.length-1]||0!==context.indexStack[context.indexStack.length-2]||0!==context.indexStack[context.indexStack.length-3]||(useDifferentMarker=!0),checkRule(context)===bullet&&firstListItem){let index=-1;for(;++index<node.children.length;){const item=node.children[index];if(item&&"listItem"===item.type&&item.children&&item.children[0]&&"thematicBreak"===item.children[0].type){useDifferentMarker=!0;break}}}}useDifferentMarker&&(bullet=bulletOther),context.bulletCurrent=bullet;const value=containerFlow(node,context,safeOptions);return context.bulletLastUsed=bullet,context.bulletCurrent=bulletCurrent,exit(),value},listItem,paragraph:function(node,_,context,safeOptions){const exit=context.enter("paragraph"),subexit=context.enter("phrasing"),value=containerPhrasing(node,context,safeOptions);return subexit(),exit(),value},root:function(node,_,context,safeOptions){return containerFlow(node,context,safeOptions)},strong,text:function(node,_,context,safeOptions){return safe(context,node.value,safeOptions)},thematicBreak:function(_,_1,context){const value=(checkRule(context)+(context.options.ruleSpaces?" ":"")).repeat(function(context){const repetition=context.options.ruleRepetition||3;if(repetition<3)throw new Error("Cannot serialize rules with repetition `"+repetition+"` for `options.ruleRepetition`, expected `3` or more");return repetition}(context));return context.options.ruleSpaces?value.slice(0,-1):value}},join=[function(left,right,parent,context){if("code"===right.type&&formatCodeAsIndented(right,context)&&("list"===left.type||left.type===right.type&&formatCodeAsIndented(left,context)))return!1;if("list"===left.type&&left.type===right.type&&Boolean(left.ordered)===Boolean(right.ordered)&&!(left.ordered?context.options.bulletOrderedOther:context.options.bulletOther))return!1;if("spread"in parent&&"boolean"==typeof parent.spread){if("paragraph"===left.type&&(left.type===right.type||"definition"===right.type||"heading"===right.type&&formatHeadingAsSetext(right,context)))return;return parent.spread?1:0}}],fullPhrasingSpans=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],unsafe=[{character:"\t",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*"},{character:"*",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,character:"+"},{atBreak:!0,character:"-"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ \t\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:fullPhrasingSpans},{atBreak:!0,character:"~"}];function invalid(value){throw new Error("Cannot handle value `"+value+"`, expected node")}function unknown(node){throw new Error("Cannot handle unknown node `"+node.type+"`")}function joinDefinition(left,right){if("definition"===left.type&&left.type===right.type)return 0}const remark=unified().use((function(options){Object.assign(this,{Parser:doc=>{const settings=this.data("settings");return fromMarkdown(doc,Object.assign({},settings,options,{extensions:this.data("micromarkExtensions")||[],mdastExtensions:this.data("fromMarkdownExtensions")||[]}))}})})).use((function(options){Object.assign(this,{Compiler:tree=>{const settings=this.data("settings");return function(tree,options={}){const context={enter:function(name){return context.stack.push(name),function(){context.stack.pop()}},stack:[],unsafe:[],join:[],handlers:{},options:{},indexStack:[]};configure(context,{unsafe,join,handlers:handle}),configure(context,options),context.options.tightDefinitions&&configure(context,{join:[joinDefinition]}),context.handle=function(key,options){var settings=options||{};function one(value){var fn=one.invalid,handlers=one.handlers;if(value&&own$1.call(value,key)&&(fn=own$1.call(handlers,value.type)?handlers[value.type]:one.unknown),fn)return fn.apply(this,arguments)}return one.handlers=settings.handlers||{},one.invalid=settings.invalid,one.unknown=settings.unknown,one}("type",{invalid,unknown,handlers:context.handlers});let result=context.handle(tree,null,context,{before:"\n",after:"\n",now:{line:1,column:1},lineShift:0});return result&&10!==result.charCodeAt(result.length-1)&&13!==result.charCodeAt(result.length-1)&&(result+="\n"),result}(tree,Object.assign({},settings,options,{extensions:this.data("toMarkdownExtensions")||[]}))}})})).freeze(),www={tokenize:function(effects,ok,nok){return function(code){return effects.consume(code),w2};function w2(code){return 87===code||119===code?(effects.consume(code),w3):nok(code)}function w3(code){return 87===code||119===code?(effects.consume(code),dot):nok(code)}function dot(code){return 46===code?(effects.consume(code),after):nok(code)}function after(code){return null===code||markdownLineEnding(code)?nok(code):ok(code)}},partial:!0},domain={tokenize:function(effects,ok,nok){let hasUnderscoreInLastSegment,hasUnderscoreInLastLastSegment;return domain;function domain(code){return 38===code?effects.check(namedCharacterReference,done,punctuationContinuation)(code):46===code||95===code?effects.check(punctuation,done,punctuationContinuation)(code):null===code||asciiControl(code)||unicodeWhitespace(code)||45!==code&&unicodePunctuation(code)?done(code):(effects.consume(code),domain)}function punctuationContinuation(code){return 46===code?(hasUnderscoreInLastLastSegment=hasUnderscoreInLastSegment,hasUnderscoreInLastSegment=void 0,effects.consume(code),domain):(95===code&&(hasUnderscoreInLastSegment=!0),effects.consume(code),domain)}function done(code){return hasUnderscoreInLastLastSegment||hasUnderscoreInLastSegment?nok(code):ok(code)}},partial:!0},path={tokenize:function(effects,ok){let balance=0;return inPath;function inPath(code){return 38===code?effects.check(namedCharacterReference,ok,continuedPunctuation)(code):(40===code&&balance++,41===code?effects.check(punctuation,parenAtPathEnd,continuedPunctuation)(code):pathEnd(code)?ok(code):trailingPunctuation(code)?effects.check(punctuation,ok,continuedPunctuation)(code):(effects.consume(code),inPath))}function continuedPunctuation(code){return effects.consume(code),inPath}function parenAtPathEnd(code){return balance--,balance<0?ok(code):continuedPunctuation(code)}},partial:!0},punctuation={tokenize:function(effects,ok,nok){return function(code){return effects.consume(code),after};function after(code){return trailingPunctuation(code)?(effects.consume(code),after):pathEnd(code)?ok(code):nok(code)}},partial:!0},namedCharacterReference={tokenize:function(effects,ok,nok){return function(code){return effects.consume(code),inside};function inside(code){return asciiAlpha(code)?(effects.consume(code),inside):59===code?(effects.consume(code),after):nok(code)}function after(code){return pathEnd(code)?ok(code):nok(code)}},partial:!0},wwwAutolink={tokenize:function(effects,ok,nok){const self=this;return function(code){return 87!==code&&119!==code||!previousWww(self.previous)||previousUnbalanced(self.events)?nok(code):(effects.enter("literalAutolink"),effects.enter("literalAutolinkWww"),effects.check(www,effects.attempt(domain,effects.attempt(path,done),nok),nok)(code))};function done(code){return effects.exit("literalAutolinkWww"),effects.exit("literalAutolink"),ok(code)}},previous:previousWww},httpAutolink={tokenize:function(effects,ok,nok){const self=this;return function(code){return 72!==code&&104!==code||!previousHttp(self.previous)||previousUnbalanced(self.events)?nok(code):(effects.enter("literalAutolink"),effects.enter("literalAutolinkHttp"),effects.consume(code),t1)};function t1(code){return 84===code||116===code?(effects.consume(code),t2):nok(code)}function t2(code){return 84===code||116===code?(effects.consume(code),p):nok(code)}function p(code){return 80===code||112===code?(effects.consume(code),s):nok(code)}function s(code){return 83===code||115===code?(effects.consume(code),colon):colon(code)}function colon(code){return 58===code?(effects.consume(code),slash1):nok(code)}function slash1(code){return 47===code?(effects.consume(code),slash2):nok(code)}function slash2(code){return 47===code?(effects.consume(code),after):nok(code)}function after(code){return null===code||asciiControl(code)||unicodeWhitespace(code)||unicodePunctuation(code)?nok(code):effects.attempt(domain,effects.attempt(path,done),nok)(code)}function done(code){return effects.exit("literalAutolinkHttp"),effects.exit("literalAutolink"),ok(code)}},previous:previousHttp},emailAutolink={tokenize:function(effects,ok,nok){const self=this;let hasDot,hasDigitInLastSegment;return function(code){return gfmAtext(code)&&previousEmail(self.previous)&&!previousUnbalanced(self.events)?(effects.enter("literalAutolink"),effects.enter("literalAutolinkEmail"),atext(code)):nok(code)};function atext(code){return gfmAtext(code)?(effects.consume(code),atext):64===code?(effects.consume(code),label):nok(code)}function label(code){return 46===code?effects.check(punctuation,done,dotContinuation)(code):45===code||95===code?effects.check(punctuation,nok,dashOrUnderscoreContinuation)(code):asciiAlphanumeric(code)?(!hasDigitInLastSegment&&asciiDigit(code)&&(hasDigitInLastSegment=!0),effects.consume(code),label):done(code)}function dotContinuation(code){return effects.consume(code),hasDot=!0,hasDigitInLastSegment=void 0,label}function dashOrUnderscoreContinuation(code){return effects.consume(code),afterDashOrUnderscore}function afterDashOrUnderscore(code){return 46===code?effects.check(punctuation,nok,dotContinuation)(code):label(code)}function done(code){return hasDot&&!hasDigitInLastSegment?(effects.exit("literalAutolinkEmail"),effects.exit("literalAutolink"),ok(code)):nok(code)}},previous:previousEmail},text={},gfmAutolinkLiteral={text};let code=48;for(;code<123;)text[code]=emailAutolink,code++,58===code?code=65:91===code&&(code=97);function trailingPunctuation(code){return 33===code||34===code||39===code||41===code||42===code||44===code||46===code||58===code||59===code||60===code||63===code||95===code||126===code}function pathEnd(code){return null===code||60===code||markdownLineEndingOrSpace(code)}function gfmAtext(code){return 43===code||45===code||46===code||95===code||asciiAlphanumeric(code)}function previousWww(code){return null===code||40===code||42===code||95===code||126===code||markdownLineEndingOrSpace(code)}function previousHttp(code){return null===code||!asciiAlpha(code)}function previousEmail(code){return 47!==code&&previousHttp(code)}function previousUnbalanced(events){let index=events.length,result=!1;for(;index--;){const token=events[index][1];if(("labelLink"===token.type||"labelImage"===token.type)&&!token._balanced){result=!0;break}if(token._gfmAutolinkLiteralWalkedInto){result=!1;break}}return events.length>0&&!result&&(events[events.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),result}text[43]=emailAutolink,text[45]=emailAutolink,text[46]=emailAutolink,text[95]=emailAutolink,text[72]=[emailAutolink,httpAutolink],text[104]=[emailAutolink,httpAutolink],text[87]=[emailAutolink,wwwAutolink],text[119]=[emailAutolink,wwwAutolink];const indent={tokenize:function(effects,ok,nok){const self=this;return factorySpace(effects,(function(code){const tail=self.events[self.events.length-1];return tail&&"gfmFootnoteDefinitionIndent"===tail[1].type&&4===tail[2].sliceSerialize(tail[1],!0).length?ok(code):nok(code)}),"gfmFootnoteDefinitionIndent",5)},partial:!0};function tokenizePotentialGfmFootnoteCall(effects,ok,nok){const self=this;let index=self.events.length;const defined=self.parser.gfmFootnotes||(self.parser.gfmFootnotes=[]);let labelStart;for(;index--;){const token=self.events[index][1];if("labelImage"===token.type){labelStart=token;break}if("gfmFootnoteCall"===token.type||"labelLink"===token.type||"label"===token.type||"image"===token.type||"link"===token.type)break}return function(code){if(!labelStart||!labelStart._balanced)return nok(code);const id=normalizeIdentifier(self.sliceSerialize({start:labelStart.end,end:self.now()}));return 94===id.charCodeAt(0)&&defined.includes(id.slice(1))?(effects.enter("gfmFootnoteCallLabelMarker"),effects.consume(code),effects.exit("gfmFootnoteCallLabelMarker"),ok(code)):nok(code)}}function resolveToPotentialGfmFootnoteCall(events,context){let index=events.length;for(;index--;)if("labelImage"===events[index][1].type&&"enter"===events[index][0]){events[index][1];break}events[index+1][1].type="data",events[index+3][1].type="gfmFootnoteCallLabelMarker";const call={type:"gfmFootnoteCall",start:Object.assign({},events[index+3][1].start),end:Object.assign({},events[events.length-1][1].end)},marker={type:"gfmFootnoteCallMarker",start:Object.assign({},events[index+3][1].end),end:Object.assign({},events[index+3][1].end)};marker.end.column++,marker.end.offset++,marker.end._bufferIndex++;const string={type:"gfmFootnoteCallString",start:Object.assign({},marker.end),end:Object.assign({},events[events.length-1][1].start)},chunk={type:"chunkString",contentType:"string",start:Object.assign({},string.start),end:Object.assign({},string.end)},replacement=[events[index+1],events[index+2],["enter",call,context],events[index+3],events[index+4],["enter",marker,context],["exit",marker,context],["enter",string,context],["enter",chunk,context],["exit",chunk,context],["exit",string,context],events[events.length-2],events[events.length-1],["exit",call,context]];return events.splice(index,events.length-index+1,...replacement),events}function tokenizeGfmFootnoteCall(effects,ok,nok){const self=this,defined=self.parser.gfmFootnotes||(self.parser.gfmFootnotes=[]);let data,size=0;return function(code){return effects.enter("gfmFootnoteCall"),effects.enter("gfmFootnoteCallLabelMarker"),effects.consume(code),effects.exit("gfmFootnoteCallLabelMarker"),callStart};function callStart(code){return 94!==code?nok(code):(effects.enter("gfmFootnoteCallMarker"),effects.consume(code),effects.exit("gfmFootnoteCallMarker"),effects.enter("gfmFootnoteCallString"),effects.enter("chunkString").contentType="string",callData)}function callData(code){let token;return null===code||91===code||size++>999?nok(code):93===code?data?(effects.exit("chunkString"),token=effects.exit("gfmFootnoteCallString"),defined.includes(normalizeIdentifier(self.sliceSerialize(token)))?function(code){return effects.enter("gfmFootnoteCallLabelMarker"),effects.consume(code),effects.exit("gfmFootnoteCallLabelMarker"),effects.exit("gfmFootnoteCall"),ok}(code):nok(code)):nok(code):(effects.consume(code),markdownLineEndingOrSpace(code)||(data=!0),92===code?callEscape:callData)}function callEscape(code){return 91===code||92===code||93===code?(effects.consume(code),size++,callData):callData(code)}}function tokenizeDefinitionStart(effects,ok,nok){const self=this,defined=self.parser.gfmFootnotes||(self.parser.gfmFootnotes=[]);let identifier,data,size=0;return function(code){return effects.enter("gfmFootnoteDefinition")._container=!0,effects.enter("gfmFootnoteDefinitionLabel"),effects.enter("gfmFootnoteDefinitionLabelMarker"),effects.consume(code),effects.exit("gfmFootnoteDefinitionLabelMarker"),labelStart};function labelStart(code){return 94===code?(effects.enter("gfmFootnoteDefinitionMarker"),effects.consume(code),effects.exit("gfmFootnoteDefinitionMarker"),effects.enter("gfmFootnoteDefinitionLabelString"),atBreak):nok(code)}function atBreak(code){let token;return null===code||91===code||size>999?nok(code):93===code?data?(token=effects.exit("gfmFootnoteDefinitionLabelString"),identifier=normalizeIdentifier(self.sliceSerialize(token)),effects.enter("gfmFootnoteDefinitionLabelMarker"),effects.consume(code),effects.exit("gfmFootnoteDefinitionLabelMarker"),effects.exit("gfmFootnoteDefinitionLabel"),labelAfter):nok(code):markdownLineEnding(code)?(effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),size++,atBreak):(effects.enter("chunkString").contentType="string",label(code))}function label(code){return null===code||markdownLineEnding(code)||91===code||93===code||size>999?(effects.exit("chunkString"),atBreak(code)):(markdownLineEndingOrSpace(code)||(data=!0),size++,effects.consume(code),92===code?labelEscape:label)}function labelEscape(code){return 91===code||92===code||93===code?(effects.consume(code),size++,label):label(code)}function labelAfter(code){return 58===code?(effects.enter("definitionMarker"),effects.consume(code),effects.exit("definitionMarker"),factorySpace(effects,done,"gfmFootnoteDefinitionWhitespace")):nok(code)}function done(code){return defined.includes(identifier)||defined.push(identifier),ok(code)}}function tokenizeDefinitionContinuation(effects,ok,nok){return effects.check(blankLine,ok,effects.attempt(indent,ok,nok))}function gfmFootnoteDefinitionEnd(effects){effects.exit("gfmFootnoteDefinition")}function gfmStrikethrough(options={}){let single=options.singleTilde;const tokenizer={tokenize:function(effects,ok,nok){const previous=this.previous,events=this.events;let size=0;return function(code){return 126===previous&&"characterEscape"!==events[events.length-1][1].type?nok(code):(effects.enter("strikethroughSequenceTemporary"),more(code))};function more(code){const before=classifyCharacter(previous);if(126===code)return size>1?nok(code):(effects.consume(code),size++,more);if(size<2&&!single)return nok(code);const token=effects.exit("strikethroughSequenceTemporary"),after=classifyCharacter(code);return token._open=!after||2===after&&Boolean(before),token._close=!before||2===before&&Boolean(after),ok(code)}},resolveAll:function(events,context){let index=-1;for(;++index<events.length;)if("enter"===events[index][0]&&"strikethroughSequenceTemporary"===events[index][1].type&&events[index][1]._close){let open=index;for(;open--;)if("exit"===events[open][0]&&"strikethroughSequenceTemporary"===events[open][1].type&&events[open][1]._open&&events[index][1].end.offset-events[index][1].start.offset==events[open][1].end.offset-events[open][1].start.offset){events[index][1].type="strikethroughSequence",events[open][1].type="strikethroughSequence";const strikethrough={type:"strikethrough",start:Object.assign({},events[open][1].start),end:Object.assign({},events[index][1].end)},text={type:"strikethroughText",start:Object.assign({},events[open][1].end),end:Object.assign({},events[index][1].start)},nextEvents=[["enter",strikethrough,context],["enter",events[open][1],context],["exit",events[open][1],context],["enter",text,context]];splice(nextEvents,nextEvents.length,0,resolveAll(context.parser.constructs.insideSpan.null,events.slice(open+1,index),context)),splice(nextEvents,nextEvents.length,0,[["exit",text,context],["enter",events[index][1],context],["exit",events[index][1],context],["exit",strikethrough,context]]),splice(events,open-1,index-open+3,nextEvents),index=open+nextEvents.length-2;break}}for(index=-1;++index<events.length;)"strikethroughSequenceTemporary"===events[index][1].type&&(events[index][1].type="data");return events}};return null==single&&(single=!0),{text:{126:tokenizer},insideSpan:{null:[tokenizer]},attentionMarkers:{null:[126]}}}const gfmTable={flow:{null:{tokenize:function(effects,ok,nok){const self=this,align=[];let seenDelimiter,hasDash,tableHeaderCount=0;return function(code){return effects.enter("table")._align=align,effects.enter("tableHead"),effects.enter("tableRow"),124===code?cellDividerHead(code):(tableHeaderCount++,effects.enter("temporaryTableCellContent"),inCellContentHead(code))};function cellDividerHead(code){return effects.enter("tableCellDivider"),effects.consume(code),effects.exit("tableCellDivider"),seenDelimiter=!0,cellBreakHead}function cellBreakHead(code){return null===code||markdownLineEnding(code)?function(code){if(null===code)return nok(code);effects.exit("tableRow"),effects.exit("tableHead");const originalInterrupt=self.interrupt;return self.interrupt=!0,effects.attempt({tokenize:tokenizeRowEnd,partial:!0},(function(code){return self.interrupt=originalInterrupt,effects.enter("tableDelimiterRow"),atDelimiterRowBreak(code)}),(function(code){return self.interrupt=originalInterrupt,nok(code)}))(code)}(code):markdownSpace(code)?(effects.enter("whitespace"),effects.consume(code),inWhitespaceHead):(seenDelimiter&&(seenDelimiter=void 0,tableHeaderCount++),124===code?cellDividerHead(code):(effects.enter("temporaryTableCellContent"),inCellContentHead(code)))}function inWhitespaceHead(code){return markdownSpace(code)?(effects.consume(code),inWhitespaceHead):(effects.exit("whitespace"),cellBreakHead(code))}function inCellContentHead(code){return null===code||124===code||markdownLineEndingOrSpace(code)?(effects.exit("temporaryTableCellContent"),cellBreakHead(code)):(effects.consume(code),92===code?inCellContentEscapeHead:inCellContentHead)}function inCellContentEscapeHead(code){return 92===code||124===code?(effects.consume(code),inCellContentHead):inCellContentHead(code)}function atDelimiterRowBreak(code){return null===code||markdownLineEnding(code)?rowEndDelimiter(code):markdownSpace(code)?(effects.enter("whitespace"),effects.consume(code),inWhitespaceDelimiter):45===code?(effects.enter("tableDelimiterFiller"),effects.consume(code),hasDash=!0,align.push("none"),inFillerDelimiter):58===code?(effects.enter("tableDelimiterAlignment"),effects.consume(code),effects.exit("tableDelimiterAlignment"),align.push("left"),afterLeftAlignment):124===code?(effects.enter("tableCellDivider"),effects.consume(code),effects.exit("tableCellDivider"),atDelimiterRowBreak):nok(code)}function inWhitespaceDelimiter(code){return markdownSpace(code)?(effects.consume(code),inWhitespaceDelimiter):(effects.exit("whitespace"),atDelimiterRowBreak(code))}function inFillerDelimiter(code){return 45===code?(effects.consume(code),inFillerDelimiter):(effects.exit("tableDelimiterFiller"),58===code?(effects.enter("tableDelimiterAlignment"),effects.consume(code),effects.exit("tableDelimiterAlignment"),align[align.length-1]="left"===align[align.length-1]?"center":"right",afterRightAlignment):atDelimiterRowBreak(code))}function afterLeftAlignment(code){return 45===code?(effects.enter("tableDelimiterFiller"),effects.consume(code),hasDash=!0,inFillerDelimiter):nok(code)}function afterRightAlignment(code){return null===code||markdownLineEnding(code)?rowEndDelimiter(code):markdownSpace(code)?(effects.enter("whitespace"),effects.consume(code),inWhitespaceDelimiter):124===code?(effects.enter("tableCellDivider"),effects.consume(code),effects.exit("tableCellDivider"),atDelimiterRowBreak):nok(code)}function rowEndDelimiter(code){return effects.exit("tableDelimiterRow"),hasDash&&tableHeaderCount===align.length?null===code?tableClose(code):effects.check(nextPrefixedOrBlank,tableClose,effects.attempt({tokenize:tokenizeRowEnd,partial:!0},factorySpace(effects,bodyStart,"linePrefix",4),tableClose))(code):nok(code)}function tableClose(code){return effects.exit("table"),ok(code)}function bodyStart(code){return effects.enter("tableBody"),rowStartBody(code)}function rowStartBody(code){return effects.enter("tableRow"),124===code?cellDividerBody(code):(effects.enter("temporaryTableCellContent"),inCellContentBody(code))}function cellDividerBody(code){return effects.enter("tableCellDivider"),effects.consume(code),effects.exit("tableCellDivider"),cellBreakBody}function cellBreakBody(code){return null===code||markdownLineEnding(code)?function(code){return effects.exit("tableRow"),null===code?tableBodyClose(code):effects.check(nextPrefixedOrBlank,tableBodyClose,effects.attempt({tokenize:tokenizeRowEnd,partial:!0},factorySpace(effects,rowStartBody,"linePrefix",4),tableBodyClose))(code)}(code):markdownSpace(code)?(effects.enter("whitespace"),effects.consume(code),inWhitespaceBody):124===code?cellDividerBody(code):(effects.enter("temporaryTableCellContent"),inCellContentBody(code))}function inWhitespaceBody(code){return markdownSpace(code)?(effects.consume(code),inWhitespaceBody):(effects.exit("whitespace"),cellBreakBody(code))}function inCellContentBody(code){return null===code||124===code||markdownLineEndingOrSpace(code)?(effects.exit("temporaryTableCellContent"),cellBreakBody(code)):(effects.consume(code),92===code?inCellContentEscapeBody:inCellContentBody)}function inCellContentEscapeBody(code){return 92===code||124===code?(effects.consume(code),inCellContentBody):inCellContentBody(code)}function tableBodyClose(code){return effects.exit("tableBody"),tableClose(code)}function tokenizeRowEnd(effects,ok,nok){return function(code){return effects.enter("lineEnding"),effects.consume(code),effects.exit("lineEnding"),factorySpace(effects,prefixed,"linePrefix")};function prefixed(code){if(self.parser.lazy[self.now().line]||null===code||markdownLineEnding(code))return nok(code);const tail=self.events[self.events.length-1];return!self.parser.constructs.disable.null.includes("codeIndented")&&tail&&"linePrefix"===tail[1].type&&tail[2].sliceSerialize(tail[1],!0).length>=4?nok(code):(self._gfmTableDynamicInterruptHack=!0,effects.check(self.parser.constructs.flow,(function(code){return self._gfmTableDynamicInterruptHack=!1,nok(code)}),(function(code){return self._gfmTableDynamicInterruptHack=!1,ok(code)}))(code))}}},resolve:function(events,context){let inHead,inDelimiterRow,inRow,contentStart,contentEnd,cellStart,seenCellInRow,index=-1;for(;++index<events.length;){const token=events[index][1];if(inRow&&("temporaryTableCellContent"===token.type&&(contentStart=contentStart||index,contentEnd=index),("tableCellDivider"===token.type||"tableRow"===token.type)&&contentEnd)){const content={type:"tableContent",start:events[contentStart][1].start,end:events[contentEnd][1].end},text={type:"chunkText",start:content.start,end:content.end,contentType:"text"};events.splice(contentStart,contentEnd-contentStart+1,["enter",content,context],["enter",text,context],["exit",text,context],["exit",content,context]),index-=contentEnd-contentStart-3,contentStart=void 0,contentEnd=void 0}if("exit"===events[index][0]&&void 0!==cellStart&&cellStart+(seenCellInRow?0:1)<index&&("tableCellDivider"===token.type||"tableRow"===token.type&&(cellStart+3<index||"whitespace"!==events[cellStart][1].type))){const cell={type:inDelimiterRow?"tableDelimiter":inHead?"tableHeader":"tableData",start:events[cellStart][1].start,end:events[index][1].end};events.splice(index+("tableCellDivider"===token.type?1:0),0,["exit",cell,context]),events.splice(cellStart,0,["enter",cell,context]),index+=2,cellStart=index+1,seenCellInRow=!0}"tableRow"===token.type&&(inRow="enter"===events[index][0],inRow&&(cellStart=index+1,seenCellInRow=!1)),"tableDelimiterRow"===token.type&&(inDelimiterRow="enter"===events[index][0],inDelimiterRow&&(cellStart=index+1,seenCellInRow=!1)),"tableHead"===token.type&&(inHead="enter"===events[index][0])}return events}}}},nextPrefixedOrBlank={tokenize:function(effects,ok,nok){let size=0;return function(code){return effects.enter("check"),effects.consume(code),whitespace};function whitespace(code){return-1===code||32===code?(effects.consume(code),size++,4===size?ok:whitespace):null===code||markdownLineEndingOrSpace(code)?ok(code):nok(code)}},partial:!0},tasklistCheck={tokenize:function(effects,ok,nok){const self=this;return function(code){return null===self.previous&&self._gfmTasklistFirstContentOfListItem?(effects.enter("taskListCheck"),effects.enter("taskListCheckMarker"),effects.consume(code),effects.exit("taskListCheckMarker"),inside):nok(code)};function inside(code){return markdownLineEndingOrSpace(code)?(effects.enter("taskListCheckValueUnchecked"),effects.consume(code),effects.exit("taskListCheckValueUnchecked"),close):88===code||120===code?(effects.enter("taskListCheckValueChecked"),effects.consume(code),effects.exit("taskListCheckValueChecked"),close):nok(code)}function close(code){return 93===code?(effects.enter("taskListCheckMarker"),effects.consume(code),effects.exit("taskListCheckMarker"),effects.exit("taskListCheck"),effects.check({tokenize:spaceThenNonSpace},ok,nok)):nok(code)}}},gfmTaskListItem={text:{91:tasklistCheck}};function spaceThenNonSpace(effects,ok,nok){const self=this;return factorySpace(effects,(function(code){const tail=self.events[self.events.length-1];return(tail&&"whitespace"===tail[1].type||markdownLineEnding(code))&&null!==code?ok(code):nok(code)}),"whitespace")}function ccount(value,character){const source=String(value);if("string"!=typeof character)throw new TypeError("Expected character");let count=0,index=source.indexOf(character);for(;-1!==index;)count++,index=source.indexOf(character,index+character.length);return count}const own={}.hasOwnProperty;function toExpression(find){return"string"==typeof find?new RegExp(function(string){if("string"!=typeof string)throw new TypeError("Expected a string");return string.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(find),"g"):find}function toFunction(replace){return"function"==typeof replace?replace:()=>replace}const notInConstruct=["autolink","link","image","label"],gfmAutolinkLiteralFromMarkdown={transforms:[function(tree){!function(tree,find,replace,options){let settings,schema;"string"==typeof find||find instanceof RegExp?(schema=[[find,replace]],settings=options):(schema=find,settings=replace),settings||(settings={});const ignored=convert(settings.ignore||[]),pairs=function(schema){const result=[];if("object"!=typeof schema)throw new TypeError("Expected array or object as schema");if(Array.isArray(schema)){let index=-1;for(;++index<schema.length;)result.push([toExpression(schema[index][0]),toFunction(schema[index][1])])}else{let key;for(key in schema)own.call(schema,key)&&result.push([toExpression(key),toFunction(schema[key])])}return result}(schema);let pairIndex=-1;for(;++pairIndex<pairs.length;)visitParents(tree,"text",visitor);return tree;function visitor(node,parents){let grandparent,index=-1;for(;++index<parents.length;){const parent=parents[index];if(ignored(parent,grandparent?grandparent.children.indexOf(parent):void 0,grandparent))return;grandparent=parent}if(grandparent)return function(node,parents){const parent=parents[parents.length-1],find=pairs[pairIndex][0],replace=pairs[pairIndex][1];let start=0;const index=parent.children.indexOf(node);let position,change=!1,nodes=[];find.lastIndex=0;let match=find.exec(node.value);for(;match;){position=match.index;const matchObject={index:match.index,input:match.input,stack:[...parents,node]};let value=replace(...match,matchObject);if("string"==typeof value&&(value=value.length>0?{type:"text",value}:void 0),!1!==value&&(start!==position&&nodes.push({type:"text",value:node.value.slice(start,position)}),Array.isArray(value)?nodes.push(...value):value&&nodes.push(value),start=position+match[0].length,change=!0),!find.global)break;match=find.exec(node.value)}return change?(start<node.value.length&&nodes.push({type:"text",value:node.value.slice(start)}),parent.children.splice(index,1,...nodes)):nodes=[node],index+nodes.length}(node,parents)}}(tree,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,findUrl],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,findEmail]],{ignore:["link","linkReference"]})}],enter:{literalAutolink:function(token){this.enter({type:"link",title:null,url:"",children:[]},token)},literalAutolinkEmail:enterLiteralAutolinkValue,literalAutolinkHttp:enterLiteralAutolinkValue,literalAutolinkWww:enterLiteralAutolinkValue},exit:{literalAutolink:function(token){this.exit(token)},literalAutolinkEmail:function(token){this.config.exit.autolinkEmail.call(this,token)},literalAutolinkHttp:function(token){this.config.exit.autolinkProtocol.call(this,token)},literalAutolinkWww:function(token){this.config.exit.data.call(this,token),this.stack[this.stack.length-1].url="http://"+this.sliceSerialize(token)}}},gfmAutolinkLiteralToMarkdown={unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct},{character:":",before:"[ps]",after:"\\/",inConstruct:"phrasing",notInConstruct}]};function enterLiteralAutolinkValue(token){this.config.enter.autolinkProtocol.call(this,token)}function findUrl(_,protocol,domain,path,match){let prefix="";if(!previous(match))return!1;if(/^w/i.test(protocol)&&(domain=protocol+domain,protocol="",prefix="http://"),!function(domain){const parts=domain.split(".");return!(parts.length<2||parts[parts.length-1]&&(/_/.test(parts[parts.length-1])||!/[a-zA-Z\d]/.test(parts[parts.length-1]))||parts[parts.length-2]&&(/_/.test(parts[parts.length-2])||!/[a-zA-Z\d]/.test(parts[parts.length-2])))}(domain))return!1;const parts=function(url){const trailExec=/[!"&'),.:;<>?\]}]+$/.exec(url);let closingParenIndex,openingParens,closingParens,trail;if(trailExec)for(url=url.slice(0,trailExec.index),trail=trailExec[0],closingParenIndex=trail.indexOf(")"),openingParens=ccount(url,"("),closingParens=ccount(url,")");-1!==closingParenIndex&&openingParens>closingParens;)url+=trail.slice(0,closingParenIndex+1),trail=trail.slice(closingParenIndex+1),closingParenIndex=trail.indexOf(")"),closingParens++;return[url,trail]}(domain+path);if(!parts[0])return!1;const result={type:"link",title:null,url:prefix+protocol+parts[0],children:[{type:"text",value:protocol+parts[0]}]};return parts[1]?[result,{type:"text",value:parts[1]}]:result}function findEmail(_,atext,label,match){return!(!previous(match,!0)||/[_-\d]$/.test(label))&&{type:"link",title:null,url:"mailto:"+atext+"@"+label,children:[{type:"text",value:atext+"@"+label}]}}function previous(match,email){const code=match.input.charCodeAt(match.index-1);return(0===match.index||unicodeWhitespace(code)||unicodePunctuation(code))&&(!email||47!==code)}function gfmFootnoteToMarkdown(){return footnoteReference.peek=function(){return"["},{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:function(node,_,context,safeOptions){const tracker=track(safeOptions);let value=tracker.move("[^");const exit=context.enter("footnoteDefinition"),subexit=context.enter("label");return value+=tracker.move(safe(context,association(node),{...tracker.current(),before:value,after:"]"})),subexit(),value+=tracker.move("]:"+(node.children&&node.children.length>0?" ":"")),tracker.shift(4),value+=tracker.move(indentLines(containerFlow(node,context,tracker.current()),(function(line,index,blank){return index?(blank?"":"    ")+line:line}))),exit(),value},footnoteReference}};function footnoteReference(node,_,context,safeOptions){const tracker=track(safeOptions);let value=tracker.move("[^");const exit=context.enter("footnoteReference"),subexit=context.enter("reference");return value+=tracker.move(safe(context,association(node),{...tracker.current(),before:value,after:"]"})),subexit(),exit(),value+=tracker.move("]"),value}}const gfmStrikethroughFromMarkdown={canContainEols:["delete"],enter:{strikethrough:function(token){this.enter({type:"delete",children:[]},token)}},exit:{strikethrough:function(token){this.exit(token)}}},gfmStrikethroughToMarkdown={unsafe:[{character:"~",inConstruct:"phrasing"}],handlers:{delete:handleDelete}};function handleDelete(node,_,context,safeOptions){const tracker=track(safeOptions),exit=context.enter("emphasis");let value=tracker.move("~~");return value+=containerPhrasing(node,context,{...tracker.current(),before:value,after:"~"}),value+=tracker.move("~~"),exit(),value}function defaultStringLength(value){return value.length}function toAlignment(value){const code="string"==typeof value?value.codePointAt(0):0;return 67===code||99===code?99:76===code||108===code?108:82===code||114===code?114:0}handleDelete.peek=function(){return"~"};const gfmTableFromMarkdown={enter:{table:function(token){const align=token._align;this.enter({type:"table",align:align.map((d=>"none"===d?null:d)),children:[]},token),this.setData("inTable",!0)},tableData:enterCell,tableHeader:enterCell,tableRow:function(token){this.enter({type:"tableRow",children:[]},token)}},exit:{codeText:function(token){let value=this.resume();this.getData("inTable")&&(value=value.replace(/\\([\\|])/g,replace)),this.stack[this.stack.length-1].value=value,this.exit(token)},table:function(token){this.exit(token),this.setData("inTable")},tableData:exit,tableHeader:exit,tableRow:exit}};function exit(token){this.exit(token)}function enterCell(token){this.enter({type:"tableCell",children:[]},token)}function replace($0,$1){return"|"===$1?$1:$0}function gfmTableToMarkdown(options){const settings=options||{},padding=settings.tableCellPadding,alignDelimiters=settings.tablePipeAlign,stringLength=settings.stringLength,around=padding?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[\t :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:function(node,_,context,safeOptions){return serializeData(function(node,context,safeOptions){const children=node.children;let index=-1;const result=[],subexit=context.enter("table");for(;++index<children.length;)result[index]=handleTableRowAsData(children[index],context,safeOptions);return subexit(),result}(node,context,safeOptions),node.align)},tableRow:function(node,_,context,safeOptions){const value=serializeData([handleTableRowAsData(node,context,safeOptions)]);return value.slice(0,value.indexOf("\n"))},tableCell:handleTableCell,inlineCode:function(node,parent,context){let value=inlineCode(node,0,context);return context.stack.includes("tableCell")&&(value=value.replace(/\|/g,"\\$&")),value}}};function handleTableCell(node,_,context,safeOptions){const exit=context.enter("tableCell"),subexit=context.enter("phrasing"),value=containerPhrasing(node,context,{...safeOptions,before:around,after:around});return subexit(),exit(),value}function serializeData(matrix,align){return function(table,options={}){const align=(options.align||[]).concat(),stringLength=options.stringLength||defaultStringLength,alignments=[],cellMatrix=[],sizeMatrix=[],longestCellByColumn=[];let mostCellsPerRow=0,rowIndex=-1;for(;++rowIndex<table.length;){const row=[],sizes=[];let columnIndex=-1;for(table[rowIndex].length>mostCellsPerRow&&(mostCellsPerRow=table[rowIndex].length);++columnIndex<table[rowIndex].length;){const cell=null==(value=table[rowIndex][columnIndex])?"":String(value);if(!1!==options.alignDelimiters){const size=stringLength(cell);sizes[columnIndex]=size,(void 0===longestCellByColumn[columnIndex]||size>longestCellByColumn[columnIndex])&&(longestCellByColumn[columnIndex]=size)}row.push(cell)}cellMatrix[rowIndex]=row,sizeMatrix[rowIndex]=sizes}var value;let columnIndex=-1;if("object"==typeof align&&"length"in align)for(;++columnIndex<mostCellsPerRow;)alignments[columnIndex]=toAlignment(align[columnIndex]);else{const code=toAlignment(align);for(;++columnIndex<mostCellsPerRow;)alignments[columnIndex]=code}columnIndex=-1;const row=[],sizes=[];for(;++columnIndex<mostCellsPerRow;){const code=alignments[columnIndex];let before="",after="";99===code?(before=":",after=":"):108===code?before=":":114===code&&(after=":");let size=!1===options.alignDelimiters?1:Math.max(1,longestCellByColumn[columnIndex]-before.length-after.length);const cell=before+"-".repeat(size)+after;!1!==options.alignDelimiters&&(size=before.length+size+after.length,size>longestCellByColumn[columnIndex]&&(longestCellByColumn[columnIndex]=size),sizes[columnIndex]=size),row[columnIndex]=cell}cellMatrix.splice(1,0,row),sizeMatrix.splice(1,0,sizes),rowIndex=-1;const lines=[];for(;++rowIndex<cellMatrix.length;){const row=cellMatrix[rowIndex],sizes=sizeMatrix[rowIndex];columnIndex=-1;const line=[];for(;++columnIndex<mostCellsPerRow;){const cell=row[columnIndex]||"";let before="",after="";if(!1!==options.alignDelimiters){const size=longestCellByColumn[columnIndex]-(sizes[columnIndex]||0),code=alignments[columnIndex];114===code?before=" ".repeat(size):99===code?size%2?(before=" ".repeat(size/2+.5),after=" ".repeat(size/2-.5)):(before=" ".repeat(size/2),after=before):after=" ".repeat(size)}!1===options.delimiterStart||columnIndex||line.push("|"),!1===options.padding||!1===options.alignDelimiters&&""===cell||!1===options.delimiterStart&&!columnIndex||line.push(" "),!1!==options.alignDelimiters&&line.push(before),line.push(cell),!1!==options.alignDelimiters&&line.push(after),!1!==options.padding&&line.push(" "),!1===options.delimiterEnd&&columnIndex===mostCellsPerRow-1||line.push("|")}lines.push(!1===options.delimiterEnd?line.join("").replace(/ +$/,""):line.join(""))}return lines.join("\n")}(matrix,{align,alignDelimiters,padding,stringLength})}function handleTableRowAsData(node,context,safeOptions){const children=node.children;let index=-1;const result=[],subexit=context.enter("tableRow");for(;++index<children.length;)result[index]=handleTableCell(children[index],0,context,safeOptions);return subexit(),result}}const gfmTaskListItemFromMarkdown={exit:{taskListCheckValueChecked:exitCheck,taskListCheckValueUnchecked:exitCheck,paragraph:function(token){const parent=this.stack[this.stack.length-2],node=this.stack[this.stack.length-1],siblings=parent.children,head=node.children[0];let firstParaghraph,index=-1;if(parent&&"listItem"===parent.type&&"boolean"==typeof parent.checked&&head&&"text"===head.type){for(;++index<siblings.length;){const sibling=siblings[index];if("paragraph"===sibling.type){firstParaghraph=sibling;break}}firstParaghraph===node&&(head.value=head.value.slice(1),0===head.value.length?node.children.shift():node.position&&head.position&&"number"==typeof head.position.start.offset&&(head.position.start.column++,head.position.start.offset++,node.position.start=Object.assign({},head.position.start)))}this.exit(token)}}},gfmTaskListItemToMarkdown={unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:function(node,parent,context,safeOptions){const head=node.children[0],checkable="boolean"==typeof node.checked&&head&&"paragraph"===head.type,checkbox="["+(node.checked?"x":" ")+"] ",tracker=track(safeOptions);checkable&&tracker.move(checkbox);let value=listItem(node,parent,context,{...safeOptions,...tracker.current()});return checkable&&(value=value.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,(function($0){return $0+checkbox}))),value}}};function exitCheck(token){this.stack[this.stack.length-2].checked="taskListCheckValueChecked"===token.type}function remarkGfm(options={}){const data=this.data();function add(field,value){(data[field]?data[field]:data[field]=[]).push(value)}add("micromarkExtensions",function(options){return combineExtensions([gfmAutolinkLiteral,{document:{91:{tokenize:tokenizeDefinitionStart,continuation:{tokenize:tokenizeDefinitionContinuation},exit:gfmFootnoteDefinitionEnd}},text:{91:{tokenize:tokenizeGfmFootnoteCall},93:{add:"after",tokenize:tokenizePotentialGfmFootnoteCall,resolveTo:resolveToPotentialGfmFootnoteCall}}},gfmStrikethrough(options),gfmTable,gfmTaskListItem])}(options)),add("fromMarkdownExtensions",[gfmAutolinkLiteralFromMarkdown,{enter:{gfmFootnoteDefinition:function(token){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},token)},gfmFootnoteDefinitionLabelString:function(){this.buffer()},gfmFootnoteCall:function(token){this.enter({type:"footnoteReference",identifier:"",label:""},token)},gfmFootnoteCallString:function(){this.buffer()}},exit:{gfmFootnoteDefinition:function(token){this.exit(token)},gfmFootnoteDefinitionLabelString:function(token){const label=this.resume(),node=this.stack[this.stack.length-1];node.label=label,node.identifier=normalizeIdentifier(this.sliceSerialize(token)).toLowerCase()},gfmFootnoteCall:function(token){this.exit(token)},gfmFootnoteCallString:function(token){const label=this.resume(),node=this.stack[this.stack.length-1];node.label=label,node.identifier=normalizeIdentifier(this.sliceSerialize(token)).toLowerCase()}}},gfmStrikethroughFromMarkdown,gfmTableFromMarkdown,gfmTaskListItemFromMarkdown]),add("toMarkdownExtensions",function(options){return{extensions:[gfmAutolinkLiteralToMarkdown,gfmFootnoteToMarkdown(),gfmStrikethroughToMarkdown,gfmTableToMarkdown(options),gfmTaskListItemToMarkdown]}}(options))}var MDAstTypes;function getPositions(type,text){const ast=function(text){return remark().use(remarkGfm).parse(text)}(text),positions=[];return visit(ast,type,(node=>{positions.push(node.position)})),positions.sort(((a,b)=>b.start.offset-a.start.offset)),positions}function makeEmphasisOrBoldConsistent(text,style,type){const positions=getPositions(type,text);if(0===positions.length)return text;let indicator="";if("underscore"===style)indicator="_";else if("asterisk"===style)indicator="*";else{const firstPosition=positions[positions.length-1];indicator=text.substring(firstPosition.start.offset,firstPosition.start.offset+1)}"strong"===type&&(indicator+=indicator);for(const position of positions){const newContent=indicator+text.substring(position.start.offset+indicator.length,position.end.offset-indicator.length)+indicator;text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset,position.end.offset,newContent)}return text}function addTwoSpacesAtEndOfLinesFollowedByAnotherLineOfTextContent(text){const positions=getPositions(MDAstTypes.Paragraph,text);if(0===positions.length)return text;for(const position of positions){const paragraphLines=text.substring(position.start.offset,position.end.offset).split("\n"),lastLineIndex=paragraphLines.length-1;if(!(lastLineIndex<1)){for(let i=0;i<lastLineIndex;i++){const paragraphLine=paragraphLines[i].trimEnd();paragraphLine.endsWith("<br>")||paragraphLine.endsWith("<br/>")||(paragraphLines[i]=paragraphLine+"  ")}text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset,position.end.offset,paragraphLines.join("\n"))}}return text}function makeSureThereIsOnlyOneBlankLineBeforeAndAfterParagraphs(text){const hasTrailingLineBreak=text.endsWith("\n"),positions=getPositions(MDAstTypes.Paragraph,text);if(0===positions.length)return text;for(const position of positions){let startIndex=position.start.offset;for(startIndex>0&&startIndex--;startIndex>=0&&"\n"!=text.charAt(startIndex);)startIndex--;startIndex++;const paragraphLines=text.substring(startIndex,position.end.offset).split("\n"),firstLine=paragraphLines[0].trimStart();if(firstLine.startsWith("> ")||firstLine.startsWith(">\t")||firstLine.startsWith("- ")||firstLine.startsWith("-\t")||firstLine.match(/^[0-9]+\.( |\t)+/))continue;const lineCount=paragraphLines.length,newParagraphLines=[];let nextLineIsSameParagraph=!1;for(let i=0;i<lineCount;i++){const paragraphLine=paragraphLines[i];nextLineIsSameParagraph?newParagraphLines[newParagraphLines.length-1]+="\n"+paragraphLine:newParagraphLines.push(paragraphLine),nextLineIsSameParagraph=paragraphLine.endsWith("<br>")||paragraphLine.endsWith("<br/>")||paragraphLine.endsWith("  ")}for(;startIndex>0&&"\n"==text.charAt(startIndex-1);)startIndex--;const textLength=text.length;let endIndex=position.end.offset;for(endIndex<textLength&&endIndex++;endIndex<textLength&&"\n"==text.charAt(endIndex);)endIndex++;let startNewLines="\n\n";0==startIndex&&(startNewLines="");let endNewLines="\n\n";endIndex==textLength&&(endNewLines=""),text=replaceTextBetweenStartAndEndWithNewValue(text,startIndex,endIndex,startNewLines+newParagraphLines.join("\n\n")+endNewLines)}return hasTrailingLineBreak&&!text.endsWith("\n")&&(text+="\n"),text}function textMatches(expectedText,actualText,requireSameTrailingWhitespace){return requireSameTrailingWhitespace?expectedText==actualText:null!=actualText.match(new RegExp("^"+function(string){return string.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(expectedText)+"( |\\t)*$","m"))}function makeSureContentHasEmptyLinesAddedBeforeAndAfter(text,start,end){var _a;const content=text.substring(start,end);let startOfLine="",requireSameTrailingWhitespace=!0,contentPriorToContent=text.substring(0,start);if(contentPriorToContent.length>0){const contentLinesPriorToContent=contentPriorToContent.split("\n");startOfLine=null!==(_a=contentLinesPriorToContent[contentLinesPriorToContent.length-1])&&void 0!==_a?_a:"",requireSameTrailingWhitespace=""==startOfLine.trim(),requireSameTrailingWhitespace||(startOfLine=startOfLine.trimEnd());let numberOfIndexesToRemove=0;for(;contentLinesPriorToContent.length-(2+numberOfIndexesToRemove)>=0&&textMatches(startOfLine,contentLinesPriorToContent[contentLinesPriorToContent.length-(2+numberOfIndexesToRemove)],requireSameTrailingWhitespace);)numberOfIndexesToRemove++;contentLinesPriorToContent.splice(contentLinesPriorToContent.length-(1+numberOfIndexesToRemove),numberOfIndexesToRemove),contentLinesPriorToContent.length>1&&!textMatches(startOfLine,contentLinesPriorToContent[contentLinesPriorToContent.length-2],requireSameTrailingWhitespace)&&contentLinesPriorToContent.splice(contentLinesPriorToContent.length-1,0,startOfLine),contentPriorToContent=contentLinesPriorToContent.join("\n")}let contentAfterContent=text.substring(end);if(contentAfterContent.length>0){const contentLinesAfterBlock=contentAfterContent.split("\n");let numberOfIndexesToRemove=0;for(;numberOfIndexesToRemove+1<contentLinesAfterBlock.length&&textMatches(startOfLine,contentLinesAfterBlock[1+numberOfIndexesToRemove],requireSameTrailingWhitespace);)numberOfIndexesToRemove++;contentLinesAfterBlock.splice(1,numberOfIndexesToRemove),contentLinesAfterBlock.length>1&&!textMatches(startOfLine,contentLinesAfterBlock[1],requireSameTrailingWhitespace)&&contentLinesAfterBlock.splice(1,0,startOfLine),contentAfterContent=contentLinesAfterBlock.join("\n")}return contentPriorToContent+content+contentAfterContent}!function(MDAstTypes){MDAstTypes.Link="link",MDAstTypes.Footnote="footnoteDefinition",MDAstTypes.Paragraph="paragraph",MDAstTypes.Italics="emphasis",MDAstTypes.Bold="strong",MDAstTypes.ListItem="listItem",MDAstTypes.Code="code",MDAstTypes.Table="table",MDAstTypes.Image="image",MDAstTypes.List="list",MDAstTypes.Blockquote="blockquote",MDAstTypes.HorizontalRule="thematicBreak"}(MDAstTypes||(MDAstTypes={}));const IgnoreTypes={code:{replaceAction:MDAstTypes.Code,placeholder:"{CODE_BLOCK_PLACEHOLDER}"},image:{replaceAction:MDAstTypes.Image,placeholder:"{IMAGE_PLACEHOLDER}"},thematicBreak:{replaceAction:MDAstTypes.HorizontalRule,placeholder:"{HORIZONTAL_RULE_PLACEHOLDER}"},italics:{replaceAction:MDAstTypes.Italics,placeholder:"{ITALICS_PLACEHOLDER}"},bold:{replaceAction:MDAstTypes.Bold,placeholder:"{STRONG_PLACEHOLDER}"},list:{replaceAction:MDAstTypes.List,placeholder:"{LIST_PLACEHOLDER}"},blockquote:{replaceAction:MDAstTypes.Blockquote,placeholder:"{BLOCKQUOTE_PLACEHOLDER}"},table:{replaceAction:MDAstTypes.Table,placeholder:"{TABLE_PLACEHOLDER}"},yaml:{replaceAction:yamlRegex,placeholder:escapeDollarSigns("---\n---")},wikiLink:{replaceAction:wikiLinkRegex,placeholder:"{WIKI_LINK_PLACEHOLDER}"},tag:{replaceAction:/(?:\s|^)#[^\s#]{1,}/g,placeholder:"#tag-placeholder"},obsidianMultiLineComments:{replaceAction:/^%%\n[^%]*\n%%/gm,placeholder:"{OBSIDIAN_COMMENT_PLACEHOLDER}"},link:{replaceAction:function(text,regularLinkPlaceholder){const positions=getPositions(MDAstTypes.Link,text),replacedRegularLinks=[];for(const position of positions){if(null==position)continue;const regularLink=text.substring(position.start.offset,position.end.offset);regularLink.match(genericLinkRegex)&&(replacedRegularLinks.push(regularLink),text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset,position.end.offset,regularLinkPlaceholder))}return replacedRegularLinks.reverse(),{newText:text,replacedValues:replacedRegularLinks}},placeholder:"{REGULAR_LINK_PLACEHOLDER}"}};function ignoreListOfTypes(ignoreTypes,text,func){let setOfPlaceholders=[];for(const ignoreType of ignoreTypes){let ignoredResult;"string"==typeof ignoreType.replaceAction?ignoredResult=replaceMdastType(text,ignoreType.placeholder,ignoreType.replaceAction):ignoreType.replaceAction instanceof RegExp?ignoredResult=replaceRegex(text,ignoreType.placeholder,ignoreType.replaceAction):"function"==typeof ignoreType.replaceAction&&(ignoredResult=(0,ignoreType.replaceAction)(text,ignoreType.placeholder)),text=ignoredResult.newText,setOfPlaceholders.push({replacedValues:ignoredResult.replacedValues,placeholder:ignoreType.placeholder})}return text=func(text),setOfPlaceholders=setOfPlaceholders.reverse(),null!=setOfPlaceholders&&setOfPlaceholders.length>0&&setOfPlaceholders.forEach((replacedInfo=>{replacedInfo.replacedValues.forEach((replacedValue=>{text=text.replace(new RegExp(replacedInfo.placeholder,"i"),escapeDollarSigns(replacedValue))}))})),text}function replaceMdastType(text,placeholder,type){const positions=getPositions(type,text),replacedValues=[];for(const position of positions){const valueToReplace=text.substring(position.start.offset,position.end.offset);replacedValues.push(valueToReplace),text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset,position.end.offset,placeholder)}return replacedValues.reverse(),{newText:text,replacedValues}}function replaceRegex(text,placeholder,regex){const regexMatches=text.match(regex),textMatches=[];if(regex.flags.includes("g")){if(text=text.replaceAll(regex,placeholder),regexMatches)for(const matchText of regexMatches)textMatches.push(matchText)}else text=text.replace(regex,placeholder),regexMatches&&textMatches.push(regexMatches[0]);return{newText:text,replacedValues:textMatches}}class CapitalizeHeadingsOptions{constructor(){this.style="Title Case",this.ignoreWords=["macOS","iOS","iPhone","iPad","JavaScript","TypeScript","AppleScript"],this.lowercaseWords=["via","a","an","the","and","or","but","for","nor","so","yet","at","by","in","of","on","to","up","as","is","if","it","for","to","with","without","into","onto","per"],this.ignoreCasedWords=!0}}let CapitalizeHeadings=class extends RuleBuilder{get OptionsClass(){return CapitalizeHeadingsOptions}get name(){return"Capitalize Headings"}get description(){return"Headings should be formatted with capitalization"}get type(){return RuleType.HEADING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{const lines=text.split("\n");for(let i=0;i<lines.length;i++)if(lines[i].match(headerRegex))switch(options.style){case"Title Case":{const headerWords=lines[i].match(/\S+/g),keepCasing=options.ignoreWords,ignoreShortWords=options.lowercaseWords;let firstWord=!0;for(let j=1;j<headerWords.length;j++)headerWords[j].match(/^[\p{L}'-]+[.?!,:;]?$/u)&&(options.ignoreCasedWords&&headerWords[j]!==headerWords[j].toLowerCase()||keepCasing.includes(headerWords[j])||(headerWords[j]=headerWords[j].toLowerCase(),ignoreShortWords.includes(headerWords[j])&&!0!==firstWord||(headerWords[j]=headerWords[j][0].toUpperCase()+headerWords[j].slice(1))),firstWord=!1);lines[i]=lines[i].replace(headerRegex,escapeDollarSigns(`${headerWords.join(" ")}`));break}case"ALL CAPS":lines[i]=lines[i].toUpperCase();break;case"First letter":lines[i]=lines[i].toLowerCase().replace(/^#*\s+([^\p{L}])*([\p{L}])/u,(string=>string.toUpperCase()))}return lines.join("\n")}))}get exampleBuilders(){return[new ExampleBuilder({description:"With `Title Case=true`, `Ignore Cased Words=false`",before:dedent`
          # this is a heading 1
          ## THIS IS A HEADING 2
          ### a heading 3
        `,after:dedent`
          # This is a Heading 1
          ## This is a Heading 2
          ### A Heading 3
        `,options:{style:"Title Case",ignoreCasedWords:!1}}),new ExampleBuilder({description:"With `Title Case=true`, `Ignore Cased Words=true`",before:dedent`
          # this is a heading 1
          ## THIS IS A HEADING 2
          ### a hEaDiNg 3
        `,after:dedent`
          # This is a Heading 1
          ## THIS IS A HEADING 2
          ### A hEaDiNg 3
        `,options:{style:"Title Case",ignoreCasedWords:!0}}),new ExampleBuilder({description:"With `First letter=true`",before:dedent`
          # this is a heading 1
          ## this is a heading 2
        `,after:dedent`
          # This is a heading 1
          ## This is a heading 2
        `,options:{style:"First letter"}}),new ExampleBuilder({description:"With `ALL CAPS=true`",before:dedent`
          # this is a heading 1
          ## this is a heading 2
        `,after:dedent`
          # THIS IS A HEADING 1
          ## THIS IS A HEADING 2
        `,options:{style:"ALL CAPS"}})]}get optionBuilders(){return[new DropdownOptionBuilder({OptionsClass:CapitalizeHeadingsOptions,name:"Style",description:"The style of capitalization to use",optionsKey:"style",records:[{value:"Title Case",description:"Capitalize Using Title Case Rules"},{value:"ALL CAPS",description:"CAPITALIZE THE WHOLE TITLE"},{value:"First letter",description:"Only capitalize the first letter"}]}),new BooleanOptionBuilder({OptionsClass:CapitalizeHeadingsOptions,name:"Ignore Cased Words",description:"Only apply title case style to words that are all lowercase",optionsKey:"ignoreCasedWords"}),new TextAreaOptionBuilder({OptionsClass:CapitalizeHeadingsOptions,name:"Ignore Words",description:"A comma separated list of words to ignore when capitalizing",optionsKey:"ignoreWords",splitter:wordSplitterRegex,separator:", "}),new TextAreaOptionBuilder({OptionsClass:CapitalizeHeadingsOptions,name:"Lowercase Words",description:"A comma separated list of words to keep lowercase",optionsKey:"lowercaseWords",splitter:wordSplitterRegex,separator:", "})]}};CapitalizeHeadings=__decorate([RuleBuilder.register],CapitalizeHeadings);class CompactYamlOptions{constructor(){this.innerNewLines=!1}}let CompactYaml=class extends RuleBuilder{get OptionsClass(){return CompactYamlOptions}get name(){return"Compact YAML"}get description(){return"Removes leading and trailing blank lines in the YAML front matter."}get type(){return RuleType.SPACING}apply(text,options){return formatYAML(text,(text=>(text=(text=text.replace(/^---\n+/,"---\n")).replace(/\n+---/,"\n---"),options.innerNewLines&&(text=text.replaceAll(/\n{2,}/g,"\n")),text)))}get exampleBuilders(){return[new ExampleBuilder({description:"Remove blank lines at the start and end of the YAML",before:dedent`
          ---
          ${""}
          date: today
          ${""}
          title: unchanged without inner new lines turned on
          ${""}
          ---
        `,after:dedent`
          ---
          date: today
          ${""}
          title: unchanged without inner new lines turned on
          ---
        `}),new ExampleBuilder({description:"Remove blank lines anywhere in YAML with inner new lines set to true",before:dedent`
          ---
          ${""}
          date: today
          ${""}
          ${""}
          title: remove inner new lines
          ${""}
          ---
          ${""}
          # Header 1
          ${""}
          ${""}
          Body content here.
        `,after:dedent`
          ---
          date: today
          title: remove inner new lines
          ---
          ${""}
          # Header 1
          ${""}
          ${""}
          Body content here.
        `,options:{innerNewLines:!0}})]}get optionBuilders(){return[new BooleanOptionBuilder({OptionsClass:CompactYamlOptions,name:"Inner New Lines",description:"Remove new lines that are not at the start or the end of the YAML",optionsKey:"innerNewLines"})]}};CompactYaml=__decorate([RuleBuilder.register],CompactYaml);class ConsecutiveBlankLinesOptions{}let ConsecutiveBlankLines=class extends RuleBuilder{get OptionsClass(){return ConsecutiveBlankLinesOptions}get name(){return"Consecutive blank lines"}get description(){return"There should be at most one consecutive blank line."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replace(/\n{2,}/g,"\n\n")))}get exampleBuilders(){return[new ExampleBuilder({description:"",before:dedent`
          Some text
          ${""}
          ${""}
          Some more text
        `,after:dedent`
          Some text
          ${""}
          Some more text
        `})]}get optionBuilders(){return[]}};ConsecutiveBlankLines=__decorate([RuleBuilder.register],ConsecutiveBlankLines);class ConvertBulletListMarkersOptions{}let ConvertBulletListMarkers=class extends RuleBuilder{get OptionsClass(){return ConvertBulletListMarkersOptions}get name(){return"Convert Bullet List Markers"}get description(){return"Converts common bullet list marker symbols to markdown list markers."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replace(/^([^\S\n]*)([â€¢Â§])([^\S\n]*)/gm,"$1-$3")))}get exampleBuilders(){return[new ExampleBuilder({description:"Converts â€¢",before:dedent`
          â€¢ item 1
          â€¢ item 2
        `,after:dedent`
          - item 1
          - item 2
        `}),new ExampleBuilder({description:"Converts Â§",before:dedent`
          â€¢ item 1
            Â§ item 2
            Â§ item 3
        `,after:dedent`
          - item 1
            - item 2
            - item 3
        `})]}get optionBuilders(){return[]}};ConvertBulletListMarkers=__decorate([RuleBuilder.register],ConvertBulletListMarkers);class ConvertSpacesToTabsOptions{constructor(){this.tabsize=4}}let ConvertSpacesToTabs=class extends RuleBuilder{get OptionsClass(){return ConvertSpacesToTabsOptions}get name(){return"Convert Spaces to Tabs"}get description(){return"Converts leading spaces to tabs."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{const tabsize=String(options.tabsize),tabsize_regex=new RegExp("^(\t*) {"+String(tabsize)+"}","gm");for(;null!=text.match(tabsize_regex);)text=text.replace(tabsize_regex,"$1\t");return text}))}get exampleBuilders(){return[new ExampleBuilder({description:"Converting spaces to tabs with `tabsize = 3`",before:dedent`
          - text with no indention
             - text indented with 3 spaces
          - text with no indention
                - text indented with 6 spaces
        `,after:dedent`
          - text with no indention
          \t- text indented with 3 spaces
          - text with no indention
          \t\t- text indented with 6 spaces
        `,options:{tabsize:3}})]}get optionBuilders(){return[new NumberOptionBuilder({OptionsClass:ConvertSpacesToTabsOptions,name:"Tabsize",description:"Number of spaces that will be converted to a tab",optionsKey:"tabsize"})]}};ConvertSpacesToTabs=__decorate([RuleBuilder.register],ConvertSpacesToTabs);class EmphasisStyleOptions{constructor(){this.style="consistent"}}let EmphasisStyle=class extends RuleBuilder{get OptionsClass(){return EmphasisStyleOptions}get name(){return"Emphasis Style"}get description(){return"Makes sure the emphasis style is consistent."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>makeEmphasisOrBoldConsistent(text,options.style,MDAstTypes.Italics)))}get exampleBuilders(){return[new ExampleBuilder({description:"Emphasis indicators should use underscores when style is set to 'underscore'",before:dedent`
          # Emphasis Cases
          ${""}
          *Test emphasis*
          * Test not emphasized *
          This is *emphasized* mid sentence
          This is *emphasized* mid sentence with a second *emphasis* on the same line
          This is ***bold and emphasized***
          This is ***nested bold** and ending emphasized*
          This is ***nested emphasis* and ending bold**
          ${""}
          **Test bold**
          ${""}
          * List Item1 with *emphasized text*
          * List Item2
        `,after:dedent`
          # Emphasis Cases
          ${""}
          _Test emphasis_
          * Test not emphasized *
          This is _emphasized_ mid sentence
          This is _emphasized_ mid sentence with a second _emphasis_ on the same line
          This is _**bold and emphasized**_
          This is _**nested bold** and ending emphasized_
          This is **_nested emphasis_ and ending bold**
          ${""}
          **Test bold**
          ${""}
          * List Item1 with _emphasized text_
          * List Item2
        `,options:{style:"underscore"}}),new ExampleBuilder({description:"Emphasis indicators should use asterisks when style is set to 'asterisk'",before:dedent`
          # Emphasis Cases
          ${""}
          _Test emphasis_
          _ Test not emphasized _
          This is _emphasized_ mid sentence
          This is _emphasized_ mid sentence with a second _emphasis_ on the same line
          This is ___bold and emphasized___
          This is ___nested bold__ and ending emphasized_
          This is ___nested emphasis_ and ending bold__
          ${""}
          __Test bold__
        `,after:dedent`
          # Emphasis Cases
          ${""}
          *Test emphasis*
          _ Test not emphasized _
          This is *emphasized* mid sentence
          This is *emphasized* mid sentence with a second *emphasis* on the same line
          This is *__bold and emphasized__*
          This is *__nested bold__ and ending emphasized*
          This is __*nested emphasis* and ending bold__
          ${""}
          __Test bold__
        `,options:{style:"asterisk"}}),new ExampleBuilder({description:"Emphasis indicators should use consistent style based on first emphasis indicator in a file when style is set to 'consistent'",before:dedent`
          # Emphasis First Emphasis Is an Asterisk
          ${""}
          *First emphasis*
          This is _emphasized_ mid sentence
          This is *emphasized* mid sentence with a second _emphasis_ on the same line
          This is *__bold and emphasized__*
          This is *__nested bold__ and ending emphasized*
          This is **_nested emphasis_ and ending bold**
          ${""}
          __Test bold__
        `,after:dedent`
          # Emphasis First Emphasis Is an Asterisk
          ${""}
          *First emphasis*
          This is *emphasized* mid sentence
          This is *emphasized* mid sentence with a second *emphasis* on the same line
          This is *__bold and emphasized__*
          This is *__nested bold__ and ending emphasized*
          This is ***nested emphasis* and ending bold**
          ${""}
          __Test bold__
        `,options:{style:"consistent"}}),new ExampleBuilder({description:"Emphasis indicators should use consistent style based on first emphasis indicator in a file when style is set to 'consistent'",before:dedent`
          # Emphasis First Emphasis Is an Underscore
          ${""}
          **_First emphasis_**
          This is _emphasized_ mid sentence
          This is *emphasized* mid sentence with a second _emphasis_ on the same line
          This is *__bold and emphasized__*
          This is _**nested bold** and ending emphasized_
          This is __*nested emphasis* and ending bold__
          ${""}
          __Test bold__
        `,after:dedent`
          # Emphasis First Emphasis Is an Underscore
          ${""}
          **_First emphasis_**
          This is _emphasized_ mid sentence
          This is _emphasized_ mid sentence with a second _emphasis_ on the same line
          This is ___bold and emphasized___
          This is _**nested bold** and ending emphasized_
          This is ___nested emphasis_ and ending bold__
          ${""}
          __Test bold__
        `,options:{style:"consistent"}})]}get optionBuilders(){return[new DropdownOptionBuilder({OptionsClass:EmphasisStyleOptions,name:"Style",description:"The style used to denote emphasized content",optionsKey:"style",records:[{value:"consistent",description:"Makes sure the first instance of emphasis is the style that will be used throughout the document"},{value:"asterisk",description:"Makes sure * is the emphasis indicator"},{value:"underscore",description:"Makes sure _ is the emphasis indicator"}]})]}};EmphasisStyle=__decorate([RuleBuilder.register],EmphasisStyle);class EmptyLineAroundCodeFencesOptions{}let EmptyLineAroundCodeFences=class extends RuleBuilder{get OptionsClass(){return EmptyLineAroundCodeFencesOptions}get name(){return"Empty Line Around Code Fences"}get description(){return"Ensures that there is an empty line around code fences unless they start or end a document."}get type(){return RuleType.SPACING}apply(text,options){return function(text){const positions=getPositions(MDAstTypes.Code,text);for(const position of positions)text.substring(position.start.offset,position.end.offset).startsWith("```")&&(text=makeSureContentHasEmptyLinesAddedBeforeAndAfter(text,position.start.offset,position.end.offset));return text}(text)}get exampleBuilders(){return[new ExampleBuilder({description:"Fenced code blocks that start a document do not get an empty line before them.",before:dedent`
          \`\`\` js
          var temp = 'text';
          // this is a code block
          \`\`\`
          Text after code block.
        `,after:dedent`
          \`\`\` js
          var temp = 'text';
          // this is a code block
          \`\`\`
          ${""}
          Text after code block.
        `}),new ExampleBuilder({description:"Fenced code blocks that end a document do not get an empty line after them.",before:dedent`
          # Heading 1
          \`\`\`
          Here is a code block
          \`\`\`
        `,after:dedent`
          # Heading 1
          ${""}
          \`\`\`
          Here is a code block
          \`\`\`
        `}),new ExampleBuilder({description:"Fenced code blocks that are in a blockquote have the proper empty line added",before:dedent`
          # Make sure that code blocks in blockquotes are accounted for correctly
          > \`\`\`js
          > var text = 'this is some text';
          > \`\`\`
          >
          > \`\`\`js
          > var other text = 'this is more text';
          > \`\`\`
          ${""}
          **Note that the blanks blockquote lines added do not have whitespace after them**
          ${""}
          # Doubly nested code block
          ${""}
          > > \`\`\`js
          > > var other text = 'this is more text';
          > > \`\`\`
        `,after:dedent`
          # Make sure that code blocks in blockquotes are accounted for correctly
          >
          > \`\`\`js
          > var text = 'this is some text';
          > \`\`\`
          >
          > \`\`\`js
          > var other text = 'this is more text';
          > \`\`\`
          >
          ${""}
          **Note that the blanks blockquote lines added do not have whitespace after them**
          ${""}
          # Doubly nested code block
          ${""}
          > >
          > > \`\`\`js
          > > var other text = 'this is more text';
          > > \`\`\`
        `}),new ExampleBuilder({description:"Nested fenced code blocks get empty lines added around them",before:dedent`
          \`\`\`markdown
          # Header
          ${""}
          \`\`\`\`JavaScript
          var text = 'some string';
          \`\`\`\`
          \`\`\`
        `,after:dedent`
          \`\`\`markdown
          # Header
          ${""}
          \`\`\`\`JavaScript
          var text = 'some string';
          \`\`\`\`
          ${""}
          \`\`\`
        `})]}get optionBuilders(){return[]}};EmptyLineAroundCodeFences=__decorate([RuleBuilder.register],EmptyLineAroundCodeFences);class EmptyLineAroundTablesOptions{}let EmptyLineAroundTables=class extends RuleBuilder{get OptionsClass(){return EmptyLineAroundTablesOptions}get name(){return"Empty Line Around Tables"}get description(){return"Ensures that there is an empty line around github flavored tables unless they start or end a document."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.yaml,IgnoreTypes.code],text,(text=>function(text){const positions=getPositions(MDAstTypes.Table,text);for(const position of positions)text=makeSureContentHasEmptyLinesAddedBeforeAndAfter(text,position.start.offset,position.end.offset);return text}(text)))}get exampleBuilders(){return[new ExampleBuilder({description:"Tables that start a document do not get an empty line before them.",before:dedent`
          | Column 1 | Column 2 |
          |----------|----------|
          | foo      | bar      |
          | baz      | qux      |
          | quux     | quuz     |
          More text.
          # Heading
          ${""}
          **Note that text directly following a table is considered part of a table according to github markdown**
        `,after:dedent`
          | Column 1 | Column 2 |
          |----------|----------|
          | foo      | bar      |
          | baz      | qux      |
          | quux     | quuz     |
          More text.
          ${""}
          # Heading
          ${""}
          **Note that text directly following a table is considered part of a table according to github markdown**
        `}),new ExampleBuilder({description:"Tables that end a document do not get an empty line after them.",before:dedent`
          # Heading 1
          | Column 1 | Column 2 |
          |----------|----------|
          | foo      | bar      |
          | baz      | qux      |
          | quux     | quuz     |
        `,after:dedent`
          # Heading 1
          ${""}
          | Column 1 | Column 2 |
          |----------|----------|
          | foo      | bar      |
          | baz      | qux      |
          | quux     | quuz     |
        `}),new ExampleBuilder({description:"Tables that are not at the start or the end of the document will have an empty line added before and after them",before:dedent`
          # Table 1
          | Column 1 | Column 2 | Column 3 |
          |----------|----------|----------|
          | foo      | bar      | blob     |
          | baz      | qux      | trust    |
          | quux     | quuz     | glob     |
          # Table 2 without Pipe at Start and End
          | Column 1 | Column 2 |
          :-: | -----------:
          bar | baz
          foo | bar
          # Header for more content
          New paragraph.
        `,after:dedent`
          # Table 1
          ${""}
          | Column 1 | Column 2 | Column 3 |
          |----------|----------|----------|
          | foo      | bar      | blob     |
          | baz      | qux      | trust    |
          | quux     | quuz     | glob     |
          ${""}
          # Table 2 without Pipe at Start and End
          ${""}
          | Column 1 | Column 2 |
          :-: | -----------:
          bar | baz
          foo | bar
          ${""}
          # Header for more content
          New paragraph.
        `}),new ExampleBuilder({description:"Tables in callouts or blockquotes have the appropriately formatted blank lines added",before:dedent`
          > Table in blockquote
          > | Column 1 | Column 2 | Column 3 |
          > |----------|----------|----------|
          > | foo      | bar      | blob     |
          > | baz      | qux      | trust    |
          > | quux     | quuz     | glob     |
          ${""}
          More content here
          ${""}
          > Table doubly nested in blockquote
          > > | Column 1 | Column 2 | Column 3 |
          > > |----------|----------|----------|
          > > | foo      | bar      | blob     |
          > > | baz      | qux      | trust    |
          > > | quux     | quuz     | glob     |
        `,after:dedent`
          > Table in blockquote
          >
          > | Column 1 | Column 2 | Column 3 |
          > |----------|----------|----------|
          > | foo      | bar      | blob     |
          > | baz      | qux      | trust    |
          > | quux     | quuz     | glob     |
          >
          ${""}
          More content here
          ${""}
          > Table doubly nested in blockquote
          > >
          > > | Column 1 | Column 2 | Column 3 |
          > > |----------|----------|----------|
          > > | foo      | bar      | blob     |
          > > | baz      | qux      | trust    |
          > > | quux     | quuz     | glob     |
        `})]}get optionBuilders(){return[]}};EmptyLineAroundTables=__decorate([RuleBuilder.register],EmptyLineAroundTables);class EscapeYamlSpecialCharactersOptions{constructor(){this.defaultEscapeCharacter='"',this.tryToEscapeSingleLineArrays=!1}}let EscapeYamlSpecialCharacters=class extends RuleBuilder{get OptionsClass(){return EscapeYamlSpecialCharactersOptions}get name(){return"Escape YAML Special Characters"}get description(){return"Escapes colons with a space after them (: ), single quotes ('), and double quotes (\") in YAML."}get type(){return RuleType.YAML}apply(text,options){return formatYAML(text,(text=>{const yamlLines=text.split("\n"),yamlLineCount=yamlLines.length;if(yamlLineCount<1)return text;const escapeSubstringIfNecessary=function(fullText,substring){if((value=substring).length>1&&(value.startsWith("'")&&value.endsWith("'")||value.startsWith('"')&&value.endsWith('"')))return fullText;var value;const substringHasSingleQuote=substring.includes("'"),substringHasDoubleQuote=substring.includes('"'),substringHasColonWithSpaceAfterIt=substring.includes(": ");if(!substringHasSingleQuote&&!substringHasDoubleQuote&&!substringHasColonWithSpaceAfterIt)return fullText;if(substringHasSingleQuote&&substringHasDoubleQuote)return fullText;let newText;return newText=substringHasSingleQuote?fullText.replace(substring,`"${substring}"`):substringHasDoubleQuote?fullText.replace(substring,`'${substring}'`):fullText.replace(substring,`${options.defaultEscapeCharacter}${substring}${options.defaultEscapeCharacter}`),newText};for(let i=0;i<yamlLineCount;i++){const line=yamlLines[i].trim(),firstColonIndex=line.indexOf(":"),isKeyValueLineWithoutValue=firstColonIndex<0||firstColonIndex+1>=line.length,startsWithDash=line.startsWith("-"),isArrayItemLineWithoutValue=startsWithDash&&line.length<2;if(isKeyValueLineWithoutValue&&isArrayItemLineWithoutValue)continue;let valueStartIndex=1;startsWithDash||(valueStartIndex+=firstColonIndex);const value=line.substring(valueStartIndex).trim();if(value.startsWith("[")){if(options.tryToEscapeSingleLineArrays){if(value.length<3)continue;const arrayItems=value.substring(1,value.length-1).split(","),numberOfArrayItems=arrayItems.length;for(let j=0;j<numberOfArrayItems;j++){let arrayItem=arrayItems[j].trim();arrayItem.startsWith("[")&&(arrayItem=arrayItem.substring(1).trimStart()),arrayItem.endsWith("]")&&(arrayItem=arrayItem.substring(0,arrayItem.length-1).trimEnd()),arrayItems[j]=escapeSubstringIfNecessary(arrayItems[j],arrayItem)}yamlLines[i]=yamlLines[i].replace(value,"["+arrayItems.join(",")+"]")}}else yamlLines[i]=escapeSubstringIfNecessary(yamlLines[i],value)}return yamlLines.join("\n")}))}get exampleBuilders(){return[new ExampleBuilder({description:"YAML without anything to escape",before:dedent`
          ---
          key: value
          otherKey: []
          ---
        `,after:dedent`
          ---
          key: value
          otherKey: []
          ---
        `}),new ExampleBuilder({description:"YAML with unescaped values",before:dedent`
          ---
          key: value: with colon in the middle
          secondKey: value with ' a single quote present
          thirdKey: "already escaped: value"
          fourthKey: value with " a double quote present
          fifthKey: value with both ' " a double and single quote present is not escaped, but is invalid YAML
          sixthKey: colon:between characters is fine
          otherKey: []
          ---
        `,after:dedent`
          ---
          key: "value: with colon in the middle"
          secondKey: "value with ' a single quote present"
          thirdKey: "already escaped: value"
          fourthKey: 'value with " a double quote present'
          fifthKey: value with both ' " a double and single quote present is not escaped, but is invalid YAML
          sixthKey: colon:between characters is fine
          otherKey: []
          ---
        `}),new ExampleBuilder({description:"YAML with unescaped values in an expanded list with `Default Escape Character = '`",before:dedent`
          ---
          key:
            - value: with colon in the middle
            - value with ' a single quote present
            - 'already escaped: value'
            - value with " a double quote present
            - value with both ' " a double and single quote present is not escaped, but is invalid YAML
            - colon:between characters is fine
          ---
        `,after:dedent`
          ---
          key:
            - 'value: with colon in the middle'
            - "value with ' a single quote present"
            - 'already escaped: value'
            - 'value with " a double quote present'
            - value with both ' " a double and single quote present is not escaped, but is invalid YAML
            - colon:between characters is fine
          ---
        `,options:{defaultEscapeCharacter:"'"}}),new ExampleBuilder({description:"YAML with unescaped values with arrays",before:dedent`
          ---
          array: [value: with colon in the middle, value with ' a single quote present, "already escaped: value", value with " a double quote present, value with both ' " a double and single quote present is not escaped but is invalid YAML, colon:between characters is fine]
          nestedArray: [[value: with colon in the middle, value with ' a single quote present], ["already escaped: value", value with " a double quote present], value with both ' " a double and single quote present is not escaped but is invalid YAML, colon:between characters is fine]
          nestedArray2: [[value: with colon in the middle], value with ' a single quote present]
          ---
          ${""}
          _Note that escaped commas in a YAML array will be treated as a separator._
        `,after:dedent`
          ---
          array: ["value: with colon in the middle", "value with ' a single quote present", "already escaped: value", 'value with " a double quote present', value with both ' " a double and single quote present is not escaped but is invalid YAML, colon:between characters is fine]
          nestedArray: [["value: with colon in the middle", "value with ' a single quote present"], ["already escaped: value", 'value with " a double quote present'], value with both ' " a double and single quote present is not escaped but is invalid YAML, colon:between characters is fine]
          nestedArray2: [["value: with colon in the middle"], "value with ' a single quote present"]
          ---
          ${""}
          _Note that escaped commas in a YAML array will be treated as a separator._
        `,options:{tryToEscapeSingleLineArrays:!0}})]}get optionBuilders(){return[new DropdownOptionBuilder({OptionsClass:EscapeYamlSpecialCharactersOptions,name:"Default Escape Character",description:"The default character to use to escape YAML values when a single quote and double quote are not present.",optionsKey:"defaultEscapeCharacter",records:[{value:'"',description:"Use a double quote to escape if no single or double quote is present"},{value:"'",description:"Use a single quote to escape if no single or double quote is present"}]}),new BooleanOptionBuilder({OptionsClass:EscapeYamlSpecialCharactersOptions,name:"Try to Escape Single Line Arrays",description:'Tries to escape array values assuming that an array starts with "[", ends with "]", and has items that are delimited by ",".',optionsKey:"tryToEscapeSingleLineArrays"})]}get hasSpecialExecutionOrder(){return!0}};EscapeYamlSpecialCharacters=__decorate([RuleBuilder.register],EscapeYamlSpecialCharacters);var EscapeYamlSpecialCharacters$1=EscapeYamlSpecialCharacters;class FileNameHeadingOptions{}let FileNameHeading=class extends RuleBuilder{get OptionsClass(){return FileNameHeadingOptions}get name(){return"File Name Heading"}get description(){return"Inserts the file name as a H1 heading if no H1 heading exists."}get type(){return RuleType.HEADING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{if(text.match(/^#\s.*/m))return text;const fileName=options.fileName;let yaml_end=text.indexOf("\n---");return yaml_end=-1!=yaml_end&&text.startsWith("---\n")?yaml_end+5:0,insert(text,yaml_end,`# ${fileName}\n`)}))}get exampleBuilders(){return[new ExampleBuilder({description:"Inserts an H1 heading",before:dedent`
          This is a line of text
        `,after:dedent`
          # File Name
          This is a line of text
        `,options:{fileName:"File Name"}}),new ExampleBuilder({description:"Inserts heading after YAML front matter",before:dedent`
          ---
          title: My Title
          ---
          This is a line of text
        `,after:dedent`
          ---
          title: My Title
          ---
          # File Name
          This is a line of text
        `,options:{fileName:"File Name"}})]}get optionBuilders(){return[]}};FileNameHeading=__decorate([RuleBuilder.register],FileNameHeading);class FootnoteAfterPunctuationOptions{}let FootnoteAfterPunctuation=class extends RuleBuilder{get OptionsClass(){return FootnoteAfterPunctuationOptions}get name(){return"Footnote after Punctuation"}get description(){return"Ensures that footnote references are placed after punctuation, not before."}get type(){return RuleType.FOOTNOTE}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replace(/(?!^)(\[\^\w+\]) ?([,.;!:?])/gm,"$2$1")))}get exampleBuilders(){return[new ExampleBuilder({description:"Placing footnotes after punctuation.",before:dedent`
          Lorem[^1]. Ipsum[^2], doletes.
        `,after:dedent`
          Lorem.[^1] Ipsum,[^2] doletes.
        `})]}get optionBuilders(){return[]}};FootnoteAfterPunctuation=__decorate([RuleBuilder.register],FootnoteAfterPunctuation);class FormatTagsInYamlOptions{}let FormatTagsInYaml=class extends RuleBuilder{get OptionsClass(){return FormatTagsInYamlOptions}get name(){return"Format Tags in YAML"}get description(){return"Remove Hashtags from tags in the YAML frontmatter, as they make the tags there invalid."}get type(){return RuleType.YAML}apply(text,options){return formatYAML(text,(text=>text.replace(/\ntags:(.*?)(?=\n(?:[A-Za-z-]+?:|---))/s,(function(tagsYAML){return tagsYAML.replaceAll("#","")}))))}get exampleBuilders(){return[new ExampleBuilder({description:"Format Tags in YAML frontmatter",before:dedent`
          ---
          tags: #one #two #three #nested/four/five
          ---
        `,after:dedent`
          ---
          tags: one two three nested/four/five
          ---
        `}),new ExampleBuilder({description:"Format tags in array",before:dedent`
          ---
          tags: [#one #two #three]
          ---
        `,after:dedent`
          ---
          tags: [one two three]
          ---
        `}),new ExampleBuilder({description:"Format tags in list",before:dedent`
          ---
          tags:
          - #tag1
          - #tag2
          ---
        `,after:dedent`
          ---
          tags:
          - tag1
          - tag2
          ---
        `})]}get optionBuilders(){return[]}get hasSpecialExecutionOrder(){return!0}};FormatTagsInYaml=__decorate([RuleBuilder.register],FormatTagsInYaml);var FormatTagsInYaml$1=FormatTagsInYaml;class FormatYamlArrayOptions{constructor(){this.aliasArrayStyle="single-line",this.formatAliasKey=!0,this.tagArrayStyle="single-line",this.formatTagKey=!0,this.defaultArrayStyle="single-line",this.formatArrayKeys=!0,this.forceSingleLineArrayStyle=[],this.forceMultiLineArrayStyle=[]}}let RuleTemplate=class extends RuleBuilder{get OptionsClass(){return FormatYamlArrayOptions}get name(){return"Format Yaml Array"}get description(){return"Allows for the formatting of regular yaml arrays as either multi-line or single-line and `tags` and `aliases` are allowed to have some Obsidian specific yaml formats. Note that single string to single-line goes from a single string entry to a single-line array if more than 1 entry is present. The same is true for single string to multi-line except it becomes a multi-line array."}get type(){return RuleType.YAML}apply(text,options){return formatYAML(text,(text=>{const yaml=loadYAML(text.replace("---\n","").replace("\n---",""));if(!yaml)return text;var value,date;if(options.formatAliasKey&&Object.keys(yaml).includes("aliases")&&(text=setYamlSection(text,"aliases",formatYamlArrayValue("string"==typeof(value=splitValueIfSingleOrMultilineArray(getYamlSectionValue(text,"aliases")))?value.split(", "):value,options.aliasArrayStyle))),options.formatTagKey&&Object.keys(yaml).includes("tags")&&(text=setYamlSection(text,"tags",formatYamlArrayValue(function(value){return"string"==typeof value?value.includes(",")?value.split(", "):value.split(" "):value}(splitValueIfSingleOrMultilineArray(getYamlSectionValue(text,"tags"))),options.tagArrayStyle))),options.formatArrayKeys){const keysToIgnore=["aliases","tags",...options.forceMultiLineArrayStyle,...options.forceSingleLineArrayStyle];for(const key of Object.keys(yaml))!keysToIgnore.includes(key)&&"object"==typeof yaml[key]&&(!(date=yaml[key])||"[object Date]"!==Object.prototype.toString.call(date)||isNaN(date))&&yaml[key]&&(text=setYamlSection(text,key,formatYamlArrayValue(splitValueIfSingleOrMultilineArray(getYamlSectionValue(text,key)),options.defaultArrayStyle)))}for(const singleLineArrayKey of options.forceSingleLineArrayStyle)Object.keys(yaml).includes(singleLineArrayKey)&&(text=setYamlSection(text,singleLineArrayKey,formatYamlArrayValue(splitValueIfSingleOrMultilineArray(getYamlSectionValue(text,singleLineArrayKey)),"single-line")));for(const multiLineArrayKey of options.forceMultiLineArrayStyle)Object.keys(yaml).includes(multiLineArrayKey)&&(text=setYamlSection(text,multiLineArrayKey,formatYamlArrayValue(splitValueIfSingleOrMultilineArray(getYamlSectionValue(text,multiLineArrayKey)),"multi-line")));return text}))}get exampleBuilders(){return[new ExampleBuilder({description:"Format tags as a single-line array delimited by spaces and aliases as a multi-line array and format the key `test` to be a single-line array",before:dedent`
          ---
          tags:
            - computer
            - research
          aliases: Title 1, Title2
          test: this is a value
          ---
          ${""}
          # Notes:
          ${""}
          Nesting yaml arrays may result in unexpected results.
          ${""}
          Multi-line arrays will have empty values removed only leaving one if it is completely empty. The same is not true for single-line arrays as that is invalid yaml unless it comes as the last entry in the array.
        `,after:dedent`
          ---
          tags: [computer, research]
          aliases:
            - Title 1
            - Title2
          test: [this is a value]
          ---
          ${""}
          # Notes:
          ${""}
          Nesting yaml arrays may result in unexpected results.
          ${""}
          Multi-line arrays will have empty values removed only leaving one if it is completely empty. The same is not true for single-line arrays as that is invalid yaml unless it comes as the last entry in the array.
        `,options:{aliasArrayStyle:"multi-line",forceSingleLineArrayStyle:["test"]}}),new ExampleBuilder({description:"Format tags as a single string with space delimiters, ignore aliases, and format regular yaml arrays as single-line arrays",before:dedent`
          ---
          aliases: Typescript
          types:
            - thought provoking
            - peer reviewed
          tags: [computer, science, trajectory]
          ---
        `,after:dedent`
          ---
          aliases: Typescript
          types: [thought provoking, peer reviewed]
          tags: computer science trajectory
          ---
        `,options:{formatAliasKey:!1,tagArrayStyle:"single string space delimited"}})]}get optionBuilders(){return[new DropdownOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Yaml aliases section style",description:"The style of the yaml aliases section",optionsKey:"aliasArrayStyle",records:[{value:"multi-line",description:"```aliases:\\n  - Title```"},{value:"single-line",description:"```aliases: [Title]```"},{value:"single string comma delimited",description:"```aliases: Title, Other Title```"},{value:"single string to single-line",description:"Aliases will be formatted as a string if there is 1 or fewer elements like so ```aliases: Title```. If there is more than 1 element, it will be formatted like a single-line array."},{value:"single string to multi-line",description:"Aliases will be formatted as a string if there is 1 or fewer elements like so ```aliases: Title```. If there is more than 1 element, it will be formatted like a multi-line array."}]}),new BooleanOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Format yaml aliases section",description:"Turns on formatting for the yaml aliases section. You should not enable this option alongside the rule `YAML Title Alias` as they may not work well together or they may have different format styles selected causing unexpected results.",optionsKey:"formatAliasKey"}),new DropdownOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Yaml tags section style",description:"The style of the yaml tags section",optionsKey:"tagArrayStyle",records:[{value:"multi-line",description:"```tags:\\n  - tag1```"},{value:"single-line",description:"```tags: [tag1]```"},{value:"single string to single-line",description:"Tags will be formatted as a string if there is 1 or fewer elements like so ```tags: tag1```. If there is more than 1 element, it will be formatted like a single-line array."},{value:"single string to multi-line",description:"Aliases will be formatted as a string if there is 1 or fewer elements like so ```tags: tag1```. If there is more than 1 element, it will be formatted like a multi-line array."},{value:"single-line space delimited",description:"```tags: [tag1 tag2]```"},{value:"single string space delimited",description:"```tags: tag1 tag2```"},{value:"single string comma delimited",description:"```tags: tag1, tag2```"}]}),new DropdownOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Default yaml array section style",description:"The style of other yaml arrays that are not `tags`, `aliases` or  in `Force key values to be single-line arrays` and `Force key values to be multi-line arrays`",optionsKey:"defaultArrayStyle",records:[{value:"multi-line",description:"```key:\\n  - value```"},{value:"single-line",description:"```key: [value]```"}]}),new BooleanOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Format yaml array sections",description:"Turns on formatting for regular yaml arrays",optionsKey:"formatArrayKeys"}),new TextAreaOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Force key values to be single-line arrays",description:"Forces the yaml array for the new line separated keys to be in single-line format (leave empty to disable this option)",optionsKey:"forceSingleLineArrayStyle"}),new TextAreaOptionBuilder({OptionsClass:FormatYamlArrayOptions,name:"Force key values to be multi-line arrays",description:"Forces the yaml array for the new line separated keys to be in multi-line format (leave empty to disable this option)",optionsKey:"forceMultiLineArrayStyle"})]}};RuleTemplate=__decorate([RuleBuilder.register],RuleTemplate);class HeaderIncrementOptions{}let HeaderIncrement=class extends RuleBuilder{get OptionsClass(){return HeaderIncrementOptions}get name(){return"Header Increment"}get description(){return"Heading levels should only increment by one level at a time"}get type(){return RuleType.HEADING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{const lines=text.split("\n");let lastLevel=0,decrement=0;for(let i=0;i<lines.length;i++){const match=lines[i].match(headerRegex);if(!match)continue;let level=match[2].length-decrement;level>lastLevel+1?(decrement+=level-(lastLevel+1),level=lastLevel+1):level<lastLevel&&(decrement-=lastLevel+decrement-match[2].length,decrement<=0&&(level=match[2].length,decrement=0)),lines[i]=lines[i].replace(headerRegex,`$1${"#".repeat(level)}$3$4`),lastLevel=level}return lines.join("\n")}))}get exampleBuilders(){return[new ExampleBuilder({description:"",before:dedent`
          # H1
          ### H3
          ### H3
          #### H4
          ###### H6
          ${""}
          We skipped a 2nd level heading
        `,after:dedent`
          # H1
          ## H3
          ## H3
          ### H4
          #### H6
          ${""}
          We skipped a 2nd level heading
        `}),new ExampleBuilder({description:"Skipped headings in sections that would be decremented will result in those headings not having the same meaning",before:dedent`
          # H1
          ### H3
          ${""}
          We skip from 1 to 3
          ${""}
          ####### H7
          ${""}
          We skip from 3 to 7 leaving out 4, 5, and 6. Thus headings level 4, 5, and 6 will be treated like H3 above until another H2 or H1 is encountered
          ${""}
          ###### H6
          ${""}
          We skipped 6 previously so it will be treated the same as the H3 above since it was the next lowest header that was to be decremented
          ${""}
          ## H2
          ${""}
          This resets the decrement section so the H6 below is decremented to an H3
          ${""}
          ###### H6
        `,after:dedent`
          # H1
          ## H3
          ${""}
          We skip from 1 to 3
          ${""}
          ### H7
          ${""}
          We skip from 3 to 7 leaving out 4, 5, and 6. Thus headings level 4, 5, and 6 will be treated like H3 above until another H2 or H1 is encountered
          ${""}
          ## H6
          ${""}
          We skipped 6 previously so it will be treated the same as the H3 above since it was the next lowest header that was to be decremented
          ${""}
          ## H2
          ${""}
          This resets the decrement section so the H6 below is decremented to an H3
          ${""}
          ### H6
        `})]}get optionBuilders(){return[]}};HeaderIncrement=__decorate([RuleBuilder.register],HeaderIncrement);class HeadingBlankLinesOptions{constructor(){this.bottom=!0,this.emptyLineAfterYaml=!0}}let HeadingBlankLines=class extends RuleBuilder{get OptionsClass(){return HeadingBlankLinesOptions}get name(){return"Heading blank lines"}get description(){return"All headings have a blank line both before and after (except where the heading is at the beginning or end of the document)."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>(text=(text=(text=options.bottom?(text=(text=text.replace(/^(#+\s.*)/gm,"\n\n$1\n\n")).replace(/\n+(#+\s.*)/g,"\n\n$1")).replace(/(^#+\s.*)\n+/gm,"$1\n\n"):(text=text.replace(/(^#+\s.*)\n+/gm,"$1\n")).replace(/\n+(#+\s.*)/g,"\n\n$1")).replace(/^\n+(#+\s.*)/,"$1")).replace(/(#+\s.*)\n+$/,"$1"),options.emptyLineAfterYaml||(text=text.replace(new RegExp("("+yamlRegex.source+")\\n+(#+\\s.*)"),"$1\n$5")),text)))}get exampleBuilders(){return[new ExampleBuilder({description:"Headings should be surrounded by blank lines",before:dedent`
          # H1
          ## H2
          ${""}
          ${""}
          # H1
          line
          ## H2
          ${""}
        `,after:dedent`
          # H1
          ${""}
          ## H2
          ${""}
          # H1
          ${""}
          line
          ${""}
          ## H2
        `}),new ExampleBuilder({description:"With `Bottom=false`",before:dedent`
          # H1
          line
          ## H2
          # H1
          line
        `,after:dedent`
          # H1
          line
          ${""}
          ## H2
          ${""}
          # H1
          line
        `,options:{bottom:!1,emptyLineAfterYaml:!0}}),new ExampleBuilder({description:"Empty line before header and after Yaml is removed with `Empty Line Between Yaml and Header=true`",before:dedent`
          ---
          key: value
          ---
          # Header
          Paragraph here...
        `,after:dedent`
          ---
          key: value
          ---
          # Header

          Paragraph here...
        `,options:{bottom:!0,emptyLineAfterYaml:!1}})]}get optionBuilders(){return[new BooleanOptionBuilder({OptionsClass:HeadingBlankLinesOptions,name:"Bottom",description:"Insert a blank line after headings",optionsKey:"bottom"}),new BooleanOptionBuilder({OptionsClass:HeadingBlankLinesOptions,name:"Empty Line Between Yaml and Header",description:"Keep the empty line between the Yaml frontmatter and header",optionsKey:"emptyLineAfterYaml"})]}};HeadingBlankLines=__decorate([RuleBuilder.register],HeadingBlankLines);class InsertYamlAttributesOptions{constructor(){this.textToInsert=["aliases: ","tags: "]}}let InsertYamlAttributes=class extends RuleBuilder{get OptionsClass(){return InsertYamlAttributesOptions}get name(){return"Insert YAML attributes"}get description(){return"Inserts the given YAML attributes into the YAML frontmatter. Put each attribute on a single line."}get type(){return RuleType.YAML}apply(text,options){return formatYAML(text=initYAML(text),(text=>{const insert_lines=options.textToInsert.reverse(),parsed_yaml=loadYAML(text.match(yamlRegex)[1]);for(const line of insert_lines){const key=line.split(":")[0];Object.prototype.hasOwnProperty.call(parsed_yaml,key)||(text=text.replace(/^---\n/,escapeDollarSigns(`---\n${line}\n`)))}return text}))}get exampleBuilders(){return[new ExampleBuilder({description:"Insert static lines into YAML frontmatter. Text to insert: `aliases:\ntags: doc\nanimal: dog`",before:dedent`
          ---
          animal: cat
          ---
        `,after:dedent`
          ---
          aliases:
          tags: doc
          animal: cat
          ---
        `,options:{textToInsert:["aliases:","tags: doc","animal: dog"]}})]}get optionBuilders(){return[new TextAreaOptionBuilder({OptionsClass:InsertYamlAttributesOptions,name:"Text to insert",description:"Text to insert into the YAML frontmatter",optionsKey:"textToInsert"})]}};InsertYamlAttributes=__decorate([RuleBuilder.register],InsertYamlAttributes);class LineBreakAtDocumentEndOptions{}let LineBreakAtDocumentEnd=class extends RuleBuilder{get OptionsClass(){return LineBreakAtDocumentEndOptions}get name(){return"Line Break at Document End"}get description(){return"Ensures that there is exactly one line break at the end of a document."}get type(){return RuleType.SPACING}apply(text,options){return(text=text.replace(/\n+$/g,""))+"\n"}get exampleBuilders(){return[new ExampleBuilder({description:"Appending a line break to the end of the document.",before:dedent`
          Lorem ipsum dolor sit amet, consectetur adipiscing elit.
        `,after:dedent`
          Lorem ipsum dolor sit amet, consectetur adipiscing elit.
          ${""}
        `}),new ExampleBuilder({description:"Removing trailing line breaks to the end of the document, except one.",before:dedent`
          Lorem ipsum dolor sit amet, consectetur adipiscing elit.
          ${""}
          ${""}
          ${""}
        `,after:dedent`
          Lorem ipsum dolor sit amet, consectetur adipiscing elit.
          ${""}
        `})]}get optionBuilders(){return[]}};LineBreakAtDocumentEnd=__decorate([RuleBuilder.register],LineBreakAtDocumentEnd);class MoveFootnotesToTheBottomOptions{}let MoveFootnotesToTheBottom=class extends RuleBuilder{get OptionsClass(){return MoveFootnotesToTheBottomOptions}get name(){return"Move Footnotes to the bottom"}get description(){return"Move all footnotes to the bottom of the document."}get type(){return RuleType.FOOTNOTE}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>function(text){const positions=getPositions(MDAstTypes.Footnote,text);let footnotes=[];const alreadyUsedReferencePositions=new Set,mapOfFootnoteToFootnoteReferenceIndex=new Map,referencePosition=function(footnote,startOfFootnoteReferenceSearch){const footnoteReference=footnote.match(/\[\^.*?\]/)[0];let footnoteReferenceLocation;do{footnoteReferenceLocation=text.lastIndexOf(footnoteReference,startOfFootnoteReferenceSearch),startOfFootnoteReferenceSearch=footnoteReferenceLocation}while(alreadyUsedReferencePositions.has(footnoteReferenceLocation)&&-1!==footnoteReferenceLocation);if(-1===footnoteReferenceLocation)throw new Error(`Footnote '${footnote}' has no corresponding footnote reference before the footnote contents and cannot be processed. Please make sure that all footnotes have a corresponding reference before the content of the footnote.`);return alreadyUsedReferencePositions.add(footnoteReferenceLocation),footnoteReferenceLocation};for(const position of positions){const footnote=text.substring(position.start.offset,position.end.offset);footnotes.push(footnote),position.end.offset<text.length&&"\n"===text[position.end.offset]&&(text=text.substring(0,position.end.offset)+text.substring(position.end.offset+1)),position.end.offset<text.length&&"\n"===text[position.end.offset]&&(text=text.substring(0,position.end.offset)+text.substring(position.end.offset+1)),text=text.substring(0,position.start.offset)+text.substring(position.end.offset),mapOfFootnoteToFootnoteReferenceIndex.set(footnote,referencePosition(footnote,position.start.offset))}footnotes=footnotes.sort(((f1,f2)=>mapOfFootnoteToFootnoteReferenceIndex.get(f1)-mapOfFootnoteToFootnoteReferenceIndex.get(f2))),footnotes.length>0&&(text=text.trimEnd()+"\n");for(const footnote of footnotes)text+="\n"+footnote;return text}(text)))}get exampleBuilders(){return[new ExampleBuilder({description:"Moving footnotes to the bottom",before:dedent`
          Lorem ipsum, consectetur adipiscing elit. [^1] Donec dictum turpis quis ipsum pellentesque.
          ${""}
          [^1]: first footnote
          ${""}
          Quisque lorem est, fringilla sed enim at, sollicitudin lacinia nisi.[^2]
          [^2]: second footnote
          ${""}
          Maecenas malesuada dignissim purus ac volutpat.
        `,after:dedent`
          Lorem ipsum, consectetur adipiscing elit. [^1] Donec dictum turpis quis ipsum pellentesque.
          ${""}
          Quisque lorem est, fringilla sed enim at, sollicitudin lacinia nisi.[^2]
          Maecenas malesuada dignissim purus ac volutpat.
          ${""}
          [^1]: first footnote
          [^2]: second footnote
        `})]}get optionBuilders(){return[]}};MoveFootnotesToTheBottom=__decorate([RuleBuilder.register],MoveFootnotesToTheBottom);class NoBareUrlsOptions{}let NoBareUrls=class extends RuleBuilder{get OptionsClass(){return NoBareUrlsOptions}get name(){return"No Bare URLs"}get description(){return"Encloses bare URLs with angle brackets except when enclosed in back ticks, square braces, or single or double quotes."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag,IgnoreTypes.image],text,(text=>{const URLMatches=text.match(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s`\]'">]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s`\]'">]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s`\]'">]{2,}|www\.[a-zA-Z0-9]+\.[^\s`\]'">]{2,})/gi);if(!URLMatches)return text;let startSearch=0;const numMatches=URLMatches.length;for(let i=0;i<numMatches;i++){const urlMatch=URLMatches[i],urlStart=text.indexOf(urlMatch,startSearch),urlEnd=urlStart+urlMatch.length,previousChar=0===urlStart?void 0:text.charAt(urlStart-1),nextChar=urlEnd>=text.length?void 0:text.charAt(urlEnd);if(null==previousChar||"`"!==previousChar&&'"'!==previousChar&&"'"!==previousChar&&"["!==previousChar||null==nextChar||"`"!==nextChar&&'"'!==nextChar&&"'"!==nextChar&&"]"!==nextChar)if(null==previousChar||"<"!==previousChar||null==nextChar||">"!==nextChar)text=replaceTextBetweenStartAndEndWithNewValue(text,urlStart,urlStart+urlMatch.length,"<"+urlMatch+">"),startSearch=urlStart+urlMatch.length+2;else{let startOfOpeningChevrons=urlStart-1;for(;startOfOpeningChevrons>0&&"<"===text.charAt(startOfOpeningChevrons-1);)startOfOpeningChevrons--;let endOfClosingChevrons=urlEnd;for(;endOfClosingChevrons<text.length-1&&">"===text.charAt(endOfClosingChevrons+1);)endOfClosingChevrons++;text=replaceTextBetweenStartAndEndWithNewValue(text,startOfOpeningChevrons,endOfClosingChevrons+1,"<"+urlMatch+">"),startSearch=urlStart+urlMatch.length}else startSearch=urlStart+urlMatch.length}return text}))}get exampleBuilders(){return[new ExampleBuilder({description:"Make sure that links are inside of angle brackets when not in single quotes('), double quotes(\"), or backticks(`)",before:dedent`
          https://github.com
          braces around url should stay the same: [https://github.com]
          backticks around url should stay the same: \`https://github.com\`
          Links mid-sentence should be updated like https://google.com will be.
          'https://github.com'
          "https://github.com"
          <https://github.com>
          links should stay the same: [](https://github.com)
          https://gitlab.com
        `,after:dedent`
          <https://github.com>
          braces around url should stay the same: [https://github.com]
          backticks around url should stay the same: \`https://github.com\`
          Links mid-sentence should be updated like <https://google.com> will be.
          'https://github.com'
          "https://github.com"
          <https://github.com>
          links should stay the same: [](https://github.com)
          <https://gitlab.com>
        `}),new ExampleBuilder({description:"Angle brackets are added if the url is not the only text in the single quotes('), double quotes(\"), or backticks(`)",before:dedent`
          [https://github.com some text here]
          backticks around a url should stay the same, but only if the only contents of the backticks: \`https://github.com some text here\`
          single quotes around a url should stay the same, but only if the contents of the single quotes is the url: 'https://github.com some text here'
          double quotes around a url should stay the same, but only if the contents of the double quotes is the url: "https://github.com some text here"
        `,after:dedent`
          [<https://github.com> some text here]
          backticks around a url should stay the same, but only if the only contents of the backticks: \`<https://github.com> some text here\`
          single quotes around a url should stay the same, but only if the contents of the single quotes is the url: '<https://github.com> some text here'
          double quotes around a url should stay the same, but only if the contents of the double quotes is the url: "<https://github.com> some text here"
        `}),new ExampleBuilder({description:"Multiple angle brackets at the start and or end of a url will be reduced down to 1",before:dedent`
          <<https://github.com>
          <https://google.com>>
          <<https://gitlab.com>>
        `,after:dedent`
          <https://github.com>
          <https://google.com>
          <https://gitlab.com>
        `})]}get optionBuilders(){return[]}};NoBareUrls=__decorate([RuleBuilder.register],NoBareUrls);class ParagraphBlankLinesOptions{}let ParagraphBlankLines=class extends RuleBuilder{get OptionsClass(){return ParagraphBlankLinesOptions}get name(){return"Paragraph blank lines"}get description(){return"All paragraphs should have exactly one blank line both before and after."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.obsidianMultiLineComments,IgnoreTypes.yaml],text,makeSureThereIsOnlyOneBlankLineBeforeAndAfterParagraphs)}get exampleBuilders(){return[new ExampleBuilder({description:"Paragraphs should be surrounded by blank lines",before:dedent`
          # H1
          Newlines are inserted.
          A paragraph is a line that starts with a letter.
        `,after:dedent`
          # H1
          ${""}
          Newlines are inserted.
          ${""}
          A paragraph is a line that starts with a letter.
        `})]}get optionBuilders(){return[]}};ParagraphBlankLines=__decorate([RuleBuilder.register],ParagraphBlankLines);class ProperEllipsisOptions{}let ProperEllipsis=class extends RuleBuilder{get OptionsClass(){return ProperEllipsisOptions}get name(){return"Proper Ellipsis"}get description(){return"Replaces three consecutive dots with an ellipsis."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replaceAll("...","â€¦")))}get exampleBuilders(){return[new ExampleBuilder({description:"Replacing three consecutive dots with an ellipsis.",before:dedent`
          Lorem (...) Impsum.
        `,after:dedent`
          Lorem (â€¦) Impsum.
        `})]}get optionBuilders(){return[]}};ProperEllipsis=__decorate([RuleBuilder.register],ProperEllipsis);class ReIndexFootnotesOptions{}let ReIndexFootnotes=class extends RuleBuilder{get OptionsClass(){return ReIndexFootnotesOptions}get name(){return"Re-Index Footnotes"}get description(){return"Re-indexes footnote keys and footnote, based on the order of occurrence (NOTE: This rule deliberately does *not* preserve the relation between key and footnote, to be able to re-index duplicate keys.)"}get type(){return RuleType.FOOTNOTE}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{let ft_index=0;return text=text.replace(/^\[\^\w+\]: /gm,(function(){return ft_index++,"[^"+String(ft_index)+"]: "})),ft_index=0,text.replace(/(?!^)\[\^\w+\]/gm,(function(){return ft_index++,"[^"+String(ft_index)+"]"}))}))}get exampleBuilders(){return[new ExampleBuilder({description:"Re-indexing footnotes after having deleted previous footnotes",before:dedent`
          Lorem ipsum at aliquet felis.[^3] Donec dictum turpis quis pellentesque,[^5] et iaculis tortor condimentum.
          ${""}
          [^3]: first footnote
          [^5]: second footnote
        `,after:dedent`
          Lorem ipsum at aliquet felis.[^1] Donec dictum turpis quis pellentesque,[^2] et iaculis tortor condimentum.
          ${""}
          [^1]: first footnote
          [^2]: second footnote
        `}),new ExampleBuilder({description:"Re-indexing footnotes after inserting a footnote between",before:dedent`
          Lorem ipsum dolor sit amet, consectetur adipiscing elit.[^1] Aenean at aliquet felis. Donec dictum turpis quis ipsum pellentesque, et iaculis tortor condimentum.[^1a] Vestibulum nec blandit felis, vulputate finibus purus.[^2] Praesent quis iaculis diam.
          ${""}
          [^1]: first footnote
          [^1a]: third footnote, inserted later
          [^2]: second footnotes
        `,after:dedent`
          Lorem ipsum dolor sit amet, consectetur adipiscing elit.[^1] Aenean at aliquet felis. Donec dictum turpis quis ipsum pellentesque, et iaculis tortor condimentum.[^2] Vestibulum nec blandit felis, vulputate finibus purus.[^3] Praesent quis iaculis diam.
          ${""}
          [^1]: first footnote
          [^2]: third footnote, inserted later
          [^3]: second footnotes
        `}),new ExampleBuilder({description:"Re-indexing duplicate footnote keys",before:dedent`
          Lorem ipsum at aliquet felis.[^1] Donec dictum turpis quis pellentesque,[^1] et iaculis tortor condimentum.
          ${""}
          [^1]: first footnote
          [^1]: second footnote
        `,after:dedent`
          Lorem ipsum at aliquet felis.[^1] Donec dictum turpis quis pellentesque,[^2] et iaculis tortor condimentum.
          ${""}
          [^1]: first footnote
          [^2]: second footnote
        `})]}get optionBuilders(){return[]}};ReIndexFootnotes=__decorate([RuleBuilder.register],ReIndexFootnotes);class RemoveConsecutiveListMarkersOptions{}let RemoveConsecutiveListMarkers=class extends RuleBuilder{get OptionsClass(){return RemoveConsecutiveListMarkersOptions}get name(){return"Remove Consecutive List Markers"}get description(){return"Removes consecutive list markers. Useful when copy-pasting list items."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replace(/^([ |\t]*)- - \b/gm,"$1- ")))}get exampleBuilders(){return[new ExampleBuilder({description:"Removing consecutive list markers.",before:dedent`
          - item 1
          - - copypasted item A
          - item 2
            - indented item
            - - copypasted item B
        `,after:dedent`
          - item 1
          - copypasted item A
          - item 2
            - indented item
            - copypasted item B
        `})]}get optionBuilders(){return[]}};var RemoveEmptyLinesBetweenListMarkersAndChecklists_1;RemoveConsecutiveListMarkers=__decorate([RuleBuilder.register],RemoveConsecutiveListMarkers);let RemoveEmptyLinesBetweenListMarkersAndChecklists=RemoveEmptyLinesBetweenListMarkersAndChecklists_1=class extends RuleBuilder{get OptionsClass(){return RemoveEmptyLinesBetweenListMarkersAndChecklists_1}get name(){return"Remove Empty Lines Between List Markers and Checklists"}get description(){return"There should not be any empty lines between list markers and checklists."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag,IgnoreTypes.thematicBreak],text,(text=>{const replaceEmptyLinesBetweenList=function(text,listIndicatorRegexText,replaceWith){const listRegex=new RegExp(`^${listIndicatorRegexText}\n{2,}${listIndicatorRegexText}$`,"gm");let match,newText=text;do{match=newText.match(listRegex),newText=newText.replaceAll(listRegex,replaceWith)}while(match);return newText};return text=replaceEmptyLinesBetweenList(text,"(( |\\t)*- \\[( |x)\\]( |\\t)+.+)","$1\n$5"),text=replaceEmptyLinesBetweenList(text,"(( |\\t)*\\d+\\.( |\\t)+.+)","$1\n$4"),text=replaceEmptyLinesBetweenList(text,"(( |\\t)*\\+( |\\t)+.+)","$1\n$4"),text=replaceEmptyLinesBetweenList(text,"(( |\\t)*-(?! \\[( |x)\\])( |\\t)+.+)","$1\n$5"),replaceEmptyLinesBetweenList(text,"(( |\\t)*\\*( |\\t)+.+)","$1\n$4")}))}get exampleBuilders(){return[new ExampleBuilder({description:"",before:dedent`
          1. Item 1
          ${""}
          2. Item 2
          ${""}
          - Item 1
          ${""}
          \t- Subitem 1
          ${""}
          - Item 2
          ${""}
          - [x] Item 1
          ${""}
          \t- [ ] Subitem 1
          ${""}
          - [ ] Item 2
          ${""}
          + Item 1
          ${""}
          \t+ Subitem 1
          ${""}
          + Item 2
          ${""}
          * Item 1
          ${""}
          \t* Subitem 1
          ${""}
          * Item 2
        `,after:dedent`
          1. Item 1
          2. Item 2
          ${""}
          - Item 1
          \t- Subitem 1
          - Item 2
          ${""}
          - [x] Item 1
          \t- [ ] Subitem 1
          - [ ] Item 2
          ${""}
          + Item 1
          \t+ Subitem 1
          + Item 2
          ${""}
          * Item 1
          \t* Subitem 1
          * Item 2
        `})]}get optionBuilders(){return[]}};RemoveEmptyLinesBetweenListMarkersAndChecklists=RemoveEmptyLinesBetweenListMarkersAndChecklists_1=__decorate([RuleBuilder.register],RemoveEmptyLinesBetweenListMarkersAndChecklists);class RemoveEmptyListMarkersOptions{}let RemoveEmptyListMarkers=class extends RuleBuilder{get OptionsClass(){return RemoveEmptyListMarkersOptions}get name(){return"Remove Empty List Markers"}get description(){return"Removes empty list markers, i.e. list items without content."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{const emptyListMarkerRegex=/^\s*(>\s*)*(-|\*|\+|\d+.|- (\[( |x)\]))\s*?$/gm;return(text=(text=text.replace(new RegExp(emptyListMarkerRegex.source+"\\n","gm"),"")).replace(new RegExp("\\n"+emptyListMarkerRegex.source,"gm"),"")).replace(emptyListMarkerRegex,"")}))}get exampleBuilders(){return[new ExampleBuilder({description:"Removes empty list markers.",before:dedent`
          - item 1
          -
          - item 2
          ${""}
          * list 2 item 1
              *
          * list 2 item 2
          ${""}
          + list 3 item 1
          +
          + list 3 item 2
        `,after:dedent`
          - item 1
          - item 2
          ${""}
          * list 2 item 1
          * list 2 item 2
          ${""}
          + list 3 item 1
          + list 3 item 2
        `}),new ExampleBuilder({description:"Removes empty ordered list markers.",before:dedent`
          1. item 1
          2.
          3. item 2
          ${""}
          1. list 2 item 1
          2. list 2 item 2
          3. ${""}
          ${""}
          _Note that this rule does not make sure that the ordered list is sequential after removal_
        `,after:dedent`
          1. item 1
          3. item 2
          ${""}
          1. list 2 item 1
          2. list 2 item 2
          ${""}
          _Note that this rule does not make sure that the ordered list is sequential after removal_
        `}),new ExampleBuilder({description:"Removes empty checklist markers.",before:dedent`
          - [ ]  item 1
          - [x]
          - [ ] item 2
          - [ ]   ${""}
          ${""}
          _Note that this will affect checked and uncheck checked list items_
        `,after:dedent`
          - [ ]  item 1
          - [ ] item 2
          ${""}
          _Note that this will affect checked and uncheck checked list items_
        `}),new ExampleBuilder({description:"Removes empty list, checklist, and ordered list markers in callouts/blockquotes",before:dedent`
          > Checklist in blockquote
          > - [ ]  item 1
          > - [x]
          > - [ ] item 2
          > - [ ]   ${""}
          ${""}
          > Ordered List in blockquote
          > > 1. item 1
          > > 2.
          > > 3. item 2
          > > 4.  ${""}
          ${""}
          > Regular lists in blockquote
          >
          > - item 1
          > -
          > - item 2
          >
          > List 2
          >
          > * item 1
          >     *
          > * list 2 item 2
          >
          > List 3
          >
          > + item 1
          > + 
          > + item 2
        `,after:dedent`
          > Checklist in blockquote
          > - [ ]  item 1
          > - [ ] item 2
          ${""}
          > Ordered List in blockquote
          > > 1. item 1
          > > 3. item 2
          ${""}
          > Regular lists in blockquote
          >
          > - item 1
          > - item 2
          >
          > List 2
          >
          > * item 1
          > * list 2 item 2
          >
          > List 3
          >
          > + item 1
          > + item 2
        `})]}get optionBuilders(){return[]}};RemoveEmptyListMarkers=__decorate([RuleBuilder.register],RemoveEmptyListMarkers);class RemoveHyphenatedLineBreaksOptions{}let RemoveHyphenatedLineBreaks=class extends RuleBuilder{get OptionsClass(){return RemoveHyphenatedLineBreaksOptions}get name(){return"Remove Hyphenated Line Breaks"}get description(){return"Removes hyphenated line breaks. Useful when pasting text from textbooks."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replace(/\b[-â€] \b/g,"")))}get exampleBuilders(){return[new ExampleBuilder({description:"Removing hyphenated line breaks.",before:dedent`
          This text has a linebrâ€ eak.
        `,after:dedent`
          This text has a linebreak.
        `})]}get optionBuilders(){return[]}};RemoveHyphenatedLineBreaks=__decorate([RuleBuilder.register],RemoveHyphenatedLineBreaks);class RemoveLinkSpacingOptions{}let RemoveLinkSpacing=class extends RuleBuilder{get OptionsClass(){return RemoveLinkSpacingOptions}get name(){return"Remove link spacing"}get description(){return"Removes spacing around link text."}get type(){return RuleType.SPACING}apply(text,options){return text=function(text){const positions=getPositions(MDAstTypes.Link,text);for(const position of positions){if(null==position)continue;const regularLink=text.substring(position.start.offset,position.end.offset);if(!regularLink.match(genericLinkRegex))continue;const endLinkTextPosition=regularLink.lastIndexOf("]"),newLink=regularLink.substring(0,1)+regularLink.substring(1,endLinkTextPosition).trim()+regularLink.substring(endLinkTextPosition);text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset,position.end.offset,newLink)}return text}(text),function(text){const linkMatches=text.match(wikiLinkRegex);if(linkMatches)for(const link of linkMatches)if(link.includes("|")){const startLinkTextPosition=link.indexOf("|"),newLink=link.substring(0,startLinkTextPosition+1)+link.substring(startLinkTextPosition+1,link.length-2).trim()+"]]";text=text.replace(link,newLink)}return text}(text)}get exampleBuilders(){return[new ExampleBuilder({description:"Space in regular markdown link text",before:dedent`
          [ here is link text1 ](link_here)
          [ here is link text2](link_here)
          [here is link text3 ](link_here)
          [here is link text4](link_here)
          [\there is link text5\t](link_here)
          [](link_here)
          **Note that image markdown syntax does not get affected even if it is transclusion:**
          ![\there is link text6 ](link_here)
        `,after:dedent`
          [here is link text1](link_here)
          [here is link text2](link_here)
          [here is link text3](link_here)
          [here is link text4](link_here)
          [here is link text5](link_here)
          [](link_here)
          **Note that image markdown syntax does not get affected even if it is transclusion:**
          ![\there is link text6 ](link_here)
        `}),new ExampleBuilder({description:"Space in wiki link text",before:dedent`
          [[link_here| here is link text1 ]]
          [[link_here|here is link text2 ]]
          [[link_here| here is link text3]]
          [[link_here|here is link text4]]
          [[link_here|\there is link text5\t]]
          ![[link_here|\there is link text6\t]]
          [[link_here]]
        `,after:dedent`
          [[link_here|here is link text1]]
          [[link_here|here is link text2]]
          [[link_here|here is link text3]]
          [[link_here|here is link text4]]
          [[link_here|here is link text5]]
          ![[link_here|here is link text6]]
          [[link_here]]
        `})]}get optionBuilders(){return[]}};RemoveLinkSpacing=__decorate([RuleBuilder.register],RemoveLinkSpacing);class RemoveMultipleSpacesOptions{}let RemoveMultipleSpaces=class extends RuleBuilder{get OptionsClass(){return RemoveMultipleSpacesOptions}get name(){return"Remove Multiple Spaces"}get description(){return"Removes two or more consecutive spaces. Ignores spaces at the beginning and ending of the line. "}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.table,IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>text.replace(/(?!^>)([^\s])( ){2,}([^\s])/gm,"$1 $3")))}get exampleBuilders(){return[new ExampleBuilder({description:"Removing double and triple space.",before:dedent`
          Lorem ipsum   dolor  sit amet.
        `,after:dedent`
          Lorem ipsum dolor sit amet.
        `})]}get optionBuilders(){return[]}};RemoveMultipleSpaces=__decorate([RuleBuilder.register],RemoveMultipleSpaces);class RemoveSpaceAroundFullwidthCharactersOptions{}let RemoveSpaceAroundFullwidthCharacters=class extends RuleBuilder{get OptionsClass(){return RemoveSpaceAroundFullwidthCharactersOptions}get name(){return"Remove Space around Fullwidth Characters"}get description(){return"Ensures that fullwidth characters are not followed by whitespace (either single spaces or a tab). Note that this may causes issues with markdown format in some cases."}get type(){return RuleType.SPACING}apply(text,options){const fullwidthCharacterWithTextAtStart=/([ \t])+([\u2013\u2014\u2026\u3001\u3002\u300a\u300d-\u300f\u3014\u3015\u3008-\u3011\uff00-\uffff])/g,fullwidthCharacterWithTextAtEnd=/([\u2013\u2014\u2026\u3001\u3002\u300a\u300d-\u300f\u3014\u3015\u3008-\u3011\uff00-\uffff])([ \t])+/g,replaceWhitespaceAroundFullwidthCharacters=function(text){return text.replace(fullwidthCharacterWithTextAtStart,"$2").replace(fullwidthCharacterWithTextAtEnd,"$1")};let newText=ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag,IgnoreTypes.list],text,replaceWhitespaceAroundFullwidthCharacters);return newText=function(text,func){const positions=getPositions(MDAstTypes.ListItem,text);for(const position of positions){let listText=text.substring(position.start.offset+2,position.end.offset);const listIndicatorRegex=/\n(( |\t)*>?)*(\*|-|\+|- \[( | x)\]|\d+\.) /g,matches=listText.match(listIndicatorRegex);if(matches){const listItems=listText.split(new RegExp(listIndicatorRegex.source.replaceAll("(","(?:")));let newListText="",index=0;for(const listItem of listItems)index>0&&(newListText+=matches[index-1]),newListText+=func(listItem),index++;listText=newListText}else listText=func(listText);text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset+2,position.end.offset,listText)}return text}(newText,replaceWhitespaceAroundFullwidthCharacters),newText}get exampleBuilders(){return[new ExampleBuilder({description:"Remove Spaces and Tabs around Fullwidth Characters",before:dedent`
          Full list of affected characters: ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½Žï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½šï¼Œï¼Žï¼šï¼›ï¼ï¼Ÿï¼‚ï¼‡ï½€ï¼¾ï½žï¿£ï¼¿ï¼†ï¼ ï¼ƒï¼…ï¼‹ï¼ï¼Šï¼ï¼œï¼žï¼ˆï¼‰ï¼»ï¼½ï½›ï½ï½Ÿï½ ï½œï¿¤ï¼ï¼¼ï¿¢ï¼„ï¿¡ï¿ ï¿¦ï¿¥ã€‚ã€ã€Œã€ã€Žã€ã€”ã€•ã€ã€‘â€”â€¦â€“ã€Šã€‹ã€ˆã€‰
          This is a fullwidth period\t ã€‚ with text after it.
          This is a fullwidth comma\tï¼Œ  with text after it.
          This is a fullwidth left parenthesis ï¼ˆ \twith text after it.
          This is a fullwidth right parenthesis ï¼‰  with text after it.
          This is a fullwidth colon ï¼š  with text after it.
          This is a fullwidth semicolon ï¼›  with text after it.
            ï¼²emoves space at start of line
        `,after:dedent`
          Full list of affected characters:ï¼ï¼‘ï¼’ï¼“ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½Žï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½šï¼Œï¼Žï¼šï¼›ï¼ï¼Ÿï¼‚ï¼‡ï½€ï¼¾ï½žï¿£ï¼¿ï¼†ï¼ ï¼ƒï¼…ï¼‹ï¼ï¼Šï¼ï¼œï¼žï¼ˆï¼‰ï¼»ï¼½ï½›ï½ï½Ÿï½ ï½œï¿¤ï¼ï¼¼ï¿¢ï¼„ï¿¡ï¿ ï¿¦ï¿¥ã€‚ã€ã€Œã€ã€Žã€ã€”ã€•ã€ã€‘â€”â€¦â€“ã€Šã€‹ã€ˆã€‰
          This is a fullwidth periodã€‚with text after it.
          This is a fullwidth commaï¼Œwith text after it.
          This is a fullwidth left parenthesisï¼ˆwith text after it.
          This is a fullwidth right parenthesisï¼‰with text after it.
          This is a fullwidth colonï¼šwith text after it.
          This is a fullwidth semicolonï¼›with text after it.
          ï¼²emoves space at start of line
        `}),new ExampleBuilder({description:"Fullwidth Characters in List Do not Affect List Markdown Syntax",before:dedent`
          # List indicators should not have the space after them removed if they are followed by a fullwidth character
          ${""}
          - ï¼» contents hereï¼½
            - \tï¼» more contents hereï¼½ more text here
          + \tï¼» another item hereï¼½
          * ï¼» one last item hereï¼½
          ${""}
          # Nested in a block quote
          ${""}
          > - ï¼» contents hereï¼½
          >   - \tï¼» more contents hereï¼½ more text here
          > + \tï¼» another item hereï¼½
          > * ï¼» one last item hereï¼½
          ${""}
          # Doubly nested in a block quote
          ${""}
          > The following is doubly nested
          > > - ï¼» contents hereï¼½
          > >   - \tï¼» more contents hereï¼½ more text here
          > > + \tï¼» another item hereï¼½
          > > * ï¼» one last item hereï¼½
        `,after:dedent`
          # List indicators should not have the space after them removed if they are followed by a fullwidth character
          ${""}
          - ï¼»contents hereï¼½
            - ï¼»more contents hereï¼½more text here
          + ï¼»another item hereï¼½
          * ï¼»one last item hereï¼½
          ${""}
          # Nested in a block quote
          ${""}
          > - ï¼»contents hereï¼½
          >   - ï¼»more contents hereï¼½more text here
          > + ï¼»another item hereï¼½
          > * ï¼»one last item hereï¼½
          ${""}
          # Doubly nested in a block quote
          ${""}
          > The following is doubly nested
          > > - ï¼»contents hereï¼½
          > >   - ï¼»more contents hereï¼½more text here
          > > + ï¼»another item hereï¼½
          > > * ï¼»one last item hereï¼½
        `})]}get optionBuilders(){return[]}};RemoveSpaceAroundFullwidthCharacters=__decorate([RuleBuilder.register],RemoveSpaceAroundFullwidthCharacters);class RemoveYamlKeysOptions{constructor(){this.yamlKeysToRemove=[]}}let RemoveYamlKeys=class extends RuleBuilder{get OptionsClass(){return RemoveYamlKeysOptions}get name(){return"Remove YAML Keys"}get description(){return"Removes the YAML keys specified"}get type(){return RuleType.YAML}apply(text,options){const yamlKeysToRemove=options.yamlKeysToRemove,yaml=text.match(yamlRegex);if(!yaml||0===yamlKeysToRemove.length)return text;let yamlText=yaml[1];for(const key of yamlKeysToRemove){let actualKey=key.trim();actualKey.endsWith(":")&&(actualKey=actualKey.substring(0,actualKey.length-1)),yamlText=removeYamlSection(yamlText,actualKey)}return text.replace(yaml[1],yamlText)}get exampleBuilders(){return[new ExampleBuilder({description:'Removes the values specified in `YAML Keys to Remove` = "status:\nkeywords\ndate"',before:dedent`
          ---
          language: Typescript
          type: programming
          tags: computer
          keywords:
            - keyword1
            - keyword2
          status: WIP
          date: 02/15/2022
          ---
          ${""}
          # Header Context
          ${""}
          Text
        `,after:dedent`
          ---
          language: Typescript
          type: programming
          tags: computer
          ---
          ${""}
          # Header Context
          ${""}
          Text
        `,options:{yamlKeysToRemove:["status:","keywords","date"]}})]}get optionBuilders(){return[new TextAreaOptionBuilder({OptionsClass:RemoveYamlKeysOptions,name:"YAML Keys to Remove",description:"The yaml keys to remove from the yaml frontmatter with or without colons",optionsKey:"yamlKeysToRemove"})]}};RemoveYamlKeys=__decorate([RuleBuilder.register],RemoveYamlKeys);class SpaceAfterListMarkersOptions{}let SpaceAfterListMarkers=class extends RuleBuilder{get OptionsClass(){return SpaceAfterListMarkersOptions}get name(){return"Space after list markers"}get description(){return"There should be a single space after list markers and checkboxes."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>(text=text.replace(/^(\s*\d+\.|\s*[-+*])[^\S\r\n]+/gm,"$1 ")).replace(/^(\s*\d+\.|\s*[-+*]\s+\[[ xX]\])[^\S\r\n]+/gm,"$1 ")))}get exampleBuilders(){return[new ExampleBuilder({description:"",before:dedent`
          1.   Item 1
          2.  Item 2
          ${""}
          -   [ ] Item 1
          - [x]    Item 2
          \t-  [ ] Item 3
        `,after:dedent`
          1. Item 1
          2. Item 2
          ${""}
          - [ ] Item 1
          - [x] Item 2
          \t- [ ] Item 3
        `})]}get optionBuilders(){return[]}};SpaceAfterListMarkers=__decorate([RuleBuilder.register],SpaceAfterListMarkers);class SpaceBetweenChineseAndEnglishOrNumbersOptions{}let SpaceBetweenChineseAndEnglishOrNumbers=class extends RuleBuilder{get OptionsClass(){return SpaceBetweenChineseAndEnglishOrNumbersOptions}get name(){return"Space between Chinese and English or numbers"}get description(){return"Ensures that Chinese and English or numbers are separated by a single space. Follow this [guidelines](https://github.com/sparanoid/chinese-copywriting-guidelines)"}get type(){return RuleType.SPACING}apply(text,options){const head=/([\u4e00-\u9fa5])( *)(\[[^[]*\]\(.*\)|`[^`]*`|\w+|[-+'"([{Â¥$]|\*[^*])/gm,tail=/(\[[^[]*\]\(.*\)|`[^`]*`|\w+|[-+;:'"Â°%$)\]}]|[^*]\*)( *)([\u4e00-\u9fa5])/gm,addSpaceAroundChineseAndEnglish=function(text){return text.replace(head,"$1 $3").replace(tail,"$1 $3")};let newText=ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.image,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag,IgnoreTypes.italics,IgnoreTypes.bold],text,addSpaceAroundChineseAndEnglish);return newText=function(text,func){const positions=getPositions(MDAstTypes.Italics,text);for(const position of positions){let italicText=text.substring(position.start.offset+1,position.end.offset-1);italicText=func(italicText),text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset+1,position.end.offset-1,italicText)}return text}(newText,addSpaceAroundChineseAndEnglish),newText=function(text,func){const positions=getPositions(MDAstTypes.Bold,text);for(const position of positions){let boldText=text.substring(position.start.offset+2,position.end.offset-2);boldText=func(boldText),text=replaceTextBetweenStartAndEndWithNewValue(text,position.start.offset+2,position.end.offset-2,boldText)}return text}(newText,addSpaceAroundChineseAndEnglish),newText}get exampleBuilders(){return[new ExampleBuilder({description:"Space between Chinese and English",before:dedent`
          ä¸­æ–‡å­—ç¬¦ä¸²englishä¸­æ–‡å­—ç¬¦ä¸²ã€‚
        `,after:dedent`
          ä¸­æ–‡å­—ç¬¦ä¸² english ä¸­æ–‡å­—ç¬¦ä¸²ã€‚
        `}),new ExampleBuilder({description:"Space between Chinese and link",before:dedent`
          ä¸­æ–‡å­—ç¬¦ä¸²[english](http://example.com)ä¸­æ–‡å­—ç¬¦ä¸²ã€‚
        `,after:dedent`
          ä¸­æ–‡å­—ç¬¦ä¸² [english](http://example.com) ä¸­æ–‡å­—ç¬¦ä¸²ã€‚
        `}),new ExampleBuilder({description:"Space between Chinese and inline code block",before:dedent`
          ä¸­æ–‡å­—ç¬¦ä¸²\`code\`ä¸­æ–‡å­—ç¬¦ä¸²ã€‚
        `,after:dedent`
          ä¸­æ–‡å­—ç¬¦ä¸² \`code\` ä¸­æ–‡å­—ç¬¦ä¸²ã€‚
        `}),new ExampleBuilder({description:"No space between Chinese and English in tag",before:dedent`
          #æ ‡ç­¾A #æ ‡ç­¾2æ ‡ç­¾
        `,after:dedent`
          #æ ‡ç­¾A #æ ‡ç­¾2æ ‡ç­¾
        `}),new ExampleBuilder({description:"Make sure that spaces are not added between italics and chinese characters to preserve markdown syntax",before:dedent`
          _è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼_
          *è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english*
          ${""}
          # Handling bold and italics nested in each other is not supported at this time
          ${""}
          **_è¿™æ˜¯ä¸€_ä¸ªæ•°å­¦å…¬å¼**
          *è¿™æ˜¯ä¸€hello__ä¸ªæ•°å­¦worldå…¬å¼__*
        `,after:dedent`
          _è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼_
          *è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼ english*
          ${""}
          # Handling bold and italics nested in each other is not supported at this time
          ${""}
          **_ è¿™æ˜¯ä¸€ _ ä¸ªæ•°å­¦å…¬å¼**
          *è¿™æ˜¯ä¸€ hello__ ä¸ªæ•°å­¦ world å…¬å¼ __*
        `}),new ExampleBuilder({description:"Images and links are ignored",before:dedent`
          [[è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english]]
          ![[è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english.jpg]]
          [è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english](è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english.md)
          ![è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english](è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english.jpg)
        `,after:dedent`
          [[è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english]]
          ![[è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english.jpg]]
          [è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english](è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english.md)
          ![è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english](è¿™æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼english.jpg)
        `})]}get optionBuilders(){return[]}};SpaceBetweenChineseAndEnglishOrNumbers=__decorate([RuleBuilder.register],SpaceBetweenChineseAndEnglishOrNumbers);class StrongStyleOptions{constructor(){this.style="consistent"}}let StrongStyle=class extends RuleBuilder{get OptionsClass(){return StrongStyleOptions}get name(){return"Strong Style"}get description(){return"Makes sure the strong style is consistent."}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>makeEmphasisOrBoldConsistent(text,options.style,MDAstTypes.Bold)))}get exampleBuilders(){return[new ExampleBuilder({description:"Strong indicators should use underscores when style is set to 'underscore'",before:dedent`
          # Strong/Bold Cases
          ${""}
          **Test bold**
          ** Test not bold **
          This is **bold** mid sentence
          This is **bold** mid sentence with a second **bold** on the same line
          This is ***bold and emphasized***
          This is ***nested bold** and ending emphasized*
          This is ***nested emphasis* and ending bold**
          ${""}
          *Test emphasis*
          ${""}
          * List Item1 with **bold text**
          * List Item2
        `,after:dedent`
          # Strong/Bold Cases
          ${""}
          __Test bold__
          ** Test not bold **
          This is __bold__ mid sentence
          This is __bold__ mid sentence with a second __bold__ on the same line
          This is *__bold and emphasized__*
          This is *__nested bold__ and ending emphasized*
          This is __*nested emphasis* and ending bold__
          ${""}
          *Test emphasis*
          ${""}
          * List Item1 with __bold text__
          * List Item2
        `,options:{style:"underscore"}}),new ExampleBuilder({description:"Strong indicators should use asterisks when style is set to 'asterisk'",before:dedent`
          # Strong/Bold Cases
          ${""}
          __Test bold__
          __ Test not bold __
          This is __bold__ mid sentence
          This is __bold__ mid sentence with a second __bold__ on the same line
          This is ___bold and emphasized___
          This is ___nested bold__ and ending emphasized_
          This is ___nested emphasis_ and ending bold__
          ${""}
          _Test emphasis_
        `,after:dedent`
          # Strong/Bold Cases
          ${""}
          **Test bold**
          __ Test not bold __
          This is **bold** mid sentence
          This is **bold** mid sentence with a second **bold** on the same line
          This is _**bold and emphasized**_
          This is _**nested bold** and ending emphasized_
          This is **_nested emphasis_ and ending bold**
          ${""}
          _Test emphasis_
        `,options:{style:"asterisk"}}),new ExampleBuilder({description:"Strong indicators should use consistent style based on first strong indicator in a file when style is set to 'consistent'",before:dedent`
          # Strong First Strong Is an Asterisk
          ${""}
          **First bold**
          This is __bold__ mid sentence
          This is __bold__ mid sentence with a second **bold** on the same line
          This is ___bold and emphasized___
          This is *__nested bold__ and ending emphasized*
          This is **_nested emphasis_ and ending bold**
          ${""}
          __Test bold__
        `,after:dedent`
          # Strong First Strong Is an Asterisk
          ${""}
          **First bold**
          This is **bold** mid sentence
          This is **bold** mid sentence with a second **bold** on the same line
          This is _**bold and emphasized**_
          This is ***nested bold** and ending emphasized*
          This is **_nested emphasis_ and ending bold**
          ${""}
          **Test bold**
        `,options:{style:"consistent"}}),new ExampleBuilder({description:"Strong indicators should use consistent style based on first strong indicator in a file when style is set to 'consistent'",before:dedent`
          # Strong First Strong Is an Underscore
          ${""}
          __First bold__
          This is **bold** mid sentence
          This is **bold** mid sentence with a second __bold__ on the same line
          This is **_bold and emphasized_**
          This is ***nested bold** and ending emphasized*
          This is ___nested emphasis_ and ending bold__
          ${""}
          **Test bold**
        `,after:dedent`
          # Strong First Strong Is an Underscore
          ${""}
          __First bold__
          This is __bold__ mid sentence
          This is __bold__ mid sentence with a second __bold__ on the same line
          This is ___bold and emphasized___
          This is *__nested bold__ and ending emphasized*
          This is ___nested emphasis_ and ending bold__
          ${""}
          __Test bold__
        `,options:{style:"consistent"}})]}get optionBuilders(){return[new DropdownOptionBuilder({OptionsClass:StrongStyleOptions,name:"Style",description:"The style used to denote strong/bolded content",optionsKey:"style",records:[{value:"consistent",description:"Makes sure the first instance of strong is the style that will be used throughout the document"},{value:"asterisk",description:"Makes sure ** is the strong indicator"},{value:"underscore",description:"Makes sure __ is the strong indicator"}]})]}};StrongStyle=__decorate([RuleBuilder.register],StrongStyle);class TrailingSpacesOptions{constructor(){this.twoSpaceLineBreak=!1}}let TrailingSpaces=class extends RuleBuilder{get OptionsClass(){return TrailingSpacesOptions}get name(){return"Trailing spaces"}get description(){return"Removes extra spaces after every line."}get type(){return RuleType.SPACING}apply(text,options){return ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>options.twoSpaceLineBreak?text=(text=(text=text.replace(/(\S)[ \t]$/gm,"$1")).replace(/(\S)[ \t]{3,}$/gm,"$1")).replace(/(\S)( ?\t\t? ?)$/gm,"$1"):text.replace(/[ \t]+$/gm,"")))}get exampleBuilders(){return[new ExampleBuilder({description:"Removes trailing spaces and tabs.",before:dedent`
          # H1
          Line with trailing spaces and tabs.	        ${""}
        `,after:dedent`
          # H1
          Line with trailing spaces and tabs.
        `}),new ExampleBuilder({description:"With `Two Space Linebreak = true`",before:dedent`
          # H1
          Line with trailing spaces and tabs.  ${""}
        `,after:dedent`
          # H1
          Line with trailing spaces and tabs.  ${""}
        `,options:{twoSpaceLineBreak:!0}})]}get optionBuilders(){return[new BooleanOptionBuilder({OptionsClass:TrailingSpacesOptions,name:"Two Space Linebreak",description:'Ignore two spaces followed by a line break ("Two Space Rule").',optionsKey:"twoSpaceLineBreak"})]}};TrailingSpaces=__decorate([RuleBuilder.register],TrailingSpaces);class TwoSpacesBetweenLinesWithContentOptions{}let TwoSpacesBetweenLinesWithContent=class extends RuleBuilder{get OptionsClass(){return TwoSpacesBetweenLinesWithContentOptions}get name(){return"Two Spaces Between Lines with Content"}get description(){return"Makes sure that two spaces are added to the ends of lines with content continued on the next line for paragraphs, blockquotes, and list items"}get type(){return RuleType.CONTENT}apply(text,options){return ignoreListOfTypes([IgnoreTypes.obsidianMultiLineComments,IgnoreTypes.yaml],text,addTwoSpacesAtEndOfLinesFollowedByAnotherLineOfTextContent)}get exampleBuilders(){return[new ExampleBuilder({description:"Make sure two spaces are added to the ends of lines that have content on it and the next line for lists, blockquotes, and paragraphs",before:dedent`
          # Heading 1
          First paragraph stays as the first paragraph
          ${""}
          - list item 1
          - list item 2
          Continuation of list item 2
          - list item 3
          ${""}
          1. Item 1
          2. Item 2
          Continuation of item 3
          3. Item 3
          ${""}
          Paragraph for with link [[other file name]].
          Continuation *of* the paragraph has \`inline code block\` __in it__.
          Even more continuation
          ${""}
          Paragraph lines that end in <br/>
          Or lines that end in <br>
          Are left alone
          Since they mean the same thing
          ${""}
          \`\`\` text
          Code blocks are ignored
          Even with multiple lines
          \`\`\`
          Another paragraph here
          ${""}
          > Blockquotes are affected
          > More content here
          Content here
          ${""}
          <div>
          html content
          should be ignored
          </div>
          Even more content here
          ${""}
        `,after:dedent`
          # Heading 1
          First paragraph stays as the first paragraph
          ${""}
          - list item 1
          - list item 2  ${""}
          Continuation of list item 2
          - list item 3
          ${""}
          1. Item 1
          2. Item 2  ${""}
          Continuation of item 3
          3. Item 3
          ${""}
          Paragraph for with link [[other file name]].  ${""}
          Continuation *of* the paragraph has \`inline code block\` __in it__.  ${""}
          Even more continuation
          ${""}
          Paragraph lines that end in <br/>
          Or lines that end in <br>
          Are left alone  ${""}
          Since they mean the same thing
          ${""}
          \`\`\` text
          Code blocks are ignored
          Even with multiple lines
          \`\`\`
          Another paragraph here
          ${""}
          > Blockquotes are affected  ${""}
          > More content here  ${""}
          Content here
          ${""}
          <div>
          html content
          should be ignored
          </div>
          Even more content here
          ${""}
        `})]}get optionBuilders(){return[]}};TwoSpacesBetweenLinesWithContent=__decorate([RuleBuilder.register],TwoSpacesBetweenLinesWithContent);class YamlKeySortOptions{constructor(){this.priorityKeysAtStartOfYaml=!0,this.yamlKeyPrioritySortOrder=[],this.yamlSortOrderForOtherKeys="None"}}let YamlKeySort=class extends RuleBuilder{get OptionsClass(){return YamlKeySortOptions}get name(){return"YAML Key Sort"}get description(){return"Sorts the YAML keys based on the order and priority specified. Note: removes blank lines as well."}get type(){return RuleType.YAML}apply(text,options){const yaml=text.match(yamlRegex);if(!yaml)return text;let yamlText=yaml[1];const priorityAtStartOfYaml=options.priorityKeysAtStartOfYaml,getTextWithNewYamlFrontmatter=function(priorityKeysSorted,remainingKeys,priorityAtStart){let newYaml=`${remainingKeys}${priorityKeysSorted}`;return priorityAtStart&&(newYaml=`${priorityKeysSorted}${remainingKeys}`),options.yamlTimestampDateModifiedEnabled&&(newYaml=function(oldYaml,newYaml){return oldYaml==newYaml?newYaml:setYamlSection(newYaml,options.dateModifiedKey," "+options.currentTimeFormatted)}(yaml[1],newYaml)),text.replace(yaml[1],newYaml)},getYAMLKeysSorted=function(yaml,keys){let specifiedYamlKeysSorted="";for(const key of keys){const value=getYamlSectionValue(yaml,key);null!==value&&(value.includes("\n")?specifiedYamlKeysSorted+=`${key}:${value}\n`:specifiedYamlKeysSorted+=`${key}: ${value}\n`,yaml=removeYamlSection(yaml,key))}return{remainingYaml:yaml,sortedYamlKeyValues:specifiedYamlKeysSorted}},sortKeysResult=getYAMLKeysSorted(yamlText,options.yamlKeyPrioritySortOrder),priorityKeysSorted=sortKeysResult.sortedYamlKeyValues;yamlText=sortKeysResult.remainingYaml;const sortOrder=options.yamlSortOrderForOtherKeys,yamlObject=loadYAML(yamlText);if(null==yamlObject)return getTextWithNewYamlFrontmatter(priorityKeysSorted,yamlText,priorityAtStartOfYaml);const sortAlphabeticallyDesc=function(previousKey,currentKey){return(previousKey=previousKey.toLowerCase())>(currentKey=currentKey.toLowerCase())?-1:currentKey>previousKey?1:0};let sortMethod,remainingKeys=Object.keys(yamlObject);if("Ascending Alphabetical"===sortOrder)sortMethod=function(previousKey,currentKey){return(previousKey=previousKey.toLowerCase())<(currentKey=currentKey.toLowerCase())?-1:currentKey<previousKey?1:0};else{if("Descending Alphabetical"!==sortOrder)return getTextWithNewYamlFrontmatter(priorityKeysSorted,yamlText,priorityAtStartOfYaml);sortMethod=sortAlphabeticallyDesc}return remainingKeys=remainingKeys.sort(sortMethod),getTextWithNewYamlFrontmatter(priorityKeysSorted,getYAMLKeysSorted(yamlText,remainingKeys).sortedYamlKeyValues,priorityAtStartOfYaml)}get exampleBuilders(){return[new ExampleBuilder({description:"Sorts YAML keys in order specified by `YAML Key Priority Sort Order` has a sort order of `date type language`",before:dedent`
          ---
          language: Typescript
          type: programming
          tags: computer
          keywords: []
          status: WIP
          date: 02/15/2022
          ---
        `,after:dedent`
          ---
          date: 02/15/2022
          type: programming
          language: Typescript
          tags: computer
          keywords: []
          status: WIP
          ---
        `,options:{yamlKeyPrioritySortOrder:["date","type","language"],yamlSortOrderForOtherKeys:"None",priorityKeysAtStartOfYaml:!0}}),new ExampleBuilder({description:"Sorts YAML keys in order specified by `YAML Key Priority Sort Order` has a sort order of `date type language` with `'YAML Sort Order for Other Keys' = Ascending Alphabetical`",before:dedent`
          ---
          language: Typescript
          type: programming
          tags: computer
          keywords: []
          status: WIP
          date: 02/15/2022
          ---
        `,after:dedent`
          ---
          date: 02/15/2022
          type: programming
          language: Typescript
          keywords: []
          status: WIP
          tags: computer
          ---
        `,options:{yamlKeyPrioritySortOrder:["date","type","language"],yamlSortOrderForOtherKeys:"Ascending Alphabetical"}}),new ExampleBuilder({description:"Sorts YAML keys in order specified by `YAML Key Priority Sort Order` has a sort order of `date type language` with `'YAML Sort Order for Other Keys' = Descending Alphabetical`",before:dedent`
          ---
          language: Typescript
          type: programming
          tags: computer
          keywords: []
          status: WIP
          date: 02/15/2022
          ---
        `,after:dedent`
          ---
          date: 02/15/2022
          type: programming
          language: Typescript
          tags: computer
          status: WIP
          keywords: []
          ---
        `,options:{yamlKeyPrioritySortOrder:["date","type","language"],yamlSortOrderForOtherKeys:"Descending Alphabetical",priorityKeysAtStartOfYaml:!0}}),new ExampleBuilder({description:"Sorts YAML keys in order specified by `YAML Key Priority Sort Order` has a sort order of `date type language` with `'YAML Sort Order for Other Keys' = Descending Alphabetical` and `'Priority Keys at Start of YAML' = false`",before:dedent`
          ---
          language: Typescript
          type: programming
          tags: computer
          keywords: []
          ${""}
          status: WIP
          date: 02/15/2022
          ---
        `,after:dedent`
          ---
          tags: computer
          status: WIP
          keywords: []
          date: 02/15/2022
          type: programming
          language: Typescript
          ---
        `,options:{yamlKeyPrioritySortOrder:["date","type","language"],yamlSortOrderForOtherKeys:"Descending Alphabetical",priorityKeysAtStartOfYaml:!1}})]}get optionBuilders(){return[new TextAreaOptionBuilder({OptionsClass:YamlKeySortOptions,name:"YAML Key Priority Sort Order",description:"The order in which to sort keys with one on each line where it sorts in the order found in the list",optionsKey:"yamlKeyPrioritySortOrder"}),new BooleanOptionBuilder({OptionsClass:YamlKeySortOptions,name:"Priority Keys at Start of YAML",description:"YAML Key Priority Sort Order is placed at the start of the YAML frontmatter",optionsKey:"priorityKeysAtStartOfYaml"}),new DropdownOptionBuilder({OptionsClass:YamlKeySortOptions,name:"YAML Sort Order for Other Keys",description:"The way in which to sort the keys that are not found in the YAML Key Priority Sort Order text area",optionsKey:"yamlSortOrderForOtherKeys",records:[{value:"None",description:"No sorting other than what is in the YAML Key Priority Sort Order text area"},{value:"Ascending Alphabetical",description:"Sorts the keys based on key value from a to z"},{value:"Descending Alphabetical",description:"Sorts the keys based on key value from z to a"}]})]}get hasSpecialExecutionOrder(){return!0}};YamlKeySort=__decorate([RuleBuilder.register],YamlKeySort);var YamlKeySort$1=YamlKeySort;class YamlTimestampOptions{constructor(){this.dateCreatedKey="date created",this.dateCreated=!0,this.format="dddd, MMMM Do YYYY, h:mm:ss a",this.dateModified=!0,this.dateModifiedKey="date modified",this.locale="en"}}let YamlTimestamp=class extends RuleBuilder{get OptionsClass(){return YamlTimestampOptions}get name(){return"YAML Timestamp"}get description(){return"Keep track of the date the file was last edited in the YAML front matter. Gets dates from file metadata."}get type(){return RuleType.YAML}apply(text,options){let textModified=options.alreadyModified;const newText=initYAML(text);return textModified=textModified||newText!==text,formatYAML(newText,(text=>{const created_match_str=`\n${options.dateCreatedKey}: [^\n]+\n`,created_key_match_str=`\n${options.dateCreatedKey}:[ \t]*\n`,created_key_match=new RegExp(created_key_match_str),created_match=new RegExp(created_match_str);if(options.dateCreated){const created_date=obsidian.moment(options.fileCreatedTime);created_date.locale(options.locale);const formatted_date=created_date.format(options.format),created_date_line=`\n${options.dateCreatedKey}: ${formatted_date}`,keyWithValueFound=created_match.test(text);if(!keyWithValueFound&&created_key_match.test(text))text=text.replace(created_key_match,escapeDollarSigns(created_date_line)+"\n"),textModified=!0;else if(keyWithValueFound){if(keyWithValueFound){const createdDateTime=obsidian.moment(text.match(created_match)[0].replace(options.dateCreatedKey+":","").trim(),options.format,options.locale,!0);null!=createdDateTime&&createdDateTime.isValid()||(text=text.replace(created_match,escapeDollarSigns(created_date_line)+"\n"),textModified=!0)}}else{const yaml_end=text.indexOf("\n---");text=insert(text,yaml_end,`\n${options.dateCreatedKey}: ${formatted_date}`),textModified=!0}}if(options.dateModified){const modified_match_str=`\n${options.dateModifiedKey}: [^\n]+\n`,modified_key_match_str=`\n${options.dateModifiedKey}:[ \t]*\n`,modified_key_match=new RegExp(modified_key_match_str),modified_match=new RegExp(modified_match_str),modified_date=obsidian.moment(options.fileModifiedTime);modified_date.locale(options.locale);const formatted_modified_date=options.currentTime.format(options.format),modified_date_line=`\n${options.dateModifiedKey}: ${formatted_modified_date}`,keyWithValueFound=modified_match.test(text);if(keyWithValueFound){const modifiedDateTime=obsidian.moment(text.match(modified_match)[0].replace(options.dateModifiedKey+":","").trim(),options.format,options.locale,!0);(textModified||null==modifiedDateTime||!modifiedDateTime.isValid()||Math.abs(modifiedDateTime.diff(modified_date,"seconds"))>5)&&(text=text.replace(modified_match,escapeDollarSigns(modified_date_line)+"\n"))}else if(modified_key_match.test(text))text=text.replace(modified_key_match,escapeDollarSigns(modified_date_line)+"\n");else if(!keyWithValueFound){const yaml_end=text.indexOf("\n---");text=insert(text,yaml_end,modified_date_line)}}return text}))}get exampleBuilders(){return[new ExampleBuilder({description:"Adds a header with the date.",before:dedent`
          # H1
        `,after:dedent`
          ---
          date created: Wednesday, January 1st 2020, 12:00:00 am
          date modified: Thursday, January 2nd 2020, 12:00:05 am
          ---
          # H1
        `,options:{fileCreatedTime:"2020-01-01T00:00:00-00:00",fileModifiedTime:"2020-01-02T00:00:00-00:00",currentTime:obsidian.moment("Thursday, January 2nd 2020, 12:00:05 am","dddd, MMMM Do YYYY, h:mm:ss a"),alreadyModified:!1}}),new ExampleBuilder({description:"dateCreated option is false",before:dedent`
          # H1
        `,after:dedent`
          ---
          date modified: Thursday, January 2nd 2020, 12:00:05 am
          ---
          # H1
        `,options:{dateCreated:!1,fileCreatedTime:"2020-01-01T00:00:00-00:00",fileModifiedTime:"2020-01-01T00:00:00-00:00",currentTime:obsidian.moment("Thursday, January 2nd 2020, 12:00:05 am","dddd, MMMM Do YYYY, h:mm:ss a"),alreadyModified:!1}}),new ExampleBuilder({description:"Date Created Key is set",before:dedent`
          # H1
        `,after:dedent`
          ---
          created: Wednesday, January 1st 2020, 12:00:00 am
          ---
          # H1
        `,options:{dateCreated:!0,dateModified:!1,dateCreatedKey:"created",fileCreatedTime:"2020-01-01T00:00:00-00:00",currentTime:obsidian.moment("Thursday, January 2nd 2020, 12:00:03 am","dddd, MMMM Do YYYY, h:mm:ss a"),alreadyModified:!1}}),new ExampleBuilder({description:"Date Modified Key is set",before:dedent`
          # H1
        `,after:dedent`
          ---
          modified: Wednesday, January 1st 2020, 4:00:00 pm
          ---
          # H1
        `,options:{dateCreated:!1,dateModified:!0,dateModifiedKey:"modified",fileModifiedTime:"2020-01-01T00:00:00-00:00",currentTime:obsidian.moment("Wednesday, January 1st 2020, 4:00:00 pm","dddd, MMMM Do YYYY, h:mm:ss a"),alreadyModified:!1}})]}get optionBuilders(){return[new BooleanOptionBuilder({OptionsClass:YamlTimestampOptions,name:"Date Created",description:"Insert the file creation date",optionsKey:"dateCreated"}),new TextOptionBuilder({OptionsClass:YamlTimestampOptions,name:"Date Created Key",description:"Which YAML key to use for creation date",optionsKey:"dateCreatedKey"}),new BooleanOptionBuilder({OptionsClass:YamlTimestampOptions,name:"Date Modified",description:"Insert the date the file was last modified",optionsKey:"dateModified"}),new TextOptionBuilder({OptionsClass:YamlTimestampOptions,name:"Date Modified Key",description:"Which YAML key to use for modification date",optionsKey:"dateModifiedKey"}),new MomentFormatOptionBuilder({OptionsClass:YamlTimestampOptions,name:"Format",description:"Date format",optionsKey:"format"})]}get hasSpecialExecutionOrder(){return!0}};YamlTimestamp=__decorate([RuleBuilder.register],YamlTimestamp);var YamlTimestamp$1=YamlTimestamp;class YamlTitleAliasOptions{constructor(){this.yamlAliasesSectionStyle="Multi-line array",this.preserveExistingAliasesSectionStyle=!0,this.keepAliasThatMatchesTheFilename=!1}}let YamlTitleAlias=class extends RuleBuilder{get OptionsClass(){return YamlTitleAliasOptions}get name(){return"YAML Title Alias"}get description(){return"Inserts the title of the file into the YAML frontmatter's aliases section. Gets the title from the first H1 or filename."}get type(){return RuleType.YAML}apply(text,options){text=initYAML(text);let title=ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{const result=text.match(/^#\s+(.*)/m);return result?result[1]:""}));title=title||options.fileName;const shouldRemoveTitleAlias=!options.keepAliasThatMatchesTheFilename&&title===options.fileName;let yaml=text.match(yamlRegex)[1],previousTitle=loadYAML(getYamlSectionValue(yaml,"linter-yaml-title-alias")),requiresChanges=!0;if(previousTitle!==title||shouldRemoveTitleAlias||(requiresChanges=!1),null===previousTitle&&shouldRemoveTitleAlias&&(requiresChanges=!1),!requiresChanges&&options.preserveExistingAliasesSectionStyle)return text;let aliasesValue=getYamlSectionValue(yaml,"aliases");if(!aliasesValue){if(shouldRemoveTitleAlias)return text;let emptyValue;switch(options.yamlAliasesSectionStyle){case"Multi-line array":emptyValue="\n  - ''";break;case"Single-line array":emptyValue=" ['']";break;case"Single string that expands to multi-line array if needed":case"Single string that expands to single-line array if needed":emptyValue=" ''";break;default:throw new Error(`Unsupported setting 'YAML aliases section style': ${options.yamlAliasesSectionStyle}`)}let newYaml=yaml;newYaml=setYamlSection(newYaml,"aliases",emptyValue),newYaml=setYamlSection(newYaml,"linter-yaml-title-alias"," ''"),text=text.replace(`---\n${yaml}---`,`---\n${newYaml}---`),yaml=newYaml,aliasesValue=getYamlSectionValue(yaml,"aliases"),previousTitle=""}const isMultiline=aliasesValue.includes("\n"),parsedAliases=loadYAML(aliasesValue),isSingleString=!isMultiline&&null===aliasesValue.match(/^\[.*\]/);let resultAliasesArray=isSingleString?[parsedAliases]:[...parsedAliases];const previousTitleIndex=resultAliasesArray.indexOf(previousTitle);if(-1!==previousTitleIndex?shouldRemoveTitleAlias?resultAliasesArray.splice(previousTitleIndex,1):resultAliasesArray[previousTitleIndex]=title:shouldRemoveTitleAlias||(resultAliasesArray=[title,...resultAliasesArray]),!requiresChanges)switch(options.yamlAliasesSectionStyle){case"Multi-line array":if(isMultiline)return text;break;case"Single-line array":if(!isMultiline&&!isSingleString)return text;break;case"Single string that expands to multi-line array if needed":if(isSingleString)return text;if(isMultiline&&resultAliasesArray.length>1)return text;break;case"Single string that expands to single-line array if needed":if(isSingleString)return text;if(!isMultiline&&resultAliasesArray.length>1)return text}let resultStyle,newAliasesYaml;if(0===resultAliasesArray.length)resultStyle="Remove";else if(options.preserveExistingAliasesSectionStyle)if(isSingleString)if(1===resultAliasesArray.length)resultStyle="Single string";else switch(options.yamlAliasesSectionStyle){case"Multi-line array":case"Single string that expands to multi-line array if needed":resultStyle="Multi-line array";break;case"Single-line array":case"Single string that expands to single-line array if needed":resultStyle="Single-line array"}else resultStyle=isMultiline?"Multi-line array":"Single-line array";else switch(options.yamlAliasesSectionStyle){case"Multi-line array":resultStyle="Multi-line array";break;case"Single-line array":resultStyle="Single-line array";break;case"Single string that expands to multi-line array if needed":resultStyle=1===resultAliasesArray.length?"Single string":"Multi-line array";break;case"Single string that expands to single-line array if needed":resultStyle=1===resultAliasesArray.length?"Single string":"Single-line array"}switch(resultStyle){case"Remove":break;case"Multi-line array":newAliasesYaml=`\n${toYamlString(resultAliasesArray)}`.replace(/\n-/g,"\n  -");break;case"Single-line array":newAliasesYaml=` ${arr=resultAliasesArray,dump(arr,{flowLevel:0}).slice(0,-1)}`;break;case"Single string":newAliasesYaml=0===resultAliasesArray.length?"":` ${toYamlString(resultAliasesArray[0])}`;break;default:throw new Error(`Unsupported resultStyle: ${resultStyle}`)}var arr;let newYaml=yaml;return newYaml="Remove"===resultStyle?removeYamlSection(newYaml,"aliases"):setYamlSection(newYaml,"aliases",newAliasesYaml),newYaml=shouldRemoveTitleAlias?removeYamlSection(newYaml,"linter-yaml-title-alias"):setYamlSection(newYaml,"linter-yaml-title-alias",` ${toYamlString(title)}`),text.replace(yaml,newYaml)}get exampleBuilders(){return[new ExampleBuilder({description:"Adds a header with the title from heading.",before:dedent`
          # Obsidian
        `,after:dedent`
          ---
          aliases:
            - Obsidian
          linter-yaml-title-alias: Obsidian
          ---
          # Obsidian
        `}),new ExampleBuilder({description:"Adds a header with the title.",before:dedent`
          ${""}
        `,after:dedent`
          ---
          aliases:
            - Filename
          linter-yaml-title-alias: Filename
          ---
          ${""}
        `,options:{fileName:"Filename",keepAliasThatMatchesTheFilename:!0}})]}get optionBuilders(){return[new DropdownOptionBuilder({OptionsClass:YamlTitleAliasOptions,name:"YAML aliases section style",description:"The style of the aliases YAML section",optionsKey:"yamlAliasesSectionStyle",records:[{value:"Multi-line array",description:"```aliases:\\n  - Title```"},{value:"Single-line array",description:"```aliases: [Title]```"},{value:"Single string that expands to multi-line array if needed",description:"```aliases: Title```"},{value:"Single string that expands to single-line array if needed",description:"```aliases: Title```"}]}),new BooleanOptionBuilder({OptionsClass:YamlTitleAliasOptions,name:"Preserve existing aliases section style",description:"If set, the `YAML aliases section style` setting applies only to the newly created sections",optionsKey:"preserveExistingAliasesSectionStyle"}),new BooleanOptionBuilder({OptionsClass:YamlTitleAliasOptions,name:"Keep alias that matches the filename",description:"Such aliases are usually redundant",optionsKey:"keepAliasThatMatchesTheFilename"})]}};YamlTitleAlias=__decorate([RuleBuilder.register],YamlTitleAlias);class YamlTitleOptions{constructor(){this.titleKey="title"}}let YamlTitle=class extends RuleBuilder{get OptionsClass(){return YamlTitleOptions}get name(){return"YAML Title"}get description(){return"Inserts the title of the file into the YAML frontmatter. Gets the title from the first H1 or filename if there is no H1."}get type(){return RuleType.YAML}apply(text,options){text=initYAML(text);let title=ignoreListOfTypes([IgnoreTypes.code,IgnoreTypes.yaml,IgnoreTypes.link,IgnoreTypes.wikiLink,IgnoreTypes.tag],text,(text=>{const result=text.match(/^#\s+(.*)/m);return result?result[1]:""}));return title=title||options.fileName,title=toYamlString(title),formatYAML(text,(text=>{const title_match_str=`\n${options.titleKey}.*\n`,title_match=new RegExp(title_match_str);if(title_match.test(text))text=text.replace(title_match,escapeDollarSigns(`\n${options.titleKey}: ${title}\n`));else{const yaml_end=text.indexOf("\n---");text=insert(text,yaml_end,`\n${options.titleKey}: ${title}`)}return text}))}get exampleBuilders(){return[new ExampleBuilder({description:"Adds a header with the title from heading.",before:dedent`
          # Obsidian
        `,after:dedent`
          ---
          title: Obsidian
          ---
          # Obsidian
        `,options:{fileName:"Filename"}}),new ExampleBuilder({description:"Adds a header with the title.",before:dedent`
          ${""}
        `,after:dedent`
          ---
          title: Filename
          ---
          ${""}
        `,options:{fileName:"Filename"}})]}get optionBuilders(){return[new TextOptionBuilder({OptionsClass:YamlTitleOptions,name:"Title Key",description:"Which YAML key to use for title",optionsKey:"titleKey"})]}};YamlTitle=__decorate([RuleBuilder.register],YamlTitle);const iconInfo={folder:{id:"lint-folder",source:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   version="1.1"\n   width="100"\n   height="100"\n   viewBox="0 0 100 100"\n   xml:space="preserve"\n   id="svg3874"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n<defs\n   id="defs3862" />\n\n<g\n   transform="matrix(0.14701218,0,0,0.10231871,54.655987,68.756842)"\n   id="g3940">\n    <g\n   style="opacity:1;fill:none;fill-rule:nonzero;stroke:none;stroke-width:0;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   transform="matrix(3.89,0,0,3.89,-175.05,-175.05)"\n   id="g3938">\n    <path\n   d="m 89.161,11.093 c -0.109,-0.329 -0.381,-0.578 -0.719,-0.658 -0.334,-0.078 -0.692,0.02 -0.937,0.266 l -7.189,7.189 c -1.096,1.096 -2.553,1.7 -4.104,1.7 -1.55,0 -3.007,-0.603 -4.104,-1.699 -2.262,-2.263 -2.262,-5.944 0,-8.207 L 79.297,2.495 C 79.542,2.25 79.643,1.895 79.563,1.558 79.484,1.221 79.234,0.949 78.905,0.839 73.042,-1.106 66.689,0.39 62.335,4.745 57.872,9.207 56.419,15.794 58.543,21.693 L 21.693,58.544 C 15.796,56.42 9.208,57.874 4.745,62.336 0.39,66.691 -1.107,73.04 0.838,78.906 c 0.109,0.329 0.381,0.579 0.719,0.658 0.335,0.081 0.692,-0.021 0.937,-0.266 l 7.189,-7.189 c 2.261,-2.263 5.943,-2.263 8.207,0 1.096,1.096 1.699,2.553 1.699,4.104 0,1.551 -0.603,3.007 -1.7,4.104 L 10.7,87.506 c -0.245,0.245 -0.346,0.599 -0.266,0.937 0.08,0.338 0.329,0.609 0.658,0.719 1.7,0.563 3.44,0.839 5.16,0.839 4.218,0 8.317,-1.652 11.41,-4.745 4.463,-4.463 5.917,-11.049 3.793,-16.948 L 68.306,31.457 c 5.9,2.123 12.485,0.671 16.948,-3.793 4.357,-4.355 5.853,-10.705 3.907,-16.571 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path3932" />\n    <path\n   d="M 72.088,57.275 C 71.911,57.098 71.675,56.995 71.426,56.983 67.964,56.828 64.348,55.107 61.503,52.262 59.761,50.519 58.438,48.48 57.64,46.365 L 46.517,57.488 c 2.115,0.799 4.154,2.121 5.897,3.863 2.845,2.846 4.565,6.462 4.721,9.923 0.012,0.249 0.115,0.485 0.292,0.662 l 14.876,14.876 c 2.021,2.021 4.676,3.031 7.33,3.031 2.655,0 5.311,-1.01 7.331,-3.031 4.041,-4.042 4.041,-10.619 0,-14.661 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path3934" />\n    <path\n   d="m 5.351,14.171 c 0.123,0.219 0.324,0.384 0.563,0.462 l 5.82,1.89 23.869,23.869 4.638,-4.638 L 16.372,11.885 14.481,6.065 C 14.403,5.826 14.238,5.625 14.019,5.502 L 4.714,0.279 C 4.323,0.06 3.834,0.128 3.518,0.444 L 0.293,3.668 C -0.024,3.985 -0.091,4.474 0.128,4.864 Z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path3936" />\n</g>\n</g><g\n   transform="matrix(0.27381202,0,0,0.35603928,51.097404,51.582597)"\n   id="g4147">\n    <g\n   style="opacity:1;fill:none;fill-rule:nonzero;stroke:none;stroke-width:0;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   transform="matrix(3.89,0,0,3.89,-175.05,-175.05)"\n   id="g4145">\n    <path\n   d="M 89.234,35.526 C 88.505,34.55 87.387,33.99 86.169,33.99 H 74.085 v -8.511 c 0,-2.856 -2.324,-5.181 -5.181,-5.181 H 44.128 c -0.574,0 -1.136,-0.233 -1.542,-0.639 L 34.998,12.071 C 34.02,11.092 32.719,10.553 31.334,10.553 H 5.181 C 2.324,10.554 0,12.878 0,15.735 v 49.459 7.593 2.517 c 0,2.284 1.858,4.143 4.142,4.143 h 70.042 c 0.011,0 0.021,0 0.033,0 2.389,0 4.245,-1.737 5.093,-4.753 L 89.841,38.902 c 0.344,-1.17 0.124,-2.4 -0.607,-3.376 z M 4.142,76.446 C 3.512,76.446 3,75.933 3,75.303 V 72.786 65.193 15.735 c 0,-1.203 0.978,-2.181 2.181,-2.181 h 26.154 c 0.574,0 1.136,0.233 1.542,0.639 l 7.588,7.588 c 0.978,0.979 2.279,1.518 3.664,1.518 h 24.776 c 1.202,0 2.181,0.978 2.181,2.181 v 8.511 h -50.05 c -2.338,0 -4.421,1.57 -5.065,3.817 L 5.342,74.893 C 4.9,76.446 4.388,76.446 4.142,76.446 Z M 86.963,38.054 76.426,73.864 c -0.331,1.179 -0.983,2.582 -2.222,2.582 -0.003,0 -0.007,0 -0.011,0 H 7.985 C 8.071,76.219 8.152,75.977 8.226,75.717 L 18.855,38.634 c 0.277,-0.968 1.174,-1.644 2.181,-1.644 h 65.133 c 0.36,0 0.57,0.208 0.663,0.333 0.093,0.124 0.233,0.384 0.131,0.731 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path4143" />\n</g>\n</g></svg>'},file:{id:"lint-file",source:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   fill="currentColor"\n   viewBox="0 0 100 100"\n   width="100"\n   height="100"\n   version="1.1"\n   id="svg3235"\n   xml:space="preserve"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg"><defs\n     id="defs3239" /><path\n     d="M 5,2 V 99.648562 H 96.607328 V 28.733947 L 95.891646,28.070574 65.35587,2.597036 64.560667,2 Z m 5.089296,4.2455896 h 50.89296 V 31.719127 H 91.518032 V 95.402972 H 10.089296 Z M 66.071552,9.2971072 87.860101,27.473538 H 66.071552 Z"\n     id="path3233"\n     style="stroke-width:2.32417" /><g\n     transform="matrix(0.15232206,0,0,0.14054685,49.142307,65.828276)"\n     id="g3717">\n    <g\n   style="opacity:1;fill:none;fill-rule:nonzero;stroke:none;stroke-width:0;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   transform="matrix(3.89,0,0,3.89,-175.05,-175.05)"\n   id="g3715">\n    <path\n   d="m 89.161,11.093 c -0.109,-0.329 -0.381,-0.578 -0.719,-0.658 -0.334,-0.078 -0.692,0.02 -0.937,0.266 l -7.189,7.189 c -1.096,1.096 -2.553,1.7 -4.104,1.7 -1.55,0 -3.007,-0.603 -4.104,-1.699 -2.262,-2.263 -2.262,-5.944 0,-8.207 L 79.297,2.495 C 79.542,2.25 79.643,1.895 79.563,1.558 79.484,1.221 79.234,0.949 78.905,0.839 73.042,-1.106 66.689,0.39 62.335,4.745 57.872,9.207 56.419,15.794 58.543,21.693 L 21.693,58.544 C 15.796,56.42 9.208,57.874 4.745,62.336 0.39,66.691 -1.107,73.04 0.838,78.906 c 0.109,0.329 0.381,0.579 0.719,0.658 0.335,0.081 0.692,-0.021 0.937,-0.266 l 7.189,-7.189 c 2.261,-2.263 5.943,-2.263 8.207,0 1.096,1.096 1.699,2.553 1.699,4.104 0,1.551 -0.603,3.007 -1.7,4.104 L 10.7,87.506 c -0.245,0.245 -0.346,0.599 -0.266,0.937 0.08,0.338 0.329,0.609 0.658,0.719 1.7,0.563 3.44,0.839 5.16,0.839 4.218,0 8.317,-1.652 11.41,-4.745 4.463,-4.463 5.917,-11.049 3.793,-16.948 L 68.306,31.457 c 5.9,2.123 12.485,0.671 16.948,-3.793 4.357,-4.355 5.853,-10.705 3.907,-16.571 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path3709" />\n    <path\n   d="M 72.088,57.275 C 71.911,57.098 71.675,56.995 71.426,56.983 67.964,56.828 64.348,55.107 61.503,52.262 59.761,50.519 58.438,48.48 57.64,46.365 L 46.517,57.488 c 2.115,0.799 4.154,2.121 5.897,3.863 2.845,2.846 4.565,6.462 4.721,9.923 0.012,0.249 0.115,0.485 0.292,0.662 l 14.876,14.876 c 2.021,2.021 4.676,3.031 7.33,3.031 2.655,0 5.311,-1.01 7.331,-3.031 4.041,-4.042 4.041,-10.619 0,-14.661 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path3711" />\n    <path\n   d="m 5.351,14.171 c 0.123,0.219 0.324,0.384 0.563,0.462 l 5.82,1.89 23.869,23.869 4.638,-4.638 L 16.372,11.885 14.481,6.065 C 14.403,5.826 14.238,5.625 14.019,5.502 L 4.714,0.279 C 4.323,0.06 3.834,0.128 3.518,0.444 L 0.293,3.668 C -0.024,3.985 -0.091,4.474 0.128,4.864 Z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path3713" />\n</g>\n</g></svg>'},vault:{id:"lint-vault",source:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   version="1.1"\n   width="100"\n   height="100"\n   viewBox="0 0 100 100"\n   xml:space="preserve"\n   id="svg4286"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n<defs\n   id="defs4268" />\n<g\n   transform="matrix(0.27531192,0,0,0.3088608,50.157353,49.85424)"\n   id="g4284">\n    <g\n   style="opacity:1;fill:none;fill-rule:nonzero;stroke:none;stroke-width:0;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   transform="matrix(3.89,0,0,3.89,-175.05,-175.05)"\n   id="g4282">\n    <path\n   d="M 90,84.505 H 0 V 5.495 h 90 z m -86,-4 H 86 V 9.495 H 4 Z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path4270" />\n    <path\n   d="M 90,32.695 H 0 v -27.2 h 90 z m -86,-4 H 86 V 9.495 H 4 Z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path4272" />\n    <rect\n   x="9.5799999"\n   y="17.09"\n   rx="0"\n   ry="0"\n   width="3.0699999"\n   height="4"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   id="rect4274" />\n    <rect\n   x="16.450001"\n   y="17.09"\n   rx="0"\n   ry="0"\n   width="3.0699999"\n   height="4"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   id="rect4276" />\n    <rect\n   x="23.309999"\n   y="17.09"\n   rx="0"\n   ry="0"\n   width="3.0699999"\n   height="4"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   id="rect4278" />\n    <rect\n   x="36.549999"\n   y="17.09"\n   rx="0"\n   ry="0"\n   width="43.880001"\n   height="4"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   id="rect4280" />\n</g>\n</g>\n<g\n   transform="matrix(0.17149846,0,0,0.13197486,48.887861,64.150509)"\n   id="g4352">\n    <g\n   style="opacity:1;fill:none;fill-rule:nonzero;stroke:none;stroke-width:0;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   transform="matrix(3.89,0,0,3.89,-175.05,-175.05)"\n   id="g4350">\n    <path\n   d="m 89.161,11.093 c -0.109,-0.329 -0.381,-0.578 -0.719,-0.658 -0.334,-0.078 -0.692,0.02 -0.937,0.266 l -7.189,7.189 c -1.096,1.096 -2.553,1.7 -4.104,1.7 -1.55,0 -3.007,-0.603 -4.104,-1.699 -2.262,-2.263 -2.262,-5.944 0,-8.207 L 79.297,2.495 C 79.542,2.25 79.643,1.895 79.563,1.558 79.484,1.221 79.234,0.949 78.905,0.839 73.042,-1.106 66.689,0.39 62.335,4.745 57.872,9.207 56.419,15.794 58.543,21.693 L 21.693,58.544 C 15.796,56.42 9.208,57.874 4.745,62.336 0.39,66.691 -1.107,73.04 0.838,78.906 c 0.109,0.329 0.381,0.579 0.719,0.658 0.335,0.081 0.692,-0.021 0.937,-0.266 l 7.189,-7.189 c 2.261,-2.263 5.943,-2.263 8.207,0 1.096,1.096 1.699,2.553 1.699,4.104 0,1.551 -0.603,3.007 -1.7,4.104 L 10.7,87.506 c -0.245,0.245 -0.346,0.599 -0.266,0.937 0.08,0.338 0.329,0.609 0.658,0.719 1.7,0.563 3.44,0.839 5.16,0.839 4.218,0 8.317,-1.652 11.41,-4.745 4.463,-4.463 5.917,-11.049 3.793,-16.948 L 68.306,31.457 c 5.9,2.123 12.485,0.671 16.948,-3.793 4.357,-4.355 5.853,-10.705 3.907,-16.571 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path4344" />\n    <path\n   d="M 72.088,57.275 C 71.911,57.098 71.675,56.995 71.426,56.983 67.964,56.828 64.348,55.107 61.503,52.262 59.761,50.519 58.438,48.48 57.64,46.365 L 46.517,57.488 c 2.115,0.799 4.154,2.121 5.897,3.863 2.845,2.846 4.565,6.462 4.721,9.923 0.012,0.249 0.115,0.485 0.292,0.662 l 14.876,14.876 c 2.021,2.021 4.676,3.031 7.33,3.031 2.655,0 5.311,-1.01 7.331,-3.031 4.041,-4.042 4.041,-10.619 0,-14.661 z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path4346" />\n    <path\n   d="m 5.351,14.171 c 0.123,0.219 0.324,0.384 0.563,0.462 l 5.82,1.89 23.869,23.869 4.638,-4.638 L 16.372,11.885 14.481,6.065 C 14.403,5.826 14.238,5.625 14.019,5.502 L 4.714,0.279 C 4.323,0.06 3.834,0.128 3.518,0.444 L 0.293,3.668 C -0.024,3.985 -0.091,4.474 0.128,4.864 Z"\n   style="opacity:1;fill:currentColor;fill-rule:nonzero;stroke:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none"\n   stroke-linecap="round"\n   id="path4348" />\n</g>\n</g></svg>'}},langToMomentLocale={en:"en-gb",zh:"zh-cn","zh-TW":"zh-tw",ru:"ru",ko:"ko",it:"it",id:"id",ro:"ro","pt-BR":"pt-br",cz:"cs",da:"da",de:"de",es:"es",fr:"fr",no:"nn",pl:"pl",pt:"pt",tr:"tr",hi:"hi",nl:"nl",ar:"ar",ja:"ja"};class LinterPlugin extends obsidian.Plugin{onload(){var _a,_b;return __awaiter(this,void 0,void 0,(function*(){logInfo("Loading plugin");for(const key in iconInfo){const svg=iconInfo[key];obsidian.addIcon(svg.id,svg.source)}yield this.loadSettings(),this.addCommand({id:"lint-file",name:"Lint the current file",editorCallback:editor=>this.runLinterEditor(editor),icon:iconInfo.file.id,hotkeys:[{modifiers:["Mod","Alt"],key:"l"}]}),this.addCommand({id:"lint-all-files",name:"Lint all files in the vault",icon:iconInfo.vault.id,callback:()=>{new LintConfirmationModal(this.app,"This will edit all of your files and may introduce errors.","Lint All","Linting all files...",(()=>this.runLinterAllFiles(this.app))).open()}}),this.addCommand({id:"lint-all-files-in-folder",name:"Lint all files in the current folder",icon:iconInfo.folder.id,editorCheckCallback:(checking,_)=>{if(checking)return!this.app.workspace.getActiveFile().parent.isRoot();this.createFolderLintModal(this.app.workspace.getActiveFile().parent)}}),this.registerEvent(this.app.workspace.on("file-menu",((menu,file)=>{file instanceof obsidian.TFolder&&menu.addItem((item=>{item.setTitle("Lint folder").setIcon(iconInfo.folder.id).onClick((()=>this.createFolderLintModal(file)))}))}))),this.eventRef=this.app.workspace.on("file-menu",((menu,file,source)=>this.onMenuOpenCallback(menu,file,source))),this.registerEvent(this.eventRef);const saveCommandDefinition=null===(_b=null===(_a=this.app.commands)||void 0===_a?void 0:_a.commands)||void 0===_b?void 0:_b["editor:save-file"];"function"==typeof(null==saveCommandDefinition?void 0:saveCommandDefinition.callback)&&(saveCommandDefinition.callback=()=>{if(this.settings.lintOnSave){const editor=this.app.workspace.getActiveViewOfType(obsidian.MarkdownView).editor,file=this.app.workspace.getActiveFile();this.shouldIgnoreFile(file)||this.runLinterEditor(editor)}});const that=this;window.CodeMirrorAdapter.commands.save=()=>{that.app.commands.executeCommandById("editor:save-file")},this.addSettingTab(new SettingTab(this.app,this))}))}onunload(){return __awaiter(this,void 0,void 0,(function*(){logInfo("Unloading plugin"),this.app.workspace.offref(this.eventRef)}))}loadSettings(){return __awaiter(this,void 0,void 0,(function*(){this.settings={ruleConfigs:{},lintOnSave:!1,displayChanged:!0,foldersToIgnore:[],linterLocale:"system-default",logLevel:log.levels.ERROR};const storedSettings=(yield this.loadData())||{};for(const rule of rules)if(this.settings.ruleConfigs[rule.name]=rule.getDefaultOptions(),(null==storedSettings?void 0:storedSettings.ruleConfigs)&&(null==storedSettings?void 0:storedSettings.ruleConfigs[rule.name])&&(Object.assign(this.settings.ruleConfigs[rule.name],storedSettings.ruleConfigs[rule.name]),void 0!==storedSettings.ruleConfigs[rule.name].Enabled)){const newEnabledOptionName=rule.enabledOptionName();this.settings.ruleConfigs[rule.name][newEnabledOptionName]=storedSettings.ruleConfigs[rule.name].Enabled,delete this.settings.ruleConfigs[rule.name].Enabled}Object.prototype.hasOwnProperty.call(storedSettings,"lintOnSave")&&(this.settings.lintOnSave=storedSettings.lintOnSave),Object.prototype.hasOwnProperty.call(storedSettings,"displayChanged")&&(this.settings.displayChanged=storedSettings.displayChanged),Object.prototype.hasOwnProperty.call(storedSettings,"foldersToIgnore")&&(this.settings.foldersToIgnore=storedSettings.foldersToIgnore),Object.prototype.hasOwnProperty.call(storedSettings,"linterLocale")&&(this.settings.linterLocale=storedSettings.linterLocale),Object.prototype.hasOwnProperty.call(storedSettings,"logLevel")&&(this.settings.logLevel=storedSettings.logLevel),function(logLevel){switch(logLevel){case log.levels.INFO:log.setLevel("info");break;case log.levels.TRACE:log.setLevel("trace");break;case log.levels.DEBUG:log.setLevel("debug");break;case log.levels.SILENT:log.setLevel("silent");break;case log.levels.ERROR:log.setLevel("error");break;case log.levels.WARN:log.setLevel("warn")}}(this.settings.logLevel),this.setOrUpdateMomentInstance()}))}saveSettings(){return __awaiter(this,void 0,void 0,(function*(){yield this.saveData(this.settings)}))}onMenuOpenCallback(menu,file,source){file instanceof obsidian.TFile&&"md"===file.extension&&menu.addItem((item=>{item.setIcon(iconInfo.file.id),item.setTitle("Lint file"),item.onClick((evt=>__awaiter(this,void 0,void 0,(function*(){this.runLinterFile(file)}))))}))}lintText(oldText,file){let newText=oldText;const disabledRules=function(text){const yaml=text.match(yamlRegex);if(!yaml)return[];const disabledRulesValue=getYamlSectionValue(yaml[1],"disabled rules");if(null==disabledRulesValue)return[];let disabledRulesKeyAndValue=disabledRulesValue.includes("\n")?"disabled rules:\n":"disabled rules: ";disabledRulesKeyAndValue+=disabledRulesValue;let disabled_rules=loadYAML(disabledRulesKeyAndValue)["disabled rules"];return disabled_rules?("string"==typeof disabled_rules&&(disabled_rules=[disabled_rules]),disabled_rules.includes("all")?rules.map((rule=>rule.alias())):disabled_rules):[]}(newText);[newText]=FormatTagsInYaml$1.applyIfEnabled(newText,this.settings,disabledRules),[newText]=EscapeYamlSpecialCharacters$1.applyIfEnabled(newText,this.settings,disabledRules);const createdAt=obsidian.moment(file.stat.ctime);createdAt.locale(this.momentLocale);const modifiedAt=obsidian.moment(file.stat.mtime);modifiedAt.locale(this.momentLocale);const modifiedAtTime=modifiedAt.format(),createdAtTime=createdAt.format();for(const rule of rules)disabledRules.includes(rule.alias())?logDebug(rule.alias()+" is disabled"):rule.hasSpecialExecutionOrder||([newText]=RuleBuilderBase.applyIfEnabledBase(rule,newText,this.settings,{fileCreatedTime:createdAtTime,fileModifiedTime:modifiedAtTime,fileName:file.basename,locale:this.momentLocale}));let isYamlTimestampEnabled,currentTime=obsidian.moment();currentTime.locale(this.momentLocale),[newText,isYamlTimestampEnabled]=YamlTimestamp$1.applyIfEnabled(newText,this.settings,disabledRules,{fileCreatedTime:createdAtTime,fileModifiedTime:modifiedAtTime,currentTime,alreadyModified:oldText!=newText,locale:this.momentLocale});const yamlTimestampOptions=YamlTimestamp$1.getRuleOptions(this.settings);return currentTime=obsidian.moment(),currentTime.locale(this.momentLocale),[newText]=YamlKeySort$1.applyIfEnabled(newText,this.settings,disabledRules,{currentTimeFormatted:currentTime.format(yamlTimestampOptions.format),yamlTimestampDateModifiedEnabled:isYamlTimestampEnabled&&yamlTimestampOptions.dateModified,dateModifiedKey:yamlTimestampOptions.dateModifiedKey}),newText}shouldIgnoreFile(file){for(const folder of this.settings.foldersToIgnore)if(folder.length>0&&file.path.startsWith(folder))return!0;return!1}runLinterFile(file){return __awaiter(this,void 0,void 0,(function*(){const oldText=function(text){return text.replace(/\r/g,"")}(yield this.app.vault.read(file)),newText=this.lintText(oldText,file);yield this.app.vault.modify(file,newText)}))}runLinterAllFiles(app){return __awaiter(this,void 0,void 0,(function*(){let numberOfErrors=0;if(yield Promise.all(app.vault.getMarkdownFiles().map((file=>__awaiter(this,void 0,void 0,(function*(){if(!this.shouldIgnoreFile(file))try{yield this.runLinterFile(file)}catch(error){this.handleLintError(file,error,"There is an error in the yaml of file '${file.path}': ","Lint All Files Error in File '${file.path}'"),numberOfErrors+=1}}))))),0===numberOfErrors)new obsidian.Notice("Linted all files");else{const amountOfErrorsMessage=1===numberOfErrors?"was 1 error":"were "+numberOfErrors+" errors";new obsidian.Notice("Linted all files and there "+amountOfErrorsMessage+".")}}))}runLinterAllFilesInFolder(folder){return __awaiter(this,void 0,void 0,(function*(){logInfo("Linting folder "+folder.name);let numberOfErrors=0,lintedFiles=0;const folderPath=obsidian.normalizePath(folder.path)+"/";if(yield Promise.all(this.app.vault.getMarkdownFiles().map((file=>__awaiter(this,void 0,void 0,(function*(){if(obsidian.normalizePath(file.path).startsWith(folderPath)&&!this.shouldIgnoreFile(file)){try{yield this.runLinterFile(file)}catch(error){this.handleLintError(file,error,"There is an error in the yaml of file '${file.path}': ","Lint All Files in Folder Error in File '${file.path}'"),numberOfErrors+=1}lintedFiles++}}))))),0===numberOfErrors)new obsidian.Notice("Linted all "+lintedFiles+" files in "+folder.name+".");else{const amountOfErrorsMessage=1===numberOfErrors?"was 1 error":"were "+numberOfErrors+" errors";new obsidian.Notice("Linted all "+lintedFiles+" files in "+folder.name+" and there "+amountOfErrorsMessage+".")}}))}createFolderLintModal(folder){const startMessage="This will edit all of your files in "+folder.name+" including files in its subfolders which may introduce errors.",submitBtnText="Lint All Files in "+folder.name,submitBtnNoticeText="Linting all files in "+folder.name+"...";new LintConfirmationModal(this.app,startMessage,submitBtnText,submitBtnNoticeText,(()=>this.runLinterAllFilesInFolder(folder))).open()}runLinterEditor(editor){logInfo("Running linter");const file=this.app.workspace.getActiveFile(),oldText=editor.getValue();let newText;try{newText=this.lintText(oldText,file)}catch(error){this.handleLintError(file,error,"There is an error in the yaml: ","Lint File Error in File '${file.path}'")}const changes=(new DiffMatchPatch.diff_match_patch).diff_main(oldText,newText);let curText="";changes.forEach((change=>{function endOfDocument(doc){const lines=doc.split("\n");return{line:lines.length-1,ch:lines[lines.length-1].length}}const[type,value]=change;if(type==DiffMatchPatch.DIFF_INSERT)editor.replaceRange(value,endOfDocument(curText)),curText+=value;else if(type==DiffMatchPatch.DIFF_DELETE){const start=endOfDocument(curText);let tempText=curText;tempText+=value;const end=endOfDocument(tempText);editor.replaceRange("",start,end)}else curText+=value}));const charsAdded=changes.map((change=>change[0]==DiffMatchPatch.DIFF_INSERT?change[1].length:0)).reduce(((a,b)=>a+b),0),charsRemoved=changes.map((change=>change[0]==DiffMatchPatch.DIFF_DELETE?change[1].length:0)).reduce(((a,b)=>a+b),0);this.displayChangedMessage(charsAdded,charsRemoved)}setOrUpdateMomentInstance(){var _a;return __awaiter(this,void 0,void 0,(function*(){const obsidianLang=localStorage.getItem("language")||"en",systemLang=null===(_a=navigator.language)||void 0===_a?void 0:_a.toLowerCase();let momentLocale=langToMomentLocale[obsidianLang];"system-default"!==this.settings.linterLocale?momentLocale=this.settings.linterLocale:systemLang.startsWith(obsidianLang)&&(momentLocale=systemLang),this.momentLocale=momentLocale;const oldLocale=obsidian.moment.locale();logDebug(`Trying to switch Moment.js locale to ${momentLocale}, got ${obsidian.moment.locale(momentLocale)}`),obsidian.moment.locale(oldLocale)}))}displayChangedMessage(charsAdded,charsRemoved){if(this.settings.displayChanged){const message=dedent`
        ${charsAdded} characters added
        ${charsRemoved} characters removed
      `;new obsidian.Notice(message)}}handleLintError(file,error,yamlErrorStringTemplate,logErrorStringTemplate){if(error instanceof YAMLException){let errorMessage=error.toString();errorMessage=errorMessage.substring(errorMessage.indexOf(":")+1),new obsidian.Notice(yamlErrorStringTemplate.replace("${file.path}",file.path)+errorMessage)}else new obsidian.Notice("An error occurred during linting. See console for details");!function(labelForError,error){let message=`[Obsidian Linter] ${labelForError}:\n`;error.stack?message+=error.stack:message+=`${error.name} ${error.message}`,log.error(message)}(logErrorStringTemplate.replace("${file.path}",file.path),error)}}class SettingTab extends obsidian.PluginSettingTab{constructor(app,plugin){super(app,plugin),this.plugin=plugin}display(){const{containerEl}=this;containerEl.empty(),containerEl.createEl("h2",{text:"General Settings"}),new obsidian.Setting(containerEl).setName("Lint on save").setDesc("Lint the file on manual save (when `Ctrl + S` is pressed or when `:w` is executed while using vim keybindings)").addToggle((toggle=>{toggle.setValue(this.plugin.settings.lintOnSave).onChange((value=>__awaiter(this,void 0,void 0,(function*(){this.plugin.settings.lintOnSave=value,yield this.plugin.saveSettings()}))))})),new obsidian.Setting(containerEl).setName("Display message on lint").setDesc("Display the number of characters changed after linting").addToggle((toggle=>{toggle.setValue(this.plugin.settings.displayChanged).onChange((value=>__awaiter(this,void 0,void 0,(function*(){this.plugin.settings.displayChanged=value,yield this.plugin.saveSettings()}))))})),new obsidian.Setting(containerEl).setName("Folders to ignore").setDesc("Folders to ignore when linting all files or linting on save. Enter folder paths separated by newlines").addTextArea((textArea=>{textArea.setValue(this.plugin.settings.foldersToIgnore.join("\n")).onChange((value=>__awaiter(this,void 0,void 0,(function*(){this.plugin.settings.foldersToIgnore=value.split("\n"),yield this.plugin.saveSettings()}))))})),this.addLocaleOverrideSetting();let prevSection="";for(const rule of rules){rule.type!==prevSection&&(containerEl.createEl("h2",{text:rule.type}),prevSection=rule.type),containerEl.createEl("h3",{},(el=>{el.innerHTML=`<a href="${rule.getURL()}">${rule.name}</a>`}));for(const option of rule.options)option.display(containerEl,this.plugin.settings,this.plugin)}}addLocaleOverrideSetting(){var _a;const sysLocale=null===(_a=navigator.language)||void 0===_a?void 0:_a.toLowerCase();new obsidian.Setting(this.containerEl).setName("Override locale:").setDesc("Set this if you want to use a locale different from the default").addDropdown((dropdown=>{dropdown.addOption("system-default",`Same as system (${sysLocale})`),obsidian.moment.locales().forEach((locale=>{dropdown.addOption(locale,locale)})),dropdown.setValue(this.plugin.settings.linterLocale),dropdown.onChange((value=>__awaiter(this,void 0,void 0,(function*(){this.plugin.settings.linterLocale=value,yield this.plugin.setOrUpdateMomentInstance(),yield this.plugin.saveSettings()}))))}))}}class LintConfirmationModal extends obsidian.Modal{constructor(app,startModalMessageText,submitBtnText,submitBtnNoticeText,btnSubmitAction){super(app),this.modalEl.addClass("confirm-modal"),this.contentEl.createEl("h3",{text:"Warning"}),this.contentEl.createEl("p",{text:startModalMessageText+" Make sure you have backed up your files."}).id="confirm-dialog",this.contentEl.createDiv("modal-button-container",(buttonsEl=>{buttonsEl.createEl("button",{text:"Cancel"}).addEventListener("click",(()=>this.close()));const btnSubmit=buttonsEl.createEl("button",{attr:{type:"submit"},cls:"mod-cta",text:submitBtnText});btnSubmit.addEventListener("click",(e=>__awaiter(this,void 0,void 0,(function*(){new obsidian.Notice(submitBtnNoticeText),this.close(),yield btnSubmitAction()})))),setTimeout((()=>{btnSubmit.focus()}),50)}))}}module.exports=LinterPlugin;