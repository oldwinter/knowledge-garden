var mn=Object.defineProperty;var li=Object.getOwnPropertyDescriptor;var ci=Object.getOwnPropertyNames;var pi=Object.prototype.hasOwnProperty;var ui=(e,t)=>{for(var n in t)mn(e,n,{get:t[n],enumerable:!0})},fi=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ci(t))!pi.call(e,i)&&i!==n&&mn(e,i,{get:()=>t[i],enumerable:!(r=li(t,i))||r.enumerable});return e};var di=e=>fi(mn({},"__esModule",{value:!0}),e);var So={};ui(So,{default:()=>ut});module.exports=di(So);var oe=require("obsidian");var se=require("obsidian"),Ee,xe,qn=0,K;function Gn(e){K=e}function vt(){return Ee}function $t(){return xe}function qt(){var r,i;if(K.showCountsActive!=!0)return;xe=[],K.app.metadataCache.iterateReferences((o,l)=>{let a=(0,se.parseLinktext)(l.link);if(a.path===""&&(a.path=o.replace(".md","")),a!=null&&a.path){let s=K.app.metadataCache.getFirstLinkpathDest(a.path,"/"),f=s===null?"":s.path.replace(".md","")+(0,se.stripHeading)(a.subpath),p=s===null?a.path:"",m=K.app.metadataCache.getFirstLinkpathDest(o,"/");if(K.settings.enableIgnoreObsExcludeFoldersLinksFrom&&K.app.metadataCache.isUserIgnored(m==null?void 0:m.path)||K.settings.enableIgnoreObsExcludeFoldersLinksTo&&K.app.metadataCache.isUserIgnored(f))return;xe.push({reference:{displayText:l.displayText,link:f!=""?f:p,position:l.position},resolvedFile:s,ghostLink:p,realLink:l.link,sourceFile:m,excludedFile:!1})}});let e=Object.entries(app.metadataCache.metadataCache).filter(o=>{var l,a;return(a=(l=o[1])==null?void 0:l.frontmatter)==null?void 0:a["snw-index-exclude"]}),t=Object.entries(app.metadataCache.fileCache).filter(o=>e.find(l=>l[0]===o[1].hash));for(let o=0;o<xe.length;o++)if(xe[o].excludedFile=!1,(i=(r=xe[o])==null?void 0:r.resolvedFile)!=null&&i.path){let l=xe[o].resolvedFile.path;for(let a=0;a<t.length;a++)if(l==t[a][0]){xe[o].excludedFile=!0;break}}Ee=xe.reduce((o,l)=>{let a="";return a=l.reference.link,o[a]||(o[a]=[]),o[a].push(l),o},{}),window.snwAPI.references=Ee,qn=Date.now()}var gn=new Map;function ge(e){if(gn.has(e.path)){let i=gn.get(e.path);if(qn<i.createDate&&i.createDate+K.settings.cacheUpdateInMilliseconds>Date.now())return i}if(K.showCountsActive!=!0)return;let t={},n=K.app.metadataCache.getFileCache(e);if(!n)return t;Ee||qt();let r=Object.values(K.app.metadataCache.metadataCache).reduce((i,o)=>{let l=o.headings;return l&&l.forEach(a=>{i.push(a.heading)}),i},[]);if(n!=null&&n.blocks){let i=e.path.replace(".md","");t.blocks=Object.values(n.blocks).map(o=>({key:i+o.id,pos:o.position,page:e.basename,type:"block",references:Ee[i+o.id]||[]}))}return n!=null&&n.headings&&(t.headings=n.headings.map(i=>({original:"#".repeat(i.level)+" "+i.heading,key:`${e.path.replace(".md","")}${(0,se.stripHeading)(i.heading)}`,headerMatch:i.heading,headerMatch2:e.basename+"#"+i.heading,pos:i.position,page:e.basename,type:"heading",references:Ee[`${e.path.replace(".md","")}${(0,se.stripHeading)(i.heading)}`]||[]}))),n!=null&&n.links&&(t.links=n.links.map(i=>{let o=Ce(i.link);return o===""&&(o=i.link),(o.startsWith("#^")||o.startsWith("#"))&&(o=e.path.replace(".md","")+(0,se.stripHeading)(o)),{key:o,original:i.original,type:"link",pos:i.position,page:e.basename,references:Ee[o]||[]}}),t.links&&(t.links=t.links.map(i=>{if(i.key.includes("#")&&!i.key.includes("#^")){let o=r.filter(l=>(0,se.stripHeading)(l)===i.key.split("#")[1])[0];i.original=o||void 0}return i}))),n!=null&&n.embeds&&(t.embeds=n.embeds.map(i=>{let o=Ce(i.link);return o===""&&(i.link.startsWith("#^")||i.link.startsWith("#"))&&(o=e.path.replace(".md","")+(0,se.stripHeading)(i.link)),{key:o,page:e.basename,type:"embed",pos:i.position,references:Ee[o]||[]}}),t.embeds&&(t.embeds=t.embeds.map(i=>{if(i.key.includes("#")&&!i.key.includes("#^")&&t.headings){let o=r.filter(l=>l.includes(i.key.split("#")[1]))[0];i.original=o||void 0}return(i.key.startsWith("#^")||i.key.startsWith("#"))&&(i.key=`${e.basename}${i.key}`,i.references=Ee[i.key]||[]),i}))),t.cacheMetaData=n,t.createDate=Date.now(),gn.set(e.path,t),t}function Ce(e){let t=(0,se.parseLinktext)(e),n=K.app.metadataCache.getFirstLinkpathDest(t.path,"/");return n===null?"":n.path.replace(".md","")+(0,se.stripHeading)(t.subpath)}var Le=require("@codemirror/view"),Ke=require("obsidian");var N="top",B="bottom",V="right",H="left",Gt="auto",Ae=[N,B,V,H],ke="start",Be="end",Yn="clippingParents",Yt="viewport",nt="popper",Xn="reference",hn=Ae.reduce(function(e,t){return e.concat([t+"-"+ke,t+"-"+Be])},[]),Xt=[].concat(Ae,[Gt]).reduce(function(e,t){return e.concat([t,t+"-"+ke,t+"-"+Be])},[]),mi="beforeRead",gi="read",hi="afterRead",vi="beforeMain",bi="main",wi="afterMain",yi="beforeWrite",Pi="write",xi="afterWrite",zn=[mi,gi,hi,vi,bi,wi,yi,Pi,xi];function _(e){return e?(e.nodeName||"").toLowerCase():null}function D(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function te(e){var t=D(e).Element;return e instanceof t||e instanceof Element}function j(e){var t=D(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function rt(e){if(typeof ShadowRoot=="undefined")return!1;var t=D(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Ei(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},i=t.attributes[n]||{},o=t.elements[n];!j(o)||!_(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(l){var a=i[l];a===!1?o.removeAttribute(l):o.setAttribute(l,a===!0?"":a)}))})}function Ci(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var i=t.elements[r],o=t.attributes[r]||{},l=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]),a=l.reduce(function(s,f){return s[f]="",s},{});!j(i)||!_(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(s){i.removeAttribute(s)}))})}}var bt={name:"applyStyles",enabled:!0,phase:"write",fn:Ei,effect:Ci,requires:["computeStyles"]};function U(e){return e.split("-")[0]}var le=Math.max,je=Math.min,Te=Math.round;function it(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function wt(){return!/^((?!chrome|android).)*safari/i.test(it())}function ne(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var r=e.getBoundingClientRect(),i=1,o=1;t&&j(e)&&(i=e.offsetWidth>0&&Te(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&Te(r.height)/e.offsetHeight||1);var l=te(e)?D(e):window,a=l.visualViewport,s=!wt()&&n,f=(r.left+(s&&a?a.offsetLeft:0))/i,p=(r.top+(s&&a?a.offsetTop:0))/o,m=r.width/i,v=r.height/o;return{width:m,height:v,top:p,right:f+m,bottom:p+v,left:f,x:f,y:p}}function _e(e){var t=ne(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function yt(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&rt(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function z(e){return D(e).getComputedStyle(e)}function vn(e){return["table","td","th"].indexOf(_(e))>=0}function q(e){return((te(e)?e.ownerDocument:e.document)||window.document).documentElement}function Se(e){return _(e)==="html"?e:e.assignedSlot||e.parentNode||(rt(e)?e.host:null)||q(e)}function Kn(e){return!j(e)||z(e).position==="fixed"?null:e.offsetParent}function ki(e){var t=/firefox/i.test(it()),n=/Trident/i.test(it());if(n&&j(e)){var r=z(e);if(r.position==="fixed")return null}var i=Se(e);for(rt(i)&&(i=i.host);j(i)&&["html","body"].indexOf(_(i))<0;){var o=z(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function ce(e){for(var t=D(e),n=Kn(e);n&&vn(n)&&z(n).position==="static";)n=Kn(n);return n&&(_(n)==="html"||_(n)==="body"&&z(n).position==="static")?t:n||ki(e)||t}function Ue(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function $e(e,t,n){return le(e,je(t,n))}function Jn(e,t,n){var r=$e(e,t,n);return r>n?n:r}function Pt(){return{top:0,right:0,bottom:0,left:0}}function xt(e){return Object.assign({},Pt(),e)}function Et(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}var Ti=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,xt(typeof t!="number"?t:Et(t,Ae))};function Si(e){var t,n=e.state,r=e.name,i=e.options,o=n.elements.arrow,l=n.modifiersData.popperOffsets,a=U(n.placement),s=Ue(a),f=[H,V].indexOf(a)>=0,p=f?"height":"width";if(!(!o||!l)){var m=Ti(i.padding,n),v=_e(o),d=s==="y"?N:H,h=s==="y"?B:V,g=n.rects.reference[p]+n.rects.reference[s]-l[s]-n.rects.popper[p],b=l[s]-n.rects.reference[s],x=ce(o),E=x?s==="y"?x.clientHeight||0:x.clientWidth||0:0,y=g/2-b/2,c=m[d],k=E-v[p]-m[h],w=E/2-v[p]/2+y,L=$e(c,w,k),F=s;n.modifiersData[r]=(t={},t[F]=L,t.centerOffset=L-w,t)}}function Ii(e){var t=e.state,n=e.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||yt(t.elements.popper,i)&&(t.elements.arrow=i))}var Qn={name:"arrow",enabled:!0,phase:"main",fn:Si,effect:Ii,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function re(e){return e.split("-")[1]}var Li={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Oi(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:Te(n*i)/i||0,y:Te(r*i)/i||0}}function Zn(e){var t,n=e.popper,r=e.popperRect,i=e.placement,o=e.variation,l=e.offsets,a=e.position,s=e.gpuAcceleration,f=e.adaptive,p=e.roundOffsets,m=e.isFixed,v=l.x,d=v===void 0?0:v,h=l.y,g=h===void 0?0:h,b=typeof p=="function"?p({x:d,y:g}):{x:d,y:g};d=b.x,g=b.y;var x=l.hasOwnProperty("x"),E=l.hasOwnProperty("y"),y=H,c=N,k=window;if(f){var w=ce(n),L="clientHeight",F="clientWidth";if(w===D(n)&&(w=q(n),z(w).position!=="static"&&a==="absolute"&&(L="scrollHeight",F="scrollWidth")),w=w,i===N||(i===H||i===V)&&o===Be){c=B;var W=m&&w===k&&k.visualViewport?k.visualViewport.height:w[L];g-=W-r.height,g*=s?1:-1}if(i===H||(i===N||i===B)&&o===Be){y=V;var R=m&&w===k&&k.visualViewport?k.visualViewport.width:w[F];d-=R-r.width,d*=s?1:-1}}var I=Object.assign({position:a},f&&Li),O=p===!0?Oi({x:d,y:g},D(n)):{x:d,y:g};if(d=O.x,g=O.y,s){var A;return Object.assign({},I,(A={},A[c]=E?"0":"",A[y]=x?"0":"",A.transform=(k.devicePixelRatio||1)<=1?"translate("+d+"px, "+g+"px)":"translate3d("+d+"px, "+g+"px, 0)",A))}return Object.assign({},I,(t={},t[c]=E?g+"px":"",t[y]=x?d+"px":"",t.transform="",t))}function Di(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,l=o===void 0?!0:o,a=n.roundOffsets,s=a===void 0?!0:a;if(!1)var f;var p={placement:U(t.placement),variation:re(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Zn(Object.assign({},p,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:l,roundOffsets:s})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Zn(Object.assign({},p,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var er={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Di,data:{}};var zt={passive:!0};function Ai(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=i===void 0?!0:i,l=r.resize,a=l===void 0?!0:l,s=D(t.elements.popper),f=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&f.forEach(function(p){p.addEventListener("scroll",n.update,zt)}),a&&s.addEventListener("resize",n.update,zt),function(){o&&f.forEach(function(p){p.removeEventListener("scroll",n.update,zt)}),a&&s.removeEventListener("resize",n.update,zt)}}var tr={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ai,data:{}};var Mi={left:"right",right:"left",bottom:"top",top:"bottom"};function ot(e){return e.replace(/left|right|bottom|top/g,function(t){return Mi[t]})}var Ri={start:"end",end:"start"};function Kt(e){return e.replace(/start|end/g,function(t){return Ri[t]})}function qe(e){var t=D(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Ge(e){return ne(q(e)).left+qe(e).scrollLeft}function bn(e,t){var n=D(e),r=q(e),i=n.visualViewport,o=r.clientWidth,l=r.clientHeight,a=0,s=0;if(i){o=i.width,l=i.height;var f=wt();(f||!f&&t==="fixed")&&(a=i.offsetLeft,s=i.offsetTop)}return{width:o,height:l,x:a+Ge(e),y:s}}function wn(e){var t,n=q(e),r=qe(e),i=(t=e.ownerDocument)==null?void 0:t.body,o=le(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=le(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Ge(e),s=-r.scrollTop;return z(i||n).direction==="rtl"&&(a+=le(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:l,x:a,y:s}}function Ye(e){var t=z(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Jt(e){return["html","body","#document"].indexOf(_(e))>=0?e.ownerDocument.body:j(e)&&Ye(e)?e:Jt(Se(e))}function Me(e,t){var n;t===void 0&&(t=[]);var r=Jt(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),o=D(r),l=i?[o].concat(o.visualViewport||[],Ye(r)?r:[]):r,a=t.concat(l);return i?a:a.concat(Me(Se(l)))}function at(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Ni(e,t){var n=ne(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function nr(e,t,n){return t===Yt?at(bn(e,n)):te(t)?Ni(t,n):at(wn(q(e)))}function Fi(e){var t=Me(Se(e)),n=["absolute","fixed"].indexOf(z(e).position)>=0,r=n&&j(e)?ce(e):e;return te(r)?t.filter(function(i){return te(i)&&yt(i,r)&&_(i)!=="body"}):[]}function yn(e,t,n,r){var i=t==="clippingParents"?Fi(e):[].concat(t),o=[].concat(i,[n]),l=o[0],a=o.reduce(function(s,f){var p=nr(e,f,r);return s.top=le(p.top,s.top),s.right=je(p.right,s.right),s.bottom=je(p.bottom,s.bottom),s.left=le(p.left,s.left),s},nr(e,l,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Ct(e){var t=e.reference,n=e.element,r=e.placement,i=r?U(r):null,o=r?re(r):null,l=t.x+t.width/2-n.width/2,a=t.y+t.height/2-n.height/2,s;switch(i){case N:s={x:l,y:t.y-n.height};break;case B:s={x:l,y:t.y+t.height};break;case V:s={x:t.x+t.width,y:a};break;case H:s={x:t.x-n.width,y:a};break;default:s={x:t.x,y:t.y}}var f=i?Ue(i):null;if(f!=null){var p=f==="y"?"height":"width";switch(o){case ke:s[f]=s[f]-(t[p]/2-n[p]/2);break;case Be:s[f]=s[f]+(t[p]/2-n[p]/2);break;default:}}return s}function pe(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=r===void 0?e.placement:r,o=n.strategy,l=o===void 0?e.strategy:o,a=n.boundary,s=a===void 0?Yn:a,f=n.rootBoundary,p=f===void 0?Yt:f,m=n.elementContext,v=m===void 0?nt:m,d=n.altBoundary,h=d===void 0?!1:d,g=n.padding,b=g===void 0?0:g,x=xt(typeof b!="number"?b:Et(b,Ae)),E=v===nt?Xn:nt,y=e.rects.popper,c=e.elements[h?E:v],k=yn(te(c)?c:c.contextElement||q(e.elements.popper),s,p,l),w=ne(e.elements.reference),L=Ct({reference:w,element:y,strategy:"absolute",placement:i}),F=at(Object.assign({},y,L)),W=v===nt?F:w,R={top:k.top-W.top+x.top,bottom:W.bottom-k.bottom+x.bottom,left:k.left-W.left+x.left,right:W.right-k.right+x.right},I=e.modifiersData.offset;if(v===nt&&I){var O=I[i];Object.keys(R).forEach(function(A){var J=[V,B].indexOf(A)>=0?1:-1,Q=[N,B].indexOf(A)>=0?"y":"x";R[A]+=O[Q]*J})}return R}function Pn(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=n.boundary,o=n.rootBoundary,l=n.padding,a=n.flipVariations,s=n.allowedAutoPlacements,f=s===void 0?Xt:s,p=re(r),m=p?a?hn:hn.filter(function(h){return re(h)===p}):Ae,v=m.filter(function(h){return f.indexOf(h)>=0});v.length===0&&(v=m);var d=v.reduce(function(h,g){return h[g]=pe(e,{placement:g,boundary:i,rootBoundary:o,padding:l})[U(g)],h},{});return Object.keys(d).sort(function(h,g){return d[h]-d[g]})}function Wi(e){if(U(e)===Gt)return[];var t=ot(e);return[Kt(e),t,Kt(t)]}function Hi(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,l=n.altAxis,a=l===void 0?!0:l,s=n.fallbackPlacements,f=n.padding,p=n.boundary,m=n.rootBoundary,v=n.altBoundary,d=n.flipVariations,h=d===void 0?!0:d,g=n.allowedAutoPlacements,b=t.options.placement,x=U(b),E=x===b,y=s||(E||!h?[ot(b)]:Wi(b)),c=[b].concat(y).reduce(function(be,ae){return be.concat(U(ae)===Gt?Pn(t,{placement:ae,boundary:p,rootBoundary:m,padding:f,flipVariations:h,allowedAutoPlacements:g}):ae)},[]),k=t.rects.reference,w=t.rects.popper,L=new Map,F=!0,W=c[0],R=0;R<c.length;R++){var I=c[R],O=U(I),A=re(I)===ke,J=[N,B].indexOf(O)>=0,Q=J?"width":"height",G=pe(t,{placement:I,boundary:p,rootBoundary:m,altBoundary:v,padding:f}),Y=J?A?V:H:A?B:N;k[Q]>w[Q]&&(Y=ot(Y));var $=ot(Y),fe=[];if(o&&fe.push(G[O]<=0),a&&fe.push(G[Y]<=0,G[$]<=0),fe.every(function(be){return be})){W=I,F=!1;break}L.set(I,fe)}if(F)for(var de=h?3:1,Fe=function(ae){var we=c.find(function(Je){var ye=L.get(Je);if(ye)return ye.slice(0,ae).every(function(Qe){return Qe})});if(we)return W=we,"break"},me=de;me>0;me--){var We=Fe(me);if(We==="break")break}t.placement!==W&&(t.modifiersData[r]._skip=!0,t.placement=W,t.reset=!0)}}var rr={name:"flip",enabled:!0,phase:"main",fn:Hi,requiresIfExists:["offset"],data:{_skip:!1}};function ir(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function or(e){return[N,V,B,H].some(function(t){return e[t]>=0})}function Vi(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,l=pe(t,{elementContext:"reference"}),a=pe(t,{altBoundary:!0}),s=ir(l,r),f=ir(a,i,o),p=or(s),m=or(f);t.modifiersData[n]={referenceClippingOffsets:s,popperEscapeOffsets:f,isReferenceHidden:p,hasPopperEscaped:m},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":m})}var ar={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Vi};function Bi(e,t,n){var r=U(e),i=[H,N].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,l=o[0],a=o[1];return l=l||0,a=(a||0)*i,[H,V].indexOf(r)>=0?{x:a,y:l}:{x:l,y:a}}function ji(e){var t=e.state,n=e.options,r=e.name,i=n.offset,o=i===void 0?[0,0]:i,l=Xt.reduce(function(p,m){return p[m]=Bi(m,t.rects,o),p},{}),a=l[t.placement],s=a.x,f=a.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=s,t.modifiersData.popperOffsets.y+=f),t.modifiersData[r]=l}var sr={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ji};function _i(e){var t=e.state,n=e.name;t.modifiersData[n]=Ct({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var lr={name:"popperOffsets",enabled:!0,phase:"read",fn:_i,data:{}};function xn(e){return e==="x"?"y":"x"}function Ui(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,o=i===void 0?!0:i,l=n.altAxis,a=l===void 0?!1:l,s=n.boundary,f=n.rootBoundary,p=n.altBoundary,m=n.padding,v=n.tether,d=v===void 0?!0:v,h=n.tetherOffset,g=h===void 0?0:h,b=pe(t,{boundary:s,rootBoundary:f,padding:m,altBoundary:p}),x=U(t.placement),E=re(t.placement),y=!E,c=Ue(x),k=xn(c),w=t.modifiersData.popperOffsets,L=t.rects.reference,F=t.rects.popper,W=typeof g=="function"?g(Object.assign({},t.rects,{placement:t.placement})):g,R=typeof W=="number"?{mainAxis:W,altAxis:W}:Object.assign({mainAxis:0,altAxis:0},W),I=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,O={x:0,y:0};if(w){if(o){var A,J=c==="y"?N:H,Q=c==="y"?B:V,G=c==="y"?"height":"width",Y=w[c],$=Y+b[J],fe=Y-b[Q],de=d?-F[G]/2:0,Fe=E===ke?L[G]:F[G],me=E===ke?-F[G]:-L[G],We=t.elements.arrow,be=d&&We?_e(We):{width:0,height:0},ae=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Pt(),we=ae[J],Je=ae[Q],ye=$e(0,L[G],be[G]),Qe=y?L[G]/2-de-ye-we-R.mainAxis:Fe-ye-we-R.mainAxis,Oe=y?-L[G]/2+de+ye+Je+R.mainAxis:me+ye+Je+R.mainAxis,Ze=t.elements.arrow&&ce(t.elements.arrow),Mt=Ze?c==="y"?Ze.clientTop||0:Ze.clientLeft||0:0,ft=(A=I==null?void 0:I[c])!=null?A:0,Rt=Y+Qe-ft-Mt,Nt=Y+Oe-ft,dt=$e(d?je($,Rt):$,Y,d?le(fe,Nt):fe);w[c]=dt,O[c]=dt-Y}if(a){var mt,Ft=c==="x"?N:H,Wt=c==="x"?B:V,Pe=w[k],De=k==="y"?"height":"width",gt=Pe+b[Ft],He=Pe-b[Wt],ht=[N,H].indexOf(x)!==-1,Ht=(mt=I==null?void 0:I[k])!=null?mt:0,Vt=ht?gt:Pe-L[De]-F[De]-Ht+R.altAxis,Bt=ht?Pe+L[De]+F[De]-Ht-R.altAxis:He,jt=d&&ht?Jn(Vt,Pe,Bt):$e(d?Vt:gt,Pe,d?Bt:He);w[k]=jt,O[k]=jt-Pe}t.modifiersData[r]=O}}var cr={name:"preventOverflow",enabled:!0,phase:"main",fn:Ui,requiresIfExists:["offset"]};function En(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Cn(e){return e===D(e)||!j(e)?qe(e):En(e)}function $i(e){var t=e.getBoundingClientRect(),n=Te(t.width)/e.offsetWidth||1,r=Te(t.height)/e.offsetHeight||1;return n!==1||r!==1}function kn(e,t,n){n===void 0&&(n=!1);var r=j(t),i=j(t)&&$i(t),o=q(t),l=ne(e,i,n),a={scrollLeft:0,scrollTop:0},s={x:0,y:0};return(r||!r&&!n)&&((_(t)!=="body"||Ye(o))&&(a=Cn(t)),j(t)?(s=ne(t,!0),s.x+=t.clientLeft,s.y+=t.clientTop):o&&(s.x=Ge(o))),{x:l.left+a.scrollLeft-s.x,y:l.top+a.scrollTop-s.y,width:l.width,height:l.height}}function qi(e){var t=new Map,n=new Set,r=[];e.forEach(function(o){t.set(o.name,o)});function i(o){n.add(o.name);var l=[].concat(o.requires||[],o.requiresIfExists||[]);l.forEach(function(a){if(!n.has(a)){var s=t.get(a);s&&i(s)}}),r.push(o)}return e.forEach(function(o){n.has(o.name)||i(o)}),r}function Tn(e){var t=qi(e);return zn.reduce(function(n,r){return n.concat(t.filter(function(i){return i.phase===r}))},[])}function Sn(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function In(e){var t=e.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}var pr={placement:"bottom",modifiers:[],strategy:"absolute"};function ur(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function fr(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,i=t.defaultOptions,o=i===void 0?pr:i;return function(a,s,f){f===void 0&&(f=o);var p={placement:"bottom",orderedModifiers:[],options:Object.assign({},pr,o),modifiersData:{},elements:{reference:a,popper:s},attributes:{},styles:{}},m=[],v=!1,d={state:p,setOptions:function(x){var E=typeof x=="function"?x(p.options):x;g(),p.options=Object.assign({},o,p.options,E),p.scrollParents={reference:te(a)?Me(a):a.contextElement?Me(a.contextElement):[],popper:Me(s)};var y=Tn(In([].concat(r,p.options.modifiers)));if(p.orderedModifiers=y.filter(function(I){return I.enabled}),!1){var c;if(getBasePlacement(p.options.placement)===auto)var k;var w,L,F,W,R}return h(),d.update()},forceUpdate:function(){if(!v){var x=p.elements,E=x.reference,y=x.popper;if(ur(E,y)){p.rects={reference:kn(E,ce(y),p.options.strategy==="fixed"),popper:_e(y)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(I){return p.modifiersData[I.name]=Object.assign({},I.data)});for(var c=0,k=0;k<p.orderedModifiers.length;k++){if(p.reset===!0){p.reset=!1,k=-1;continue}var w=p.orderedModifiers[k],L=w.fn,F=w.options,W=F===void 0?{}:F,R=w.name;typeof L=="function"&&(p=L({state:p,options:W,name:R,instance:d})||p)}}}},update:Sn(function(){return new Promise(function(b){d.forceUpdate(),b(p)})}),destroy:function(){g(),v=!0}};if(!ur(a,s))return d;d.setOptions(f).then(function(b){!v&&f.onFirstUpdate&&f.onFirstUpdate(b)});function h(){p.orderedModifiers.forEach(function(b){var x=b.name,E=b.options,y=E===void 0?{}:E,c=b.effect;if(typeof c=="function"){var k=c({state:p,name:x,instance:d,options:y}),w=function(){};m.push(k||w)}})}function g(){m.forEach(function(b){return b()}),m=[]}return d}}var Gi=[tr,lr,er,bt,sr,rr,cr,Qn,ar],Ln=fr({defaultModifiers:Gi});var Yi="tippy-box",xr="tippy-content",Xi="tippy-backdrop",Er="tippy-arrow",Cr="tippy-svg-arrow",Xe={passive:!0,capture:!0},kr=function(){return document.body};function On(e,t,n){if(Array.isArray(e)){var r=e[t];return r==null?Array.isArray(n)?n[t]:n:r}return e}function Nn(e,t){var n={}.toString.call(e);return n.indexOf("[object")===0&&n.indexOf(t+"]")>-1}function Tr(e,t){return typeof e=="function"?e.apply(void 0,t):e}function dr(e,t){if(t===0)return e;var n;return function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)}}function zi(e){return e.split(/\s+/).filter(Boolean)}function st(e){return[].concat(e)}function mr(e,t){e.indexOf(t)===-1&&e.push(t)}function Ki(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function Ji(e){return e.split("-")[0]}function en(e){return[].slice.call(e)}function gr(e){return Object.keys(e).reduce(function(t,n){return e[n]!==void 0&&(t[n]=e[n]),t},{})}function kt(){return document.createElement("div")}function tn(e){return["Element","Fragment"].some(function(t){return Nn(e,t)})}function Qi(e){return Nn(e,"NodeList")}function Zi(e){return Nn(e,"MouseEvent")}function Sr(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function eo(e){return tn(e)?[e]:Qi(e)?en(e):Array.isArray(e)?e:en(document.querySelectorAll(e))}function Dn(e,t){e.forEach(function(n){n&&(n.style.transitionDuration=t+"ms")})}function hr(e,t){e.forEach(function(n){n&&n.setAttribute("data-state",t)})}function to(e){var t,n=st(e),r=n[0];return r!=null&&(t=r.ownerDocument)!=null&&t.body?r.ownerDocument:document}function no(e,t){var n=t.clientX,r=t.clientY;return e.every(function(i){var o=i.popperRect,l=i.popperState,a=i.props,s=a.interactiveBorder,f=Ji(l.placement),p=l.modifiersData.offset;if(!p)return!0;var m=f==="bottom"?p.top.y:0,v=f==="top"?p.bottom.y:0,d=f==="right"?p.left.x:0,h=f==="left"?p.right.x:0,g=o.top-r+m>s,b=r-o.bottom-v>s,x=o.left-n+d>s,E=n-o.right-h>s;return g||b||x||E})}function An(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){e[r](i,n)})}function vr(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var he={isTouch:!1},br=0;function ro(){he.isTouch||(he.isTouch=!0,window.performance&&document.addEventListener("mousemove",Ir))}function Ir(){var e=performance.now();e-br<20&&(he.isTouch=!1,document.removeEventListener("mousemove",Ir)),br=e}function io(){var e=document.activeElement;if(Sr(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function oo(){document.addEventListener("touchstart",ro,Xe),window.addEventListener("blur",io)}var ao=typeof window!="undefined"&&typeof document!="undefined",so=ao?!!window.msCrypto:!1;var lo={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},co={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},ue=Object.assign({appendTo:kr,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},lo,co),po=Object.keys(ue),uo=function(t){var n=Object.keys(t);n.forEach(function(r){ue[r]=t[r]})};function Lr(e){var t=e.plugins||[],n=t.reduce(function(r,i){var o=i.name,l=i.defaultValue;if(o){var a;r[o]=e[o]!==void 0?e[o]:(a=ue[o])!=null?a:l}return r},{});return Object.assign({},e,n)}function fo(e,t){var n=t?Object.keys(Lr(Object.assign({},ue,{plugins:t}))):po,r=n.reduce(function(i,o){var l=(e.getAttribute("data-tippy-"+o)||"").trim();if(!l)return i;if(o==="content")i[o]=l;else try{i[o]=JSON.parse(l)}catch(a){i[o]=l}return i},{});return r}function wr(e,t){var n=Object.assign({},t,{content:Tr(t.content,[e])},t.ignoreAttributes?{}:fo(e,t.plugins));return n.aria=Object.assign({},ue.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?t.interactive:n.aria.expanded,content:n.aria.content==="auto"?t.interactive?null:"describedby":n.aria.content},n}var mo=function(){return"innerHTML"};function Mn(e,t){e[mo()]=t}function yr(e){var t=kt();return e===!0?t.className=Er:(t.className=Cr,tn(e)?t.appendChild(e):Mn(t,e)),t}function Pr(e,t){tn(t.content)?(Mn(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?Mn(e,t.content):e.textContent=t.content)}function Rn(e){var t=e.firstElementChild,n=en(t.children);return{box:t,content:n.find(function(r){return r.classList.contains(xr)}),arrow:n.find(function(r){return r.classList.contains(Er)||r.classList.contains(Cr)}),backdrop:n.find(function(r){return r.classList.contains(Xi)})}}function Or(e){var t=kt(),n=kt();n.className=Yi,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=kt();r.className=xr,r.setAttribute("data-state","hidden"),Pr(r,e.props),t.appendChild(n),n.appendChild(r),i(e.props,e.props);function i(o,l){var a=Rn(t),s=a.box,f=a.content,p=a.arrow;l.theme?s.setAttribute("data-theme",l.theme):s.removeAttribute("data-theme"),typeof l.animation=="string"?s.setAttribute("data-animation",l.animation):s.removeAttribute("data-animation"),l.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth=typeof l.maxWidth=="number"?l.maxWidth+"px":l.maxWidth,l.role?s.setAttribute("role",l.role):s.removeAttribute("role"),(o.content!==l.content||o.allowHTML!==l.allowHTML)&&Pr(f,e.props),l.arrow?p?o.arrow!==l.arrow&&(s.removeChild(p),s.appendChild(yr(l.arrow))):s.appendChild(yr(l.arrow)):p&&s.removeChild(p)}return{popper:t,onUpdate:i}}Or.$$tippy=!0;var go=1,Qt=[],Zt=[];function ho(e,t){var n=wr(e,Object.assign({},ue,Lr(gr(t)))),r,i,o,l=!1,a=!1,s=!1,f=!1,p,m,v,d=[],h=dr(Rt,n.interactiveDebounce),g,b=go++,x=null,E=Ki(n.plugins),y={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},c={id:b,reference:e,popper:kt(),popperInstance:x,props:n,state:y,plugins:E,clearDelayTimeouts:Vt,setProps:Bt,setContent:jt,show:ni,hide:ri,hideWithInteractivity:ii,enable:ht,disable:Ht,unmount:oi,destroy:ai};if(!n.render)return c;var k=n.render(c),w=k.popper,L=k.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+c.id,c.popper=w,e._tippy=c,w._tippy=c;var F=E.map(function(u){return u.fn(c)}),W=e.hasAttribute("aria-expanded");return Ze(),de(),Y(),$("onCreate",[c]),n.showOnCreate&&gt(),w.addEventListener("mouseenter",function(){c.props.interactive&&c.state.isVisible&&c.clearDelayTimeouts()}),w.addEventListener("mouseleave",function(){c.props.interactive&&c.props.trigger.indexOf("mouseenter")>=0&&J().addEventListener("mousemove",h)}),c;function R(){var u=c.props.touch;return Array.isArray(u)?u:[u,0]}function I(){return R()[0]==="hold"}function O(){var u;return!!((u=c.props.render)!=null&&u.$$tippy)}function A(){return g||e}function J(){var u=A().parentNode;return u?to(u):document}function Q(){return Rn(w)}function G(u){return c.state.isMounted&&!c.state.isVisible||he.isTouch||p&&p.type==="focus"?0:On(c.props.delay,u?0:1,ue.delay)}function Y(u){u===void 0&&(u=!1),w.style.pointerEvents=c.props.interactive&&!u?"":"none",w.style.zIndex=""+c.props.zIndex}function $(u,P,C){if(C===void 0&&(C=!0),F.forEach(function(T){T[u]&&T[u].apply(T,P)}),C){var S;(S=c.props)[u].apply(S,P)}}function fe(){var u=c.props.aria;if(u.content){var P="aria-"+u.content,C=w.id,S=st(c.props.triggerTarget||e);S.forEach(function(T){var X=T.getAttribute(P);if(c.state.isVisible)T.setAttribute(P,X?X+" "+C:C);else{var ee=X&&X.replace(C,"").trim();ee?T.setAttribute(P,ee):T.removeAttribute(P)}})}}function de(){if(!(W||!c.props.aria.expanded)){var u=st(c.props.triggerTarget||e);u.forEach(function(P){c.props.interactive?P.setAttribute("aria-expanded",c.state.isVisible&&P===A()?"true":"false"):P.removeAttribute("aria-expanded")})}}function Fe(){J().removeEventListener("mousemove",h),Qt=Qt.filter(function(u){return u!==h})}function me(u){if(!(he.isTouch&&(s||u.type==="mousedown"))){var P=u.composedPath&&u.composedPath()[0]||u.target;if(!(c.props.interactive&&vr(w,P))){if(st(c.props.triggerTarget||e).some(function(C){return vr(C,P)})){if(he.isTouch||c.state.isVisible&&c.props.trigger.indexOf("click")>=0)return}else $("onClickOutside",[c,u]);c.props.hideOnClick===!0&&(c.clearDelayTimeouts(),c.hide(),a=!0,setTimeout(function(){a=!1}),c.state.isMounted||we())}}}function We(){s=!0}function be(){s=!1}function ae(){var u=J();u.addEventListener("mousedown",me,!0),u.addEventListener("touchend",me,Xe),u.addEventListener("touchstart",be,Xe),u.addEventListener("touchmove",We,Xe)}function we(){var u=J();u.removeEventListener("mousedown",me,!0),u.removeEventListener("touchend",me,Xe),u.removeEventListener("touchstart",be,Xe),u.removeEventListener("touchmove",We,Xe)}function Je(u,P){Qe(u,function(){!c.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&P()})}function ye(u,P){Qe(u,P)}function Qe(u,P){var C=Q().box;function S(T){T.target===C&&(An(C,"remove",S),P())}if(u===0)return P();An(C,"remove",m),An(C,"add",S),m=S}function Oe(u,P,C){C===void 0&&(C=!1);var S=st(c.props.triggerTarget||e);S.forEach(function(T){T.addEventListener(u,P,C),d.push({node:T,eventType:u,handler:P,options:C})})}function Ze(){I()&&(Oe("touchstart",ft,{passive:!0}),Oe("touchend",Nt,{passive:!0})),zi(c.props.trigger).forEach(function(u){if(u!=="manual")switch(Oe(u,ft),u){case"mouseenter":Oe("mouseleave",Nt);break;case"focus":Oe(so?"focusout":"blur",dt);break;case"focusin":Oe("focusout",dt);break}})}function Mt(){d.forEach(function(u){var P=u.node,C=u.eventType,S=u.handler,T=u.options;P.removeEventListener(C,S,T)}),d=[]}function ft(u){var P,C=!1;if(!(!c.state.isEnabled||mt(u)||a)){var S=((P=p)==null?void 0:P.type)==="focus";p=u,g=u.currentTarget,de(),!c.state.isVisible&&Zi(u)&&Qt.forEach(function(T){return T(u)}),u.type==="click"&&(c.props.trigger.indexOf("mouseenter")<0||l)&&c.props.hideOnClick!==!1&&c.state.isVisible?C=!0:gt(u),u.type==="click"&&(l=!C),C&&!S&&He(u)}}function Rt(u){var P=u.target,C=A().contains(P)||w.contains(P);if(!(u.type==="mousemove"&&C)){var S=De().concat(w).map(function(T){var X,ee=T._tippy,et=(X=ee.popperInstance)==null?void 0:X.state;return et?{popperRect:T.getBoundingClientRect(),popperState:et,props:n}:null}).filter(Boolean);no(S,u)&&(Fe(),He(u))}}function Nt(u){var P=mt(u)||c.props.trigger.indexOf("click")>=0&&l;if(!P){if(c.props.interactive){c.hideWithInteractivity(u);return}He(u)}}function dt(u){c.props.trigger.indexOf("focusin")<0&&u.target!==A()||c.props.interactive&&u.relatedTarget&&w.contains(u.relatedTarget)||He(u)}function mt(u){return he.isTouch?I()!==u.type.indexOf("touch")>=0:!1}function Ft(){Wt();var u=c.props,P=u.popperOptions,C=u.placement,S=u.offset,T=u.getReferenceClientRect,X=u.moveTransition,ee=O()?Rn(w).arrow:null,et=T?{getBoundingClientRect:T,contextElement:T.contextElement||A()}:e,$n={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(_t){var tt=_t.state;if(O()){var si=Q(),dn=si.box;["placement","reference-hidden","escaped"].forEach(function(Ut){Ut==="placement"?dn.setAttribute("data-placement",tt.placement):tt.attributes.popper["data-popper-"+Ut]?dn.setAttribute("data-"+Ut,""):dn.removeAttribute("data-"+Ut)}),tt.attributes.popper={}}}},Ve=[{name:"offset",options:{offset:S}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!X}},$n];O()&&ee&&Ve.push({name:"arrow",options:{element:ee,padding:3}}),Ve.push.apply(Ve,(P==null?void 0:P.modifiers)||[]),c.popperInstance=Ln(et,w,Object.assign({},P,{placement:C,onFirstUpdate:v,modifiers:Ve}))}function Wt(){c.popperInstance&&(c.popperInstance.destroy(),c.popperInstance=null)}function Pe(){var u=c.props.appendTo,P,C=A();c.props.interactive&&u===kr||u==="parent"?P=C.parentNode:P=Tr(u,[C]),P.contains(w)||P.appendChild(w),c.state.isMounted=!0,Ft()}function De(){return en(w.querySelectorAll("[data-tippy-root]"))}function gt(u){c.clearDelayTimeouts(),u&&$("onTrigger",[c,u]),ae();var P=G(!0),C=R(),S=C[0],T=C[1];he.isTouch&&S==="hold"&&T&&(P=T),P?r=setTimeout(function(){c.show()},P):c.show()}function He(u){if(c.clearDelayTimeouts(),$("onUntrigger",[c,u]),!c.state.isVisible){we();return}if(!(c.props.trigger.indexOf("mouseenter")>=0&&c.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(u.type)>=0&&l)){var P=G(!1);P?i=setTimeout(function(){c.state.isVisible&&c.hide()},P):o=requestAnimationFrame(function(){c.hide()})}}function ht(){c.state.isEnabled=!0}function Ht(){c.hide(),c.state.isEnabled=!1}function Vt(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function Bt(u){if(!c.state.isDestroyed){$("onBeforeUpdate",[c,u]),Mt();var P=c.props,C=wr(e,Object.assign({},P,gr(u),{ignoreAttributes:!0}));c.props=C,Ze(),P.interactiveDebounce!==C.interactiveDebounce&&(Fe(),h=dr(Rt,C.interactiveDebounce)),P.triggerTarget&&!C.triggerTarget?st(P.triggerTarget).forEach(function(S){S.removeAttribute("aria-expanded")}):C.triggerTarget&&e.removeAttribute("aria-expanded"),de(),Y(),L&&L(P,C),c.popperInstance&&(Ft(),De().forEach(function(S){requestAnimationFrame(S._tippy.popperInstance.forceUpdate)})),$("onAfterUpdate",[c,u])}}function jt(u){c.setProps({content:u})}function ni(){var u=c.state.isVisible,P=c.state.isDestroyed,C=!c.state.isEnabled,S=he.isTouch&&!c.props.touch,T=On(c.props.duration,0,ue.duration);if(!(u||P||C||S)&&!A().hasAttribute("disabled")&&($("onShow",[c],!1),c.props.onShow(c)!==!1)){if(c.state.isVisible=!0,O()&&(w.style.visibility="visible"),Y(),ae(),c.state.isMounted||(w.style.transition="none"),O()){var X=Q(),ee=X.box,et=X.content;Dn([ee,et],0)}v=function(){var Ve;if(!(!c.state.isVisible||f)){if(f=!0,w.offsetHeight,w.style.transition=c.props.moveTransition,O()&&c.props.animation){var fn=Q(),_t=fn.box,tt=fn.content;Dn([_t,tt],T),hr([_t,tt],"visible")}fe(),de(),mr(Zt,c),(Ve=c.popperInstance)==null||Ve.forceUpdate(),$("onMount",[c]),c.props.animation&&O()&&ye(T,function(){c.state.isShown=!0,$("onShown",[c])})}},Pe()}}function ri(){var u=!c.state.isVisible,P=c.state.isDestroyed,C=!c.state.isEnabled,S=On(c.props.duration,1,ue.duration);if(!(u||P||C)&&($("onHide",[c],!1),c.props.onHide(c)!==!1)){if(c.state.isVisible=!1,c.state.isShown=!1,f=!1,l=!1,O()&&(w.style.visibility="hidden"),Fe(),we(),Y(!0),O()){var T=Q(),X=T.box,ee=T.content;c.props.animation&&(Dn([X,ee],S),hr([X,ee],"hidden"))}fe(),de(),c.props.animation?O()&&Je(S,c.unmount):c.unmount()}}function ii(u){J().addEventListener("mousemove",h),mr(Qt,h),h(u)}function oi(){c.state.isVisible&&c.hide(),c.state.isMounted&&(Wt(),De().forEach(function(u){u._tippy.unmount()}),w.parentNode&&w.parentNode.removeChild(w),Zt=Zt.filter(function(u){return u!==c}),c.state.isMounted=!1,$("onHidden",[c]))}function ai(){c.state.isDestroyed||(c.clearDelayTimeouts(),c.unmount(),Mt(),delete e._tippy,c.state.isDestroyed=!0,$("onDestroy",[c]))}}function Tt(e,t){t===void 0&&(t={});var n=ue.plugins.concat(t.plugins||[]);oo();var r=Object.assign({},t,{plugins:n}),i=eo(e);if(!1)var o,l;var a=i.reduce(function(s,f){var p=f&&ho(f,r);return p&&s.push(p),s},[]);return tn(e)?a[0]:a}Tt.defaultProps=ue;Tt.setDefaultProps=uo;Tt.currentInput=he;var Dr=function(t){var n=t===void 0?{}:t,r=n.exclude,i=n.duration;Zt.forEach(function(o){var l=!1;if(r&&(l=Sr(r)?o.reference===r:o.popper===r.popper),!l){var a=o.props.duration;o.setProps({duration:i}),o.hide(),o.state.isDestroyed||o.setProps({duration:a})}})},Oc=Object.assign({},bt,{effect:function(t){var n=t.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});Tt.setDefaultProps({render:Or});var nn=Tt;var Lt=require("obsidian");var vo=(e,t)=>{let n=getComputedStyle(e),r=n.position==="absolute",i=t?/(auto|scroll|hidden)/:/(auto|scroll)/;if(n.position==="fixed")return document.body;for(let o=e;o=o.parentElement;)if(n=getComputedStyle(o),!(r&&n.position==="static")&&i.test(n.overflow+n.overflowY+n.overflowX))return o;return document.body},rn=e=>{let t=e.querySelectorAll(".search-result-file-matched-text");for(let n of Array.from(t))if(n instanceof HTMLElement){let r=vo(n,!0);r&&(r.scrollTop=n.offsetTop-r.offsetTop-r.offsetHeight/2)}};var jr=require("obsidian");var lt=require("obsidian");var St=(e,t)=>e.substring(t.start.offset,t.end.offset),Ar=(e,t)=>e.substring(t.start.offset-t.start.col,t.end.offset),Fn=(e,t)=>e.start.offset<=t.start.offset&&e.end.offset>=t.end.offset;var on=class{constructor(t,{listItems:n=[],headings:r=[],sections:i=[]}){this.fileContents=t;this.getListItemIndexContaining=t=>this.listItems.findIndex(({position:n})=>Fn(n,t));this.getSectionContaining=t=>this.sections.find(({position:n})=>Fn(n,t));this.getListItemWithDescendants=t=>{let n=this.listItems[t],r=[n];for(let i=t+1;i<this.listItems.length;i++){let o=this.listItems[i];if(o.parent<n.position.start.line)return r;r.push(o)}return r};this.listItems=n,this.headings=r,this.sections=i}getListBreadcrumbs(t){let n=[];if(this.listItems.length===0)return n;let r=this.getListItemIndexContaining(t);if(r<0)return n;let o=this.listItems[r],l=o.parent;if(this.isTopLevelListItem(o))return n;for(let a=r-1;a>=0;a--){let s=this.listItems[a];if(s.parent<l&&(n.unshift(s),l=s.parent),this.isTopLevelListItem(s))return n}return n}getFirstSectionUnder(t){return this.sections.find(n=>n.position.start.line>t.start.line)}getHeadingContaining(t){let n=this.getHeadingIndexContaining(t);return this.headings[n]}getHeadingBreadcrumbs(t){let n=[];if(this.headings.length===0)return n;let r=s=>{let f=this.headings[s].level,p=s-1;for(let m=p;m>=0;m--){let v=this.headings[m];v.level<f&&(f=v.level,n.unshift(v))}},i=this.getHeadingIndexContaining(t);if(i>=0)return r(i),n;let l=this.getIndexOfHeadingAbove(t);if(l>=0){let s=this.headings[l];return n.unshift(s),r(l),n}return n}isTopLevelListItem(t){return t.parent<=0}getIndexOfHeadingAbove(t){return this.headings.reduce((n,r,i)=>r.position.start.line<t.start.line?i:n,-1)}getHeadingIndexContaining(t){return this.headings.findIndex(n=>n.position.start.line===t.start.line)}};var Mr=e=>e.map(t=>t.trim()).filter(t=>t.length>0).join(" \u27A4 "),Rr=(e,t)=>Mr(t.map(n=>St(e,n.position)).map(n=>n.trim().replace(/^-\s+/,""))),Nr=(e,t)=>{let r=t[0].position.start.col;return t.map(i=>Ar(e,i.position).slice(r)).join(`
`)},Fr=e=>Mr(e.map(t=>t.heading));var Re;function Wr(e){Re=e}var Hr=async e=>{let t=createDiv();t.addClass("snw-ref-item-info"),t.addClass("search-result-file-match"),t.setAttribute("snw-data-line-number",e.reference.position.start.line.toString()),t.setAttribute("snw-data-file-name",e.sourceFile.path.replace(".md","")),t.setAttribute("data-href",e.sourceFile.path.replace(".md",""));let n=await bo(e);return t.appendChild(n),t},bo=async e=>{let t=await Re.app.vault.cachedRead(e.sourceFile),n=Re.app.metadataCache.getFileCache(e.sourceFile),r=e.reference.position,i=createDiv();i.setAttribute("uic","uic");let o=new on(t,n),l=o.getHeadingBreadcrumbs(r);if(l.length>0){let v=i.createDiv();v.addClass("snw-breadcrumbs"),v.createEl("span",{text:"H"}),await lt.MarkdownRenderer.renderMarkdown(Fr(l),v,e.sourceFile.path,Re)}let a=o.getListItemIndexContaining(r);if(a>=0){let v=o.getListBreadcrumbs(r);if(v.length>0){let g=i.createDiv();g.addClass("snw-breadcrumbs"),g.createEl("span",{text:"L"}),await lt.MarkdownRenderer.renderMarkdown(Rr(t,v),g,e.sourceFile.path,Re)}let d=o.getListItemWithDescendants(a),h=i.createDiv();await lt.MarkdownRenderer.renderMarkdown(Nr(t,d),h,e.sourceFile.path,Re)}else{let v=o.getSectionContaining(r),d=St(t,v.position);await lt.MarkdownRenderer.renderMarkdown(d,i,e.sourceFile.path,Re)}let f=o.getHeadingContaining(r);if(f){let v=o.getFirstSectionUnder(f.position);if(v){let d=i.createDiv();await lt.MarkdownRenderer.renderMarkdown(St(t,v.position),d,e.sourceFile.path,Re)}}let p=i.querySelectorAll("*"),m=Array.from(p).find(v=>v.textContent==e.reference.displayText);try{m.addClass("search-result-file-matched-text")}catch(v){}return i};var Vr=require("obsidian"),Br=async(e,t,n,r,i,o,l,a)=>{let s=createDiv();s.addClass(l?"snw-ref-title-popover":"snw-ref-title-side-pane"),s.addClass("tree-item-self"),s.addClass("is-clickable"),s.setAttribute("snw-ref-title-type",e),s.setAttribute("snw-ref-title-reallink",t),s.setAttribute("snw-ref-title-key",n),s.setAttribute("snw-data-file-name",r),s.setAttribute("snw-data-line-number",o.toString());let f=createDiv({cls:"snw-ref-title-popover-label"});if(f.innerText=t,s.append(f),l){let p=createSpan();p.addClass("snw-ref-title-popover-icon"),(0,Vr.setIcon)(p,"more-horizontal");let m=createSpan();m.appendChild(p),m.addClass("snw-ref-title-popover-open-sidepane-icon"),m.setAttribute("snw-ref-title-type",e),m.setAttribute("snw-ref-title-reallink",t),m.setAttribute("snw-ref-title-key",n),m.setAttribute("snw-data-file-name",r),m.setAttribute("snw-data-line-number",o.toString()),s.appendChild(m),setTimeout(async()=>{m&&(m.onclick=async v=>{v.stopPropagation(),Dr({duration:0});let d=v.target.closest(".snw-ref-title-popover-open-sidepane-icon"),h=d.getAttribute("snw-ref-title-type"),g=d.getAttribute("snw-ref-title-reallink"),b=d.getAttribute("snw-ref-title-key"),x=d.getAttribute("snw-data-file-name"),E=d.getAttribute("snw-data-line-number");a.activateView(h,g,b,x,Number(E))})},300)}return s};var It;function _r(e){It=e}var Wn=async(e,t,n,r,i,o)=>{let l=await wo(e,n,r),a=createDiv();a.append(await Br(e,t,n,r,l.refCount,i,o,It));let s=createDiv({cls:"snw-ref-area"});return s.append(l.response),a.append(s),a},wo=async(e,t,n)=>{let r=0,i=null;if(e==="File"){let f=$t().filter(p=>{var m;return p!=null&&p.resolvedFile?((m=p==null?void 0:p.resolvedFile)==null?void 0:m.path)===n:!1});r=f.length,i=f}else{let s=vt()[t];s===void 0&&(s=vt()[n+"#^"+t]);let f=await yo(s);r=f.length,i=f}let o=Array.from(new Set(i.map(s=>s.sourceFile.path))).map(s=>i.find(f=>f.sourceFile.path===s)),l=createDiv(),a=o.length;It.settings.maxFileCountToDisplay!=1e3&&a>=It.settings.maxFileCountToDisplay&&(a=It.settings.maxFileCountToDisplay);for(let s=0;s<a;s++){let f=o[s],p=createDiv();p.addClass("snw-ref-item-container"),p.addClass("tree-item"),l.appendChild(p);let m=createDiv();m.addClass("snw-ref-item-file"),m.addClass("tree-item-self"),m.addClass("search-result-file-title"),m.addClass("is-clickable"),m.setAttribute("snw-data-line-number","-1"),m.setAttribute("snw-data-file-name",f.sourceFile.path.replace(".md","")),m.setAttribute("data-href",f.sourceFile.path),m.setAttribute("href",f.sourceFile.path);let v=createDiv();v.addClass("snw-ref-item-file-icon"),v.addClass("tree-item-icon"),v.addClass("collapse-icon"),(0,jr.setIcon)(v,"file-box");let d=createDiv();d.addClass("snw-ref-item-file-label"),d.addClass("tree-item-inner"),d.innerText=f.sourceFile.basename,m.append(v),m.append(d),p.appendChild(m);let h=createDiv();h.addClass("snw-ref-item-collection-items"),h.addClass("search-result-file-matches"),p.appendChild(h);for(let g of i)f.sourceFile.path===g.sourceFile.path&&h.appendChild(await Hr(g))}return{response:l,refCount:r}},yo=async e=>e.sort((t,n)=>t.sourceFile.basename.localeCompare(n.sourceFile.basename)||Number(t.reference.position.start.line)-Number(n.reference.position.start.line));var ct=null;function Ur(e){ct=e,Wr(e)}var an=async e=>{let{refType:t,realLink:n,key:r,filePath:i,lineNu:o}=await Po(e),l=createDiv();l.addClass("snw-popover-container"),l.addClass("search-result-container"),l.appendChild(await Wn(t,n,r,i,o,!0)),e.setContent(l),setTimeout(async()=>{await qr(!1,l)},500),rn(l)},$r=async(e,t,n,r,i)=>{let o=createDiv();return o.addClass("snw-sidepane-container"),o.addClass("search-result-container"),o.append(await Wn(e,t,n,r,i,!1)),setTimeout(async()=>{await qr(!1,o)},500),o},qr=async(e,t)=>{t.querySelectorAll(".snw-ref-item-file, .snw-ref-item-info, .snw-ref-title-side-pane, .snw-ref-title-popover").forEach(r=>{r.getAttribute("snw-has-handler")||(r.setAttribute("snw-has-handler","true"),r.addEventListener("click",async i=>{var p,m;i.preventDefault();let o=i.target.closest(".snw-ref-item-file, .snw-ref-item-info, .snw-ref-title-side-pane, .snw-ref-title-popover"),l=Number(o.getAttribute("snw-data-line-number")),a=o.getAttribute("snw-data-file-name"),s=app.metadataCache.getFirstLinkpathDest(a,a);ct.app.workspace.getLeaf(Lt.Keymap.isModEvent(i)).openFile(s);let f=o.getAttribute("snw-ref-title-key");if(f){if(f.contains("#^")){let v=Object.entries((p=ct.app.metadataCache.getFileCache(s))==null?void 0:p.blocks);if(v){let d=f.match(/#\^(.+)$/g)[0].replace("#^","").toLowerCase();l=v.find(g=>g[0]===d)[1].position.start.line}}else if(f.contains("#")){let v=(m=ct.app.metadataCache.getFileCache(s))==null?void 0:m.headings;if(v){let d=f.match(/#(.+)/g)[0].replace("#","");l=v.find(g=>g.heading===d).position.start.line}}}l>0&&setTimeout(()=>{try{ct.app.workspace.getActiveViewOfType(Lt.MarkdownView).setEphemeralState({line:l})}catch(v){}},400)}),ct.app.internalPlugins.plugins["page-preview"].enabled===!0&&r.addEventListener("mouseover",i=>{i.preventDefault();let o=app.internalPlugins.plugins["page-preview"].instance.overrides["obsidian42-strange-new-worlds"]!=!1;if(o===!1||o===!0&&Lt.Keymap.isModifier(i,"Mod")){let l=i.target,a={scroll:Number(l.getAttribute("snw-data-line-number"))},s=l.getAttribute("snw-data-file-name");s&&app.workspace.trigger("link-hover",{},l,s,"",a)}}))})},Po=async e=>{let t=e.reference,n=t.getAttribute("data-snw-type"),r=t.getAttribute("data-snw-reallink"),i=t.getAttribute("data-snw-key"),o=t.getAttribute("data-snw-filepath"),l=Number(t.getAttribute("snw-data-line-number"));return{refType:n,realLink:r,key:i,filePath:o,lineNu:l}};var Hn=require("obsidian"),Z;function Gr(e){Z=e}function Ie(e,t,n,r,i,o,l){var f,p;(f=Z==null?void 0:Z.snwAPI.enableDebugging)!=null&&f.HtmlDecorationElements&&Z.snwAPI.console("htmlDecorations.htmlDecorationForReferencesElement(count, referenceType, realLink, key, filePath)",Z,e,t,n,r,i);let a=createDiv({cls:"snw-reference snw-"+t});return a.innerText=e.toString(),a.setAttribute("data-snw-type",t),a.setAttribute("data-snw-reallink",n),a.setAttribute("data-snw-key",r),a.setAttribute("data-snw-filepath",i),a.setAttribute("snw-data-line-number",l.toString()),o&&a.addClass(o),(Hn.Platform.isDesktop||Hn.Platform.isDesktopApp)&&(a.onclick=async m=>sn(m.target)),(p=Z==null?void 0:Z.snwAPI.enableDebugging)!=null&&p.HtmlDecorationElements&&Z.snwAPI.console("returned element",a),nn(a,{interactive:!0,appendTo:()=>document.body,allowHTML:!0,zIndex:9999,placement:"auto-end",onShow(m){setTimeout(async()=>{await an(m)},1)}}).popper.classList.add("snw-tippy"),a}var sn=async e=>{var l;let t=e.getAttribute("data-snw-type"),n=e.getAttribute("data-snw-realLink"),r=e.getAttribute("data-snw-key"),i=e.getAttribute("data-snw-filepath"),o=e.getAttribute("snw-data-line-number");(l=Z.snwAPI.enableDebugging)!=null&&l.HtmlDecorationElements&&Z.snwAPI.console("htmlDecorations.processHtmlDecorationReferenceEvent: target, realLink, key, refType, filePath",e,n,r,t,i),Z.activateView(t,n,r,i,Number(o))};var ze;function Yr(e){ze=e}var Xr=Le.ViewPlugin.fromClass(class{constructor(e){this.view=e;this.decorations=Le.Decoration.none;this.regxPattern="";ze.settings.enableRenderingBlockIdInLivePreview&&(this.regxPattern="(\\s\\^)(\\S+)$"),ze.settings.enableRenderingEmbedsInLivePreview&&(this.regxPattern+=(this.regxPattern!=""?"|":"")+"!\\[\\[(.*?)\\]\\]"),ze.settings.enableRenderingLinksInLivePreview&&(this.regxPattern+=(this.regxPattern!=""?"|":"")+"\\[\\[(.*?)\\]\\]"),ze.settings.enableRenderingHeadersInLivePreview&&(this.regxPattern+=(this.regxPattern!=""?"|":"")+"^#+\\s.+"),this.regxPattern!==""&&(this.decorator=new Le.MatchDecorator({regexp:new RegExp(this.regxPattern,"g"),decorate:(t,n,r,i,o)=>{var f,p,m,v,d,h,g,b;let l=o.state.field(Ke.editorInfoField),a=i[0].charAt(0),s=ge(l.file);if(((p=(f=s==null?void 0:s.cacheMetaData)==null?void 0:f.frontmatter)==null?void 0:p["snw-file-exclude"])!=!0&&((v=(m=s==null?void 0:s.cacheMetaData)==null?void 0:m.frontmatter)==null?void 0:v["snw-canvas-exclude-edit"])!=!0){let x=[];if(a===" "&&((d=s==null?void 0:s.blocks)==null?void 0:d.length)>0)x.push({key:l.file.path.replace(".md","")+i[0].replace(" ^",""),transformedCachedItem:s.blocks,refType:"block",from:r,to:r});else if(a==="!"&&((h=s==null?void 0:s.embeds)==null?void 0:h.length)>0){let E=i[0].replace("![[","").replace("]]","");E.startsWith("#")&&(E=l.file.path.replace(".md","")+(0,Ke.stripHeading)(E)),x.push({key:E,transformedCachedItem:s.embeds,refType:"embed",from:r,to:r})}else if(a==="["&&((g=s==null?void 0:s.links)==null?void 0:g.length)>0){let E=i[0].replace("[[","").replace("]]","");E.startsWith("#")&&(E=l.file.path.replace(".md","")+E),x.push({key:E,transformedCachedItem:s.links,refType:"link",from:r,to:r})}else if(a==="#"&&((b=s==null?void 0:s.headings)==null?void 0:b.length)>0&&(x.push({key:(0,Ke.stripHeading)(i[0].replace(/^#+/,"").substring(1)),transformedCachedItem:s.headings,refType:"heading",from:r,to:r}),ze.settings.enableRenderingLinksInLivePreview)){let E=i[0].match(/\[\[(.*?)\]\]|!\[\[(.*?)\]\]/g);if(E)for(let y of E)x.push({key:y.replace("![[","").replace("[[","").replace("]]",""),transformedCachedItem:y.startsWith("!")?s.embeds:s.links,refType:"link",from:r-i[0].length+(i[0].indexOf(y)+y.length),to:r-i[0].length+(i[0].indexOf(y)+y.length)})}for(let E of x.sort((y,c)=>y.to-c.to))if(E.key!=""){let y=xo(E.refType,E.key,E.transformedCachedItem,l.file.path);y!=null&&t(E.from,E.to,Le.Decoration.widget({widget:y,side:1}))}}}}),this.regxPattern!=""&&(this.decorations=this.decorator.createDeco(e)))}update(e){this.regxPattern!=""&&(e.docChanged||e.viewportChanged)&&(this.decorations=this.decorator.updateDeco(e,this.decorations))}},{decorations:e=>e.decorations}),xo=(e,t,n,r)=>{var i,o;for(let l=0;l<n.length;l++){let a=n[l],s=a.key;if(e==="heading"&&(s=(0,Ke.stripHeading)(a.headerMatch),t=t.replace(/^\s+|\s+$/g,"")),e==="embed"||e==="link"){t.contains("|")&&(t=t.substring(0,t.search(/\|/)));let f=Ce(t);t=f===""?t:f,s.startsWith("#")&&(s=r.replace(".md","")+(0,Ke.stripHeading)(s))}if(s===t){let f=(i=a==null?void 0:a.references[0])!=null&&i.resolvedFile?a.references[0].resolvedFile.path.replace(".md",""):t;return((o=a==null?void 0:a.references[0])==null?void 0:o.excludedFile)!=!0&&(a==null?void 0:a.references.length)>=ze.settings.minimumRefCountThreshold?new Vn(a.references.length,a.type,a.references[0].realLink,a.key,f,null,a.pos.start.line):null}}},Vn=class extends Le.WidgetType{constructor(n,r,i,o,l,a,s){super();this.referenceCount=n,this.referenceType=r,this.realLink=i,this.key=o,this.filePath=l,this.addCssClass=a,this.lineNu=s}toDOM(){return Ie(this.referenceCount,this.referenceType,this.realLink,this.key,this.filePath,this.addCssClass,this.lineNu)}destroy(){}ignoreEvent(){return!1}};var ln=require("obsidian");var ie;function zr(e){ie=e}function jn(e,t){var i,o,l,a;if(ie.snwAPI.enableDebugging.PreviewRendering&&ie.snwAPI.console("markdownPreviewProcessor(HTMLElement, MarkdownPostProcessorContext,ctx.getSectionInfo",e,t,t.getSectionInfo(e)),t.remainingNestLevel===4||((i=t==null?void 0:t.frontmatter)==null?void 0:i["snw-file-exclude"])===!0||((o=t==null?void 0:t.frontmatter)==null?void 0:o["snw-canvas-exclude-preview"])===!0||e.hasAttribute("uic"))return;let n=ie.app.vault.fileMap[t.sourcePath];if(n===void 0)return;let r=ie.app.metadataCache.getFileCache(n);if(!((l=r==null?void 0:r.frontmatter)!=null&&l["kanban-plugin"]||(a=t.el.parentElement)!=null&&a.classList.contains("kanban-plugin__markdown-preview-view")))try{t.addChild(new Bn(e,t.getSectionInfo(e),n))}catch(s){}}var Bn=class extends ln.MarkdownRenderChild{constructor(n,r,i){super(n);this.containerEl=n,this.sectionInfo=r,this.currentFile=i,ie.snwAPI.enableDebugging.PreviewRendering&&ie.snwAPI.console("snwChildComponent(HTMLElement, MarkdownPostProcessorContext,currentfile",n,r,i)}onload(){this.processMarkdown()}processMarkdown(){var i,o,l,a,s,f,p,m,v,d;let n=ie.settings.minimumRefCountThreshold,r=ge(this.currentFile);if(((o=(i=r==null?void 0:r.cacheMetaData)==null?void 0:i.frontmatter)==null?void 0:o["snw-file-exclude"])!==!0&&(r!=null&&r.blocks||r.embeds||r.headings||r.links)){if(ie.settings.enableRenderingBlockIdInMarkdown&&(r!=null&&r.blocks)){let h=!1;try{h=ctx.containerEl.closest(".snw-embed-preview").nextSibling.classList.contains("snw-reference")}catch(g){}for(let g of r.blocks)if(((l=g.references[0])==null?void 0:l.excludedFile)!=!0&&g.references.length>=n&&g.pos.start.line>=((a=this.sectionInfo)==null?void 0:a.lineStart)&&g.pos.end.line<=((s=this.sectionInfo)==null?void 0:s.lineEnd)&&!h){let b=Ie(g.references.length,"block",g.references[0].realLink,g.key,(p=(f=g.references[0])==null?void 0:f.resolvedFile)==null?void 0:p.path.replace(".md",""),"",g.pos.start.line),x=this.containerEl.querySelector("p"),E=g.pos.start.line-this.sectionInfo.lineStart;x?(x||(x=this.containerEl.querySelector(`ol[data-line="${E}"]`)),x.append(b)):(x=this.containerEl.querySelector(`li[data-line="${E}"]`),x.querySelector("ul")?x.querySelector("ul").before(b):x.append(b));try{x.hasClass("snw-block-preview")||b.addClass("snw-block-preview")}catch(y){}}}if(ie.settings.enableRenderingEmbedsInMarkdown&&(r!=null&&r.embeds)&&this.containerEl.querySelectorAll(".internal-embed:not(.snw-embed-preview)").forEach(h=>{var b,x,E;let g=Ce(h.getAttribute("src"));g===""&&(g=this.currentFile.path.replace(".md","")+(0,ln.stripHeading)(h.getAttribute("src")));for(let y of r.embeds)if(((b=y.references[0])==null?void 0:b.excludedFile)!=!0&&y.references.length>=n&&g.endsWith(y.key)){let c=Ie(y.references.length,"embed",y.references[0].realLink,y.key,(E=(x=y.references[0])==null?void 0:x.resolvedFile)==null?void 0:E.path.replace(".md",""),"",y.pos.start.line);c.addClass("snw-embed-preview"),h.after(c);break}}),ie.settings.enableRenderingHeadersInMarkdown){let h=this.containerEl.querySelector("[data-heading]");if(r!=null&&r.headings&&h){let g=h.getAttribute("data-heading");for(let b of r.headings)if(((m=b.references[0])==null?void 0:m.excludedFile)!=!0&&b.references.length>=n&&b.headerMatch===g){let x=Ie(b.references.length,"heading",b.references[0].realLink,b.key,(d=(v=b.references[0])==null?void 0:v.resolvedFile)==null?void 0:d.path.replace(".md",""),"",b.pos.start.line);x.addClass("snw-heading-preview"),this.containerEl.querySelector("h1,h2,h3,h4,h5,h6").insertAdjacentElement("beforeend",x);break}}}ie.settings.enableRenderingLinksInMarkdown&&(r!=null&&r.links)&&this.containerEl.querySelectorAll("a.internal-link:not(.snw-link-preview)").forEach(h=>{var b,x,E;let g=Ce(h.getAttribute("data-href"));for(let y of r.links)if(((b=y.references[0])==null?void 0:b.excludedFile)!=!0&&y.references.length>=n&&(y.key===g||(y==null?void 0:y.original)!=null&&(y!=null&&y.original.contains(g)))){let c=Ie(y.references.length,"link",y.references[0].realLink,y.key,(E=(x=y.references[0])==null?void 0:x.resolvedFile)==null?void 0:E.path.replace(".md",""),"",y.pos.start.line);c.addClass("snw-link-preview"),h.after(c);break}})}}};var Ot=require("@codemirror/view"),cn=require("obsidian");var pt;function Kr(e){pt=e}var Eo=class extends Ot.GutterMarker{constructor(t,n,r,i,o,l){super();this.referenceCount=t,this.referenceType=n,this.realLink=r,this.key=i,this.filePath=o,this.addCssClass=l}toDOM(){return Ie(this.referenceCount,this.referenceType,this.realLink,this.key,this.filePath,this.addCssClass,0)}},Co=new class extends Ot.GutterMarker{toDOM(){return document.createTextNode("\xF8\xF8\xF8")}},ko=(0,Ot.gutter)({class:"snw-gutter-ref",lineMarker(e,t){var o,l,a,s,f,p;pt.snwAPI.enableDebugging.GutterEmbedCounter&&pt.snwAPI.console("ReferenceGutterExtension(EditorView, BlockInfo)",e,t);let n=e.state.field(cn.editorInfoField);if(!n.file)return;let r=ge(n.file);if(((l=(o=r==null?void 0:r.cacheMetaData)==null?void 0:o.frontmatter)==null?void 0:l["snw-file-exclude"])===!0||((s=(a=r==null?void 0:r.cacheMetaData)==null?void 0:a.frontmatter)==null?void 0:s["snw-canvas-exclude-edit"])===!0)return;let i=(f=n.app.metadataCache.getFileCache(n.file))==null?void 0:f.embeds;if((i==null?void 0:i.length)>=pt.settings.minimumRefCountThreshold){let m=e.state.doc.lineAt(t.from).number;for(let v of i)if(v.position.start.line+1===m){for(let d of r.embeds)if(((p=d==null?void 0:d.references[0])==null?void 0:p.excludedFile)!=!0&&(d==null?void 0:d.references.length)>0&&(d==null?void 0:d.pos.start.line)+1===m){let h=e.state.doc.lineAt(t.from).text.trim();if(h.startsWith("!")){let g=h.replace("![[","").replace("]]",""),b="";if(g.startsWith("#")?b=n.file.path.replace(".md","")+(0,cn.stripHeading)(g):b=Ce(g),b===d.key)return pt.snwAPI.enableDebugging.GutterEmbedCounter&&pt.snwAPI.console("ReferenceGutterExtension New gutter",d.references.length,"embed",d.key,d.key,"snw-embed-special"),new Eo(d.references.length,"embed",d.references[0].realLink,d.key,d.references[0].resolvedFile.path.replace(".md",""),"snw-embed-special")}}}}},initialSpacer:()=>Co}),Jr=ko;var _n=require("obsidian");var ve;function Qr(e){ve=e}function Un(){var e;(e=ve.snwAPI.enableDebugging)!=null&&e.LinkCountInHeader&&ve.snwAPI.console("headerImageCount.setHeaderWithReferenceCounts(thePlugin)",ut),ve.app.workspace.iterateAllLeaves(t=>{t.view.getViewType()==="markdown"&&To(t.view)})}function To(e){var f,p,m,v,d;(f=ve.snwAPI.enableDebugging)!=null&&f.LinkCountInHeader&&ve.snwAPI.console("headerImageCount.processHeader(ThePlugin, MarkdownView)",ve,e);let t=$t();if(t==null)return;let n=t.filter(h=>{var g;return h!=null&&h.resolvedFile?((g=h==null?void 0:h.resolvedFile)==null?void 0:g.path)===e.file.path:!1}),r=n.length,i=ge(e.file);if(((m=(p=i==null?void 0:i.cacheMetaData)==null?void 0:p.frontmatter)==null?void 0:m["snw-file-exclude"])===!0&&(r=0),((v=n[0])==null?void 0:v.excludedFile)===!0&&(r=0),r<ve.settings.minimumRefCountThreshold){e.contentEl.querySelector(".snw-header-count-wrapper")&&e.contentEl.querySelector(".snw-header-count-wrapper").remove();return}let o=e.contentEl.querySelector(".snw-header-count");if(o&&o.getAttribute("data-snw-key")===e.file.basename){o.innerText=" "+n.length.toString()+" ";return}let l=e.contentEl;e.contentEl.querySelector(".snw-header-count-wrapper")&&e.contentEl.querySelector(".snw-header-count-wrapper").remove();let a=l.querySelector(".snw-header-count-wrapper");a?o=l.querySelector(".snw-header-count"):(a=createDiv({cls:"snw-header-count-wrapper"}),o=createDiv({cls:"snw-header-count"}),a.appendChild(o),l.prepend(a)),o.innerText=" "+n.length.toString()+" ",(_n.Platform.isDesktop||_n.Platform.isDesktopApp)&&(o.onclick=h=>{h.stopPropagation(),sn(a)}),a.setAttribute("data-snw-reallink",e.file.basename),a.setAttribute("data-snw-key",e.file.basename),a.setAttribute("data-snw-type","File"),a.setAttribute("data-snw-filepath",e.file.path),a.onclick=h=>{h.stopPropagation(),sn(h.target)},nn(a,{interactive:!0,appendTo:()=>document.body,allowHTML:!0,zIndex:9999,placement:"auto-end",onShow(h){setTimeout(async()=>{await an(h)},1)}}).popper.classList.add("snw-tippy"),(d=ve.snwAPI.enableDebugging)!=null&&d.LinkCountInHeader&&ve.snwAPI.console("snwTitleRefCountDisplayCountEl",o)}var Zr=require("obsidian");var Ne="Strange New Worlds",pn=class extends Zr.ItemView{constructor(n,r){super(n);this.thePlugin=r}getViewType(){return Ne}getDisplayText(){return Ne}getIcon(){return"file-digit"}async onOpen(){let n=this.containerEl,r=n.createSpan({cls:"snw-sidepane-loading"}),i=createDiv({cls:"snw-sidepane-loading-banner"});i.innerText="Discovering Strange New Worlds...",r.appendChild(i);let o=createDiv({cls:"snw-sidepane-loading-subtext"});o.innerText="Click a reference counter in the main document for information to appear here.",r.appendChild(o),n.empty(),n.appendChild(r)}async updateView(){let n=this.thePlugin.lastSelectedReferenceType,r=this.thePlugin.lastSelectedReferenceRealLink,i=this.thePlugin.lastSelectedReferenceKey,o=this.thePlugin.lastSelectedReferenceFilePath,l=this.thePlugin.lastSelectedLineNumber;this.thePlugin.snwAPI.enableDebugging.SidePane&&(this.thePlugin.snwAPI.console("sidepane.open() refType, realLink, key, filePath",n,r,i,o),this.thePlugin.snwAPI.console("sidepane.open() getReferencesCache()",vt())),this.containerEl.replaceChildren(await $r(n,r,i,o,l)),rn(this.containerEl)}async onClose(){}};var M=require("obsidian"),ei={enableOnStartupDesktop:!0,enableOnStartupMobile:!0,minimumRefCountThreshold:1,maxFileCountToDisplay:100,displayIncomingFilesheader:!0,displayInlineReferencesLivePreview:!0,displayInlineReferencesMarkdown:!0,displayEmbedReferencesInGutter:!0,displayEmbedReferencesInGutterMobile:!1,cacheUpdateInMilliseconds:500,enableRenderingBlockIdInMarkdown:!0,enableRenderingLinksInMarkdown:!0,enableRenderingHeadersInMarkdown:!0,enableRenderingEmbedsInMarkdown:!0,enableRenderingBlockIdInLivePreview:!0,enableRenderingLinksInLivePreview:!0,enableRenderingHeadersInLivePreview:!0,enableRenderingEmbedsInLivePreview:!0,enableIgnoreObsExcludeFoldersLinksFrom:!1,enableIgnoreObsExcludeFoldersLinksTo:!1},un=class extends M.PluginSettingTab{constructor(n,r){super(n,r);this.thePlugin=r}display(){let{containerEl:n}=this;n.empty(),n.createEl("h2",{text:this.thePlugin.appName}),n.createEl("h2",{text:"Thresholds"}),new M.Setting(n).setName("Minimal required count to show counter").setDesc(`This setting defines how many references there needs to be for the reference count box to appear. May require reloading open files.
				 Currently set to: ${this.thePlugin.settings.minimumRefCountThreshold} references.`).addSlider(r=>r.setLimits(1,1e3,1).setValue(this.thePlugin.settings.minimumRefCountThreshold).onChange(async i=>{this.thePlugin.settings.minimumRefCountThreshold=i,await this.thePlugin.saveSettings()}).setDynamicTooltip()),new M.Setting(n).setName("Maximum file references to show").setDesc(`This setting defines the max amount of files with their references are displayed in the popup or sidebar.  Set to 1000 for no maximum.
				 Currently set to: ${this.thePlugin.settings.maxFileCountToDisplay} references.`).addSlider(r=>r.setLimits(1,1e3,1).setValue(this.thePlugin.settings.maxFileCountToDisplay).onChange(async i=>{this.thePlugin.settings.maxFileCountToDisplay=i,await this.thePlugin.saveSettings()}).setDynamicTooltip()),n.createEl("h2",{text:"Use Obsidian's Excluded Files list (Settings > Files & Links)"}),new M.Setting(n).setName("Outgoing links").setDesc("If enabled, links FROM files in the excluded folder will not be included in SNW's reference counters. May require restarting Obsidian.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableIgnoreObsExcludeFoldersLinksFrom),r.onChange(async i=>{this.thePlugin.settings.enableIgnoreObsExcludeFoldersLinksFrom=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Incoming links").setDesc("If enabled, links TO files in the excluded folder will not be included in SNW's reference counters.  May require restarting Obsidian.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableIgnoreObsExcludeFoldersLinksTo),r.onChange(async i=>{this.thePlugin.settings.enableIgnoreObsExcludeFoldersLinksTo=i,await this.thePlugin.saveSettings()})}),n.createEl("h2",{text:"Enable on startup"}),new M.Setting(n).setName("Enable upon startup (Desktop)").setDesc("If disabled, SNW will not show block counters from startup until enabled from the command palette.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableOnStartupDesktop),r.onChange(async i=>{this.thePlugin.settings.enableOnStartupDesktop=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Enable startup (Mobile)").setDesc("If disabled, SNW will not show block counters from startup until enabled from the command palette.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableOnStartupMobile),r.onChange(async i=>{this.thePlugin.settings.enableOnStartupMobile=i,await this.thePlugin.saveSettings()})}),n.createEl("h2",{text:"View Modes"}),new M.Setting(n).setName("Incoming Links Header Count").setDesc("In header of a document, show number of incoming link to that file.").addToggle(r=>{r.setValue(this.thePlugin.settings.displayIncomingFilesheader),r.onChange(async i=>{this.thePlugin.settings.displayIncomingFilesheader=i,this.thePlugin.toggleStateHeaderCount(),await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Show SNW indicators in Live Preview Editor").setDesc("While using Live Preview, Display inline of the text of documents all reference counts for links, blocks and embeds.").addToggle(r=>{r.setValue(this.thePlugin.settings.displayInlineReferencesLivePreview),r.onChange(async i=>{this.thePlugin.settings.displayInlineReferencesLivePreview=i,this.thePlugin.toggleStateSNWLivePreview(),await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Show SNW indicators in Reading view ").setDesc("While in Reading View of a document, display inline of the text of documents all reference counts for links, blocks and embeds.").addToggle(r=>{r.setValue(this.thePlugin.settings.displayInlineReferencesMarkdown),r.onChange(async i=>{this.thePlugin.settings.displayInlineReferencesMarkdown=i,this.thePlugin.toggleStateSNWMarkdownPreview(),await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Embed references in Gutter in Live Preview Mode (Desktop)").setDesc(`Displays a count of references in the gutter while in live preview. This is done only in a
					  special scenario. It has to do with the way Obsidian renders embeds, example: ![[link]] when  
					  they are on its own line. Strange New Worlds cannot embed the count in this scenario, so a hint is 
					  displayed in the gutter. It is a hack, but at least we get some information.`).addToggle(r=>{r.setValue(this.thePlugin.settings.displayEmbedReferencesInGutter),r.onChange(async i=>{this.thePlugin.settings.displayEmbedReferencesInGutter=i,this.thePlugin.toggleStateSNWGutters(),await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Embed references in Gutter in Live Preview Mode (Mobile)").setDesc("This is off by default on mobile since the gutter takes up some space in the left margin.").addToggle(r=>{r.setValue(this.thePlugin.settings.displayEmbedReferencesInGutterMobile),r.onChange(async i=>{this.thePlugin.settings.displayEmbedReferencesInGutterMobile=i,this.thePlugin.toggleStateSNWGutters(),await this.thePlugin.saveSettings()})}),n.createEl("h2",{text:"Enable Reference Types in Reading mode"}),n.createEl("sup",{text:"(requires reopening documents to take effect)"}),new M.Setting(n).setName("Block ID").setDesc("Identifies block ID's, for example text blocks that end with a ^ and unique ID for that text block.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingBlockIdInMarkdown),r.onChange(async i=>{this.thePlugin.settings.enableRenderingBlockIdInMarkdown=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Embeds").setDesc("Identifies embedded links, that is links that start with an explanation mark. For example: ![[PageName]].").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingEmbedsInMarkdown),r.onChange(async i=>{this.thePlugin.settings.enableRenderingEmbedsInMarkdown=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Links").setDesc("Identifies links in a document. For example: [[PageName]].").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingLinksInMarkdown),r.onChange(async i=>{this.thePlugin.settings.enableRenderingLinksInMarkdown=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Headers").setDesc("Identifies headers, that is lines of text that start with a hash mark or multiple hash marks. For example: # Heading 1.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingHeadersInMarkdown),r.onChange(async i=>{this.thePlugin.settings.enableRenderingHeadersInMarkdown=i,await this.thePlugin.saveSettings()})}),n.createEl("h2",{text:"Enable Reference Types in Live Preview Mode"}),n.createEl("sup",{text:"(requires reopening documents to take effect)"}),new M.Setting(n).setName("Block ID").setDesc("Identifies block ID's, for example text blocks that end with a ^ and unique ID for that text block.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingBlockIdInLivePreview),r.onChange(async i=>{this.thePlugin.settings.enableRenderingBlockIdInLivePreview=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Embeds").setDesc("Identifies embedded links, that is links that start with an explanation mark. For example: ![[PageName]].").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingEmbedsInLivePreview),r.onChange(async i=>{this.thePlugin.settings.enableRenderingEmbedsInLivePreview=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Links").setDesc("Identifies links in a document. For example: [[PageName]].").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingLinksInLivePreview),r.onChange(async i=>{this.thePlugin.settings.enableRenderingLinksInLivePreview=i,await this.thePlugin.saveSettings()})}),new M.Setting(n).setName("Headers").setDesc("Identifies headers, that is lines of text that start with a hash mark or multiple hash marks. For example: # Heading 1.").addToggle(r=>{r.setValue(this.thePlugin.settings.enableRenderingHeadersInLivePreview),r.onChange(async i=>{this.thePlugin.settings.enableRenderingHeadersInLivePreview=i,await this.thePlugin.saveSettings()})}),n.createEl("h2",{text:"Cache Tuning"}),new M.Setting(n).setName("How often should the SNW Cache update").setDesc(`By default SNW will updates its internal cache every half a second (500 milliseconds) when there is some change in the vault.
					  Increase the time to slighlty improve performance on less performant devices or decrease it to improve refresh of vault information.
					  Currently set to: ${this.thePlugin.settings.cacheUpdateInMilliseconds} milliseconds. (Requires Obsidian Restart)`).addSlider(r=>r.setLimits(500,3e4,100).setValue(this.thePlugin.settings.cacheUpdateInMilliseconds).onChange(async i=>{this.thePlugin.settings.cacheUpdateInMilliseconds=i,await this.thePlugin.saveSettings()}).setDynamicTooltip())}};var Dt=class{constructor(t){this.enableDebugging={CM6Extension:!1,PreviewRendering:!1,LinkCountInHeader:!1,GutterEmbedCounter:!1,HtmlDecorationElements:!1,SidePane:!1};this.console=(t,...n)=>{console.log("SNW: "+t,n)};this.getMetaInfoByCurrentFile=async()=>this.getMetaInfoByFileName(app.workspace.getActiveFile().path);this.getMetaInfoByFileName=async t=>{let n=app.metadataCache.getFirstLinkpathDest(t,"/");return{TFile:n,metadataCache:app.metadataCache.getFileCache(n),SnwTransformedCache:ge(n)}};this.plugin=t}};var ti=require("obsidian"),At=class{constructor(t){this.snwCommands=[{id:"SNW-ToggleActiveState",icon:"dot-network",name:"Toggle active state of SNW plugin on/off",showInRibbon:!0,callback:async()=>{this.thePlugin.showCountsActive=!this.thePlugin.showCountsActive;let t="SNW toggled "+(this.thePlugin.showCountsActive?`ON

`:`OFF

`);t+="Tabs may require reloading for this change to take effect.",new ti.Notice(t),this.thePlugin.toggleStateHeaderCount(),this.thePlugin.toggleStateSNWMarkdownPreview(),this.thePlugin.toggleStateSNWLivePreview(),this.thePlugin.toggleStateSNWGutters()}}];this.thePlugin=t,this.snwCommands.forEach(async n=>{this.thePlugin.addCommand({id:n.id,name:n.name,icon:n.icon,callback:async()=>{await n.callback()}})})}};var ut=class extends oe.Plugin{constructor(){super(...arguments);this.appName=this.manifest.name;this.appID=this.manifest.id;this.markdownPostProcessor=null;this.editorExtensions=[]}async onload(){console.log("loading "+this.appName),Gn(this),_r(this),Gr(this),Kr(this),Qr(this),zr(this),Yr(this),Ur(this),this.snwAPI=new Dt(this),globalThis.snwAPI=this.snwAPI,await this.loadSettings(),this.addSettingTab(new un(this.app,this)),oe.Platform.isMobile||oe.Platform.isMobileApp?this.showCountsActive=this.settings.enableOnStartupMobile:this.showCountsActive=this.settings.enableOnStartupDesktop,this.commands=new At(this),this.registerView(Ne,r=>new pn(r,this));let n=(0,oe.debounce)(()=>{qt()},1e3,!0);this.registerEvent(this.app.metadataCache.on("resolve",n)),this.app.workspace.registerHoverLinkSource(this.appID,{display:this.appName,defaultMod:!0}),this.snwAPI.settings=this.settings,this.registerEditorExtension(this.editorExtensions),this.toggleStateHeaderCount(),this.toggleStateSNWMarkdownPreview(),this.toggleStateSNWLivePreview(),this.toggleStateSNWGutters(),this.app.workspace.onLayoutReady(async()=>{var i;(i=this.app.workspace.getLeavesOfType(Ne))!=null&&i.length||await this.app.workspace.getRightLeaf(!1).setViewState({type:Ne,active:!1});let r=this.app.metadataCache.on("resolved",async()=>{qt(),this.app.metadataCache.offref(r)})})}async layoutChangeEvent(){Un()}async activateView(n,r,i,o,l){this.lastSelectedReferenceType=n,this.lastSelectedReferenceRealLink=r,this.lastSelectedReferenceKey=i,this.lastSelectedReferenceFilePath=o,this.lastSelectedLineNumber=l,await this.app.workspace.getLeavesOfType(Ne)[0].view.updateView(),this.app.workspace.revealLeaf(this.app.workspace.getLeavesOfType(Ne)[0])}toggleStateHeaderCount(){this.settings.displayIncomingFilesheader&&this.showCountsActive?this.app.workspace.on("layout-change",this.layoutChangeEvent):this.app.workspace.off("layout-change",this.layoutChangeEvent)}toggleStateSNWMarkdownPreview(){this.settings.displayInlineReferencesMarkdown&&this.showCountsActive&&this.markdownPostProcessor===null?this.markdownPostProcessor=this.registerMarkdownPostProcessor((n,r)=>jn(n,r)):(oe.MarkdownPreviewRenderer.unregisterPostProcessor(this.markdownPostProcessor),this.markdownPostProcessor=null)}toggleStateSNWLivePreview(){let n=this.settings.displayInlineReferencesLivePreview;n===!0&&(n=this.showCountsActive),this.updateCMExtensionState("inline-ref",n,Xr)}toggleStateSNWGutters(){let n=oe.Platform.isMobile||oe.Platform.isMobileApp?this.settings.displayEmbedReferencesInGutterMobile:this.settings.displayEmbedReferencesInGutter;n===!0&&(n=this.showCountsActive),this.updateCMExtensionState("gutter",n,Jr)}updateCMExtensionState(n,r,i){if(r==!0)this.editorExtensions.push(i),this.editorExtensions[this.editorExtensions.length-1].snwID=n;else for(let o=0;o<this.editorExtensions.length;o++)if(this.editorExtensions[o].snwID===n){this.editorExtensions.splice(o,1);break}this.app.workspace.updateOptions()}async loadSettings(){this.settings=Object.assign({},ei,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}onunload(){console.log("unloading "+this.appName);try{oe.MarkdownPreviewRenderer.unregisterPostProcessor(this.markdownPostProcessor),this.app.workspace.unregisterHoverLinkSource(this.appID)}catch(n){}}};
