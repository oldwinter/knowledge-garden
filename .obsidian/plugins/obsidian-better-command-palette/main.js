"use strict";var t=require("obsidian");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function e(t,e,s,i){return new(s||(s=Promise))((function(n,a){function d(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(d,o)}l((i=i.apply(t,e||[])).next())}))}function s(t,e,s){var i=void 0===e?null:e,n=function(t,e){var s=atob(t);if(e){for(var i=new Uint8Array(s.length),n=0,a=s.length;n<a;++n)i[n]=s.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return s}(t,void 0!==s&&s),a=n.indexOf("\n",10)+1,d=n.substring(a)+(i?"//# sourceMappingURL="+i:""),o=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(o)}var i,n,a,d,o=(i="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7dmFyIGU9InVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWxUaGlzP2dsb2JhbFRoaXM6InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGY/c2VsZjp7fTt2YXIgcixuLG8sdD17ZXhwb3J0czp7fX07bj1lLG89ZnVuY3Rpb24oKXt2YXIgZT0idW5kZWZpbmVkIj09dHlwZW9mIHdpbmRvdyxyPW5ldyBNYXAsbj1uZXcgTWFwLG89W107by50b3RhbD0wO3ZhciB0PVtdLGk9W107ZnVuY3Rpb24gYSgpe3IuY2xlYXIoKSxuLmNsZWFyKCksdD1bXSxpPVtdfWZ1bmN0aW9uIGwoZSl7Zm9yKHZhciByPS05MDA3MTk5MjU0NzQwOTkxLG49ZS5sZW5ndGgtMTtuPj0wOy0tbil7dmFyIG89ZVtuXTtpZihudWxsIT09byl7dmFyIHQ9by5zY29yZTt0PnImJihyPXQpfX1yZXR1cm4tOTAwNzE5OTI1NDc0MDk5MT09PXI/bnVsbDpyfWZ1bmN0aW9uIHMoZSxyKXt2YXIgbj1lW3JdO2lmKHZvaWQgMCE9PW4pcmV0dXJuIG47dmFyIG89cjtBcnJheS5pc0FycmF5KHIpfHwobz1yLnNwbGl0KCIuIikpO2Zvcih2YXIgdD1vLmxlbmd0aCxpPS0xO2UmJisraTx0OyllPWVbb1tpXV07cmV0dXJuIGV9ZnVuY3Rpb24gZihlKXtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIGV9dmFyIHU9ZnVuY3Rpb24oKXt2YXIgZT1bXSxyPTAsbj17fTtmdW5jdGlvbiBvKCl7Zm9yKHZhciBuPTAsbz1lW25dLHQ9MTt0PHI7KXt2YXIgaT10KzE7bj10LGk8ciYmZVtpXS5zY29yZTxlW3RdLnNjb3JlJiYobj1pKSxlW24tMT4+MV09ZVtuXSx0PTErKG48PDEpfWZvcih2YXIgYT1uLTE+PjE7bj4wJiZvLnNjb3JlPGVbYV0uc2NvcmU7YT0obj1hKS0xPj4xKWVbbl09ZVthXTtlW25dPW99cmV0dXJuIG4uYWRkPWZ1bmN0aW9uKG4pe3ZhciBvPXI7ZVtyKytdPW47Zm9yKHZhciB0PW8tMT4+MTtvPjAmJm4uc2NvcmU8ZVt0XS5zY29yZTt0PShvPXQpLTE+PjEpZVtvXT1lW3RdO2Vbb109bn0sbi5wb2xsPWZ1bmN0aW9uKCl7aWYoMCE9PXIpe3ZhciBuPWVbMF07cmV0dXJuIGVbMF09ZVstLXJdLG8oKSxufX0sbi5wZWVrPWZ1bmN0aW9uKG4pe2lmKDAhPT1yKXJldHVybiBlWzBdfSxuLnJlcGxhY2VUb3A9ZnVuY3Rpb24ocil7ZVswXT1yLG8oKX0sbn0scD11KCk7cmV0dXJuIGZ1bmN0aW9uIGMoZCl7dmFyIGc9e3NpbmdsZTpmdW5jdGlvbihlLHIsbil7cmV0dXJuIGU/KGYoZSl8fChlPWcuZ2V0UHJlcGFyZWRTZWFyY2goZSkpLHI/KGYocil8fChyPWcuZ2V0UHJlcGFyZWQocikpLCgobiYmdm9pZCAwIT09bi5hbGxvd1R5cG8/bi5hbGxvd1R5cG86IWR8fHZvaWQgMD09PWQuYWxsb3dUeXBvfHxkLmFsbG93VHlwbyk/Zy5hbGdvcml0aG06Zy5hbGdvcml0aG1Ob1R5cG8pKGUscixlWzBdKSk6bnVsbCk6bnVsbH0sZ286ZnVuY3Rpb24oZSxyLG4pe2lmKCFlKXJldHVybiBvO3ZhciB0PShlPWcucHJlcGFyZVNlYXJjaChlKSlbMF0saT1uJiZuLnRocmVzaG9sZHx8ZCYmZC50aHJlc2hvbGR8fC05MDA3MTk5MjU0NzQwOTkxLGE9biYmbi5saW1pdHx8ZCYmZC5saW1pdHx8OTAwNzE5OTI1NDc0MDk5MSx1PShuJiZ2b2lkIDAhPT1uLmFsbG93VHlwbz9uLmFsbG93VHlwbzohZHx8dm9pZCAwPT09ZC5hbGxvd1R5cG98fGQuYWxsb3dUeXBvKT9nLmFsZ29yaXRobTpnLmFsZ29yaXRobU5vVHlwbyxjPTAsdj0wLGg9ci5sZW5ndGg7aWYobiYmbi5rZXlzKWZvcih2YXIgdz1uLnNjb3JlRm58fGwseD1uLmtleXMseT14Lmxlbmd0aCxtPWgtMTttPj0wOy0tbSl7Zm9yKHZhciBUPXJbbV0saz1uZXcgQXJyYXkoeSksYj15LTE7Yj49MDstLWIpKF89cyhULEI9eFtiXSkpPyhmKF8pfHwoXz1nLmdldFByZXBhcmVkKF8pKSxrW2JdPXUoZSxfLHQpKTprW2JdPW51bGw7ay5vYmo9VDt2YXIgST13KGspO251bGwhPT1JJiYoSTxpfHwoay5zY29yZT1JLGM8YT8ocC5hZGQoayksKytjKTooKyt2LEk+cC5wZWVrKCkuc2NvcmUmJnAucmVwbGFjZVRvcChrKSkpKX1lbHNlIGlmKG4mJm4ua2V5KXt2YXIgQj1uLmtleTtmb3IobT1oLTE7bT49MDstLW0pKF89cyhUPXJbbV0sQikpJiYoZihfKXx8KF89Zy5nZXRQcmVwYXJlZChfKSksbnVsbCE9PShDPXUoZSxfLHQpKSYmKEMuc2NvcmU8aXx8KEM9e3RhcmdldDpDLnRhcmdldCxfdGFyZ2V0TG93ZXJDb2RlczpudWxsLF9uZXh0QmVnaW5uaW5nSW5kZXhlczpudWxsLHNjb3JlOkMuc2NvcmUsaW5kZXhlczpDLmluZGV4ZXMsb2JqOlR9LGM8YT8ocC5hZGQoQyksKytjKTooKyt2LEMuc2NvcmU+cC5wZWVrKCkuc2NvcmUmJnAucmVwbGFjZVRvcChDKSkpKSl9ZWxzZSBmb3IobT1oLTE7bT49MDstLW0pe3ZhciBfLEM7KF89clttXSkmJihmKF8pfHwoXz1nLmdldFByZXBhcmVkKF8pKSxudWxsIT09KEM9dShlLF8sdCkpJiYoQy5zY29yZTxpfHwoYzxhPyhwLmFkZChDKSwrK2MpOigrK3YsQy5zY29yZT5wLnBlZWsoKS5zY29yZSYmcC5yZXBsYWNlVG9wKEMpKSkpKX1pZigwPT09YylyZXR1cm4gbzt2YXIgQT1uZXcgQXJyYXkoYyk7Zm9yKG09Yy0xO20+PTA7LS1tKUFbbV09cC5wb2xsKCk7cmV0dXJuIEEudG90YWw9Yyt2LEF9LGdvQXN5bmM6ZnVuY3Rpb24ocixuLHQpe3ZhciBpPSExLGE9bmV3IFByb21pc2UoKGZ1bmN0aW9uKGEscCl7aWYoIXIpcmV0dXJuIGEobyk7dmFyIGM9KHI9Zy5wcmVwYXJlU2VhcmNoKHIpKVswXSx2PXUoKSxoPW4ubGVuZ3RoLTEsdz10JiZ0LnRocmVzaG9sZHx8ZCYmZC50aHJlc2hvbGR8fC05MDA3MTk5MjU0NzQwOTkxLHg9dCYmdC5saW1pdHx8ZCYmZC5saW1pdHx8OTAwNzE5OTI1NDc0MDk5MSx5PSh0JiZ2b2lkIDAhPT10LmFsbG93VHlwbz90LmFsbG93VHlwbzohZHx8dm9pZCAwPT09ZC5hbGxvd1R5cG98fGQuYWxsb3dUeXBvKT9nLmFsZ29yaXRobTpnLmFsZ29yaXRobU5vVHlwbyxtPTAsVD0wO2Z1bmN0aW9uIGsoKXtpZihpKXJldHVybiBwKCJjYW5jZWxlZCIpO3ZhciB1PURhdGUubm93KCk7aWYodCYmdC5rZXlzKWZvcih2YXIgZD10LnNjb3JlRm58fGwsYj10LmtleXMsST1iLmxlbmd0aDtoPj0wOy0taCl7Zm9yKHZhciBCPW5baF0sXz1uZXcgQXJyYXkoSSksQz1JLTE7Qz49MDstLUMpKFA9cyhCLEw9YltDXSkpPyhmKFApfHwoUD1nLmdldFByZXBhcmVkKFApKSxfW0NdPXkocixQLGMpKTpfW0NdPW51bGw7Xy5vYmo9Qjt2YXIgQT1kKF8pO2lmKG51bGwhPT1BJiYhKEE8dykmJihfLnNjb3JlPUEsbTx4Pyh2LmFkZChfKSwrK20pOigrK1QsQT52LnBlZWsoKS5zY29yZSYmdi5yZXBsYWNlVG9wKF8pKSxoJTFlMz09MCYmRGF0ZS5ub3coKS11Pj0xMCkpcmV0dXJuIHZvaWQoZT9zZXRJbW1lZGlhdGUoayk6c2V0VGltZW91dChrKSl9ZWxzZSBpZih0JiZ0LmtleSl7Zm9yKHZhciBMPXQua2V5O2g+PTA7LS1oKWlmKChQPXMoQj1uW2hdLEwpKSYmKGYoUCl8fChQPWcuZ2V0UHJlcGFyZWQoUCkpLG51bGwhPT0oaj15KHIsUCxjKSkmJiEoai5zY29yZTx3KSYmKGo9e3RhcmdldDpqLnRhcmdldCxfdGFyZ2V0TG93ZXJDb2RlczpudWxsLF9uZXh0QmVnaW5uaW5nSW5kZXhlczpudWxsLHNjb3JlOmouc2NvcmUsaW5kZXhlczpqLmluZGV4ZXMsb2JqOkJ9LG08eD8odi5hZGQoaiksKyttKTooKytULGouc2NvcmU+di5wZWVrKCkuc2NvcmUmJnYucmVwbGFjZVRvcChqKSksaCUxZTM9PTAmJkRhdGUubm93KCktdT49MTApKSlyZXR1cm4gdm9pZChlP3NldEltbWVkaWF0ZShrKTpzZXRUaW1lb3V0KGspKX1lbHNlIGZvcig7aD49MDstLWgpe3ZhciBQLGo7aWYoKFA9bltoXSkmJihmKFApfHwoUD1nLmdldFByZXBhcmVkKFApKSxudWxsIT09KGo9eShyLFAsYykpJiYhKGouc2NvcmU8dykmJihtPHg/KHYuYWRkKGopLCsrbSk6KCsrVCxqLnNjb3JlPnYucGVlaygpLnNjb3JlJiZ2LnJlcGxhY2VUb3AoaikpLGglMWUzPT0wJiZEYXRlLm5vdygpLXU+PTEwKSkpcmV0dXJuIHZvaWQoZT9zZXRJbW1lZGlhdGUoayk6c2V0VGltZW91dChrKSl9aWYoMD09PW0pcmV0dXJuIGEobyk7Zm9yKHZhciBOPW5ldyBBcnJheShtKSxTPW0tMTtTPj0wOy0tUylOW1NdPXYucG9sbCgpO04udG90YWw9bStULGEoTil9ZT9zZXRJbW1lZGlhdGUoayk6aygpfSkpO3JldHVybiBhLmNhbmNlbD1mdW5jdGlvbigpe2k9ITB9LGF9LGhpZ2hsaWdodDpmdW5jdGlvbihlLHIsbil7aWYobnVsbD09PWUpcmV0dXJuIG51bGw7dm9pZCAwPT09ciYmKHI9IjxiPiIpLHZvaWQgMD09PW4mJihuPSI8L2I+Iik7Zm9yKHZhciBvPSIiLHQ9MCxpPSExLGE9ZS50YXJnZXQsbD1hLmxlbmd0aCxzPWUuaW5kZXhlcyxmPTA7ZjxsOysrZil7dmFyIHU9YVtmXTtpZihzW3RdPT09Zil7aWYoaXx8KGk9ITAsbys9ciksKyt0PT09cy5sZW5ndGgpe28rPXUrbithLnN1YnN0cihmKzEpO2JyZWFrfX1lbHNlIGkmJihpPSExLG8rPW4pO28rPXV9cmV0dXJuIG99LHByZXBhcmU6ZnVuY3Rpb24oZSl7aWYoZSlyZXR1cm57dGFyZ2V0OmUsX3RhcmdldExvd2VyQ29kZXM6Zy5wcmVwYXJlTG93ZXJDb2RlcyhlKSxfbmV4dEJlZ2lubmluZ0luZGV4ZXM6bnVsbCxzY29yZTpudWxsLGluZGV4ZXM6bnVsbCxvYmo6bnVsbH19LHByZXBhcmVTbG93OmZ1bmN0aW9uKGUpe2lmKGUpcmV0dXJue3RhcmdldDplLF90YXJnZXRMb3dlckNvZGVzOmcucHJlcGFyZUxvd2VyQ29kZXMoZSksX25leHRCZWdpbm5pbmdJbmRleGVzOmcucHJlcGFyZU5leHRCZWdpbm5pbmdJbmRleGVzKGUpLHNjb3JlOm51bGwsaW5kZXhlczpudWxsLG9iajpudWxsfX0scHJlcGFyZVNlYXJjaDpmdW5jdGlvbihlKXtpZihlKXJldHVybiBnLnByZXBhcmVMb3dlckNvZGVzKGUpfSxnZXRQcmVwYXJlZDpmdW5jdGlvbihlKXtpZihlLmxlbmd0aD45OTkpcmV0dXJuIGcucHJlcGFyZShlKTt2YXIgbj1yLmdldChlKTtyZXR1cm4gdm9pZCAwIT09bnx8KG49Zy5wcmVwYXJlKGUpLHIuc2V0KGUsbikpLG59LGdldFByZXBhcmVkU2VhcmNoOmZ1bmN0aW9uKGUpe2lmKGUubGVuZ3RoPjk5OSlyZXR1cm4gZy5wcmVwYXJlU2VhcmNoKGUpO3ZhciByPW4uZ2V0KGUpO3JldHVybiB2b2lkIDAhPT1yfHwocj1nLnByZXBhcmVTZWFyY2goZSksbi5zZXQoZSxyKSkscn0sYWxnb3JpdGhtOmZ1bmN0aW9uKGUscixuKXtmb3IodmFyIG89ci5fdGFyZ2V0TG93ZXJDb2RlcyxhPWUubGVuZ3RoLGw9by5sZW5ndGgscz0wLGY9MCx1PTAscD0wOzspe2lmKG49PT1vW2ZdKXtpZih0W3ArK109ZiwrK3M9PT1hKWJyZWFrO249ZVswPT09dT9zOnU9PT1zP3MrMTp1PT09cy0xP3MtMTpzXX1pZigrK2Y+PWwpZm9yKDs7KXtpZihzPD0xKXJldHVybiBudWxsO2lmKDA9PT11KXtpZihuPT09ZVstLXNdKWNvbnRpbnVlO3U9c31lbHNle2lmKDE9PT11KXJldHVybiBudWxsO2lmKChuPWVbMSsocz0tLXUpXSk9PT1lW3NdKWNvbnRpbnVlfWY9dFsocD1zKS0xXSsxO2JyZWFrfX1zPTA7dmFyIGM9MCxkPSExLHY9MCxoPXIuX25leHRCZWdpbm5pbmdJbmRleGVzO251bGw9PT1oJiYoaD1yLl9uZXh0QmVnaW5uaW5nSW5kZXhlcz1nLnByZXBhcmVOZXh0QmVnaW5uaW5nSW5kZXhlcyhyLnRhcmdldCkpO3ZhciB3PWY9MD09PXRbMF0/MDpoW3RbMF0tMV07aWYoZiE9PWwpZm9yKDs7KWlmKGY+PWwpe2lmKHM8PTApe2lmKCsrYz5hLTIpYnJlYWs7aWYoZVtjXT09PWVbYysxXSljb250aW51ZTtmPXc7Y29udGludWV9LS1zLGY9aFtpWy0tdl1dfWVsc2UgaWYoZVswPT09Yz9zOmM9PT1zP3MrMTpjPT09cy0xP3MtMTpzXT09PW9bZl0pe2lmKGlbdisrXT1mLCsrcz09PWEpe2Q9ITA7YnJlYWt9KytmfWVsc2UgZj1oW2ZdO2lmKGQpdmFyIHg9aSx5PXY7ZWxzZSB4PXQseT1wO2Zvcih2YXIgbT0wLFQ9LTEsaz0wO2s8YTsrK2spVCE9PShmPXhba10pLTEmJihtLT1mKSxUPWY7Zm9yKGQ/MCE9PWMmJihtKz0tMjApOihtKj0xZTMsMCE9PXUmJihtKz0tMjApKSxtLT1sLWEsci5zY29yZT1tLHIuaW5kZXhlcz1uZXcgQXJyYXkoeSksaz15LTE7az49MDstLWspci5pbmRleGVzW2tdPXhba107cmV0dXJuIHJ9LGFsZ29yaXRobU5vVHlwbzpmdW5jdGlvbihlLHIsbil7Zm9yKHZhciBvPXIuX3RhcmdldExvd2VyQ29kZXMsYT1lLmxlbmd0aCxsPW8ubGVuZ3RoLHM9MCxmPTAsdT0wOzspe2lmKG49PT1vW2ZdKXtpZih0W3UrK109ZiwrK3M9PT1hKWJyZWFrO249ZVtzXX1pZigrK2Y+PWwpcmV0dXJuIG51bGx9cz0wO3ZhciBwPSExLGM9MCxkPXIuX25leHRCZWdpbm5pbmdJbmRleGVzO2lmKG51bGw9PT1kJiYoZD1yLl9uZXh0QmVnaW5uaW5nSW5kZXhlcz1nLnByZXBhcmVOZXh0QmVnaW5uaW5nSW5kZXhlcyhyLnRhcmdldCkpLChmPTA9PT10WzBdPzA6ZFt0WzBdLTFdKSE9PWwpZm9yKDs7KWlmKGY+PWwpe2lmKHM8PTApYnJlYWs7LS1zLGY9ZFtpWy0tY11dfWVsc2UgaWYoZVtzXT09PW9bZl0pe2lmKGlbYysrXT1mLCsrcz09PWEpe3A9ITA7YnJlYWt9KytmfWVsc2UgZj1kW2ZdO2lmKHApdmFyIHY9aSxoPWM7ZWxzZSB2PXQsaD11O2Zvcih2YXIgdz0wLHg9LTEseT0wO3k8YTsrK3kpeCE9PShmPXZbeV0pLTEmJih3LT1mKSx4PWY7Zm9yKHB8fCh3Kj0xZTMpLHctPWwtYSxyLnNjb3JlPXcsci5pbmRleGVzPW5ldyBBcnJheShoKSx5PWgtMTt5Pj0wOy0teSlyLmluZGV4ZXNbeV09dlt5XTtyZXR1cm4gcn0scHJlcGFyZUxvd2VyQ29kZXM6ZnVuY3Rpb24oZSl7Zm9yKHZhciByPWUubGVuZ3RoLG49W10sbz1lLnRvTG93ZXJDYXNlKCksdD0wO3Q8cjsrK3Qpblt0XT1vLmNoYXJDb2RlQXQodCk7cmV0dXJuIG59LHByZXBhcmVCZWdpbm5pbmdJbmRleGVzOmZ1bmN0aW9uKGUpe2Zvcih2YXIgcj1lLmxlbmd0aCxuPVtdLG89MCx0PSExLGk9ITEsYT0wO2E8cjsrK2Epe3ZhciBsPWUuY2hhckNvZGVBdChhKSxzPWw+PTY1JiZsPD05MCxmPXN8fGw+PTk3JiZsPD0xMjJ8fGw+PTQ4JiZsPD01Nyx1PXMmJiF0fHwhaXx8IWY7dD1zLGk9Zix1JiYobltvKytdPWEpfXJldHVybiBufSxwcmVwYXJlTmV4dEJlZ2lubmluZ0luZGV4ZXM6ZnVuY3Rpb24oZSl7Zm9yKHZhciByPWUubGVuZ3RoLG49Zy5wcmVwYXJlQmVnaW5uaW5nSW5kZXhlcyhlKSxvPVtdLHQ9blswXSxpPTAsYT0wO2E8cjsrK2EpdD5hP29bYV09dDoodD1uWysraV0sb1thXT12b2lkIDA9PT10P3I6dCk7cmV0dXJuIG99LGNsZWFudXA6YSxuZXc6Y307cmV0dXJuIGd9KCl9LChyPXQpLmV4cG9ydHM/ci5leHBvcnRzPW8oKTpuLmZ1enp5c29ydD1vKCk7c2VsZi5vbm1lc3NhZ2U9ZT0+e2NvbnN0e3F1ZXJ5OnIsaXRlbXM6bn09ZS5kYXRhLFtvLC4uLmldPXIuc3BsaXQoIkAiKTtsZXQgYT1uO2lmKG8uaW5jbHVkZXMoInx8Iikpe2NvbnN0IGU9by5zcGxpdCgifHwiKS5tYXAoKGU9PmUudHJpbSgpKSk7YT1uLmZpbHRlcigocj0+ZS5zb21lKChlPT5yLnRleHQuaW5jbHVkZXMoZSkpKSkpfWVsc2UiIiE9PW8mJihhPXQuZXhwb3J0cy5nbyhvLG4se2tleToidGV4dCJ9KS5tYXAoKGU9PmUub2JqKSkpO3JldHVybiBpLmxlbmd0aCYmKGE9YS5maWx0ZXIoKGU9PmZ1bmN0aW9uKGUscil7Zm9yKGxldCBuPTA7bjxyLmxlbmd0aDtuKz0xKXtjb25zdCBvPXJbbl07Zm9yKGxldCByPTA7cjxlLmxlbmd0aDtyKz0xKXtjb25zdCBuPWVbcl07aWYobj09PW8pcmV0dXJuITA7Y29uc3QgdD1gJHtvfS9gO2lmKG4uc3RhcnRzV2l0aCh0KSlyZXR1cm4hMH19cmV0dXJuITF9KGUudGFncyxpKSkpKSxzZWxmLnBvc3RNZXNzYWdlKGEpfX0oKTsKCg==",n=null,a=!1,function(t){return d=d||s(i,n,a),new Worker(d,t)});class l{constructor(t=[]){this.map=new Map,t.forEach((t=>this.map.set(t.value(),t)))}has(t){return this.map.has(t.value())}add(t){return this.delete(t),this.map.set(t.value(),t)}addAll(t){t.forEach((t=>this.add(t)))}delete(t){this.map.delete(t.value())}values(){return Array.from(this.map.values())}valuesByLastAdd(){return Array.from(this.map.values()).reverse()}}class c{constructor(t,e,s=[]){this.id=t,this.text=e,this.tags=s}value(){return this.id}}class h{constructor(t,e,s,i){this.app=t,this.prevItems=e,this.recentAbovePinned=s.settings.recentAbovePinned,this.plugin=s,this.palette=i,this.allItems=[],this.pinnedItems=[],this.initialized=!1,this.hiddenIds=[]}getTitleText(){return this.titleText}getEmptyStateText(){return this.emptyStateText}getInstructions(){return[]}checkInitialized(){if(!this.initialized)throw new Error("This adapter has not been initialized")}initialize(){this.initialized=!0}cleanQuery(t){return t}getPinnedItems(){return this.checkInitialized(),this.pinnedItems}getItems(){return this.checkInitialized(),this.allItems}getPrevItems(){return this.prevItems}getSortedItems(){const t=new l(this.getItems()),e=this.recentAbovePinned?this.getPrevItems().values():this.getPinnedItems();return[this.recentAbovePinned?this.getPinnedItems():this.getPrevItems().values(),e].forEach((e=>{e.forEach((e=>{t.has(e)&&t.add(e)}))})),t.valuesByLastAdd()}toggleHideId(t){return e(this,void 0,void 0,(function*(){this.hiddenIds.includes(t)?this.hiddenIds=this.hiddenIds.filter((e=>t!==e)):this.hiddenIds.push(t),this.plugin.settings[this.hiddenIdsSettingsKey]=this.hiddenIds,yield this.plugin.saveSettings(),yield this.plugin.loadSettings(),this.palette.updateSuggestions()}))}}class m{constructor(t,e,s,i=[],n=200){this.app=t,this.id=e,this.name=s,this.commandIds=i,this.delay=n}addCommand(t){this.commandIds.push(t)}removeCommand(t){this.commandIds=this.commandIds.filter((e=>e===t))}commandIsAvailable(t){const e=this.app.commands.findCommand(t);return!e.checkCallback||e.checkCallback(!0)}callAllCommands(){return e(this,void 0,void 0,(function*(){const e=new t.Notice(`Running "${this.name}"...`,1e4);for(let t=0;t<this.commandIds.length;t+=1){const s=this.commandIds[t],i=this.app.commands.findCommand(s);if(!this.commandIsAvailable(s)){e.setMessage(`Error: "${i.name}" cannot be used in this context. The macro is stopping.`);break}e.setMessage(`Running "${i.name}"`),this.app.commands.executeCommandById(s),yield new Promise((t=>{setTimeout(t,this.delay)}))}return e.hide(),new t.Notice(`Successfully ran "${this.name}"`),!0}))}checkCallback(t){return t?this.commandIsAvailable(this.commandIds[0]):(this.callAllCommands(),null)}}const r=new Set(["Alt","Ctrl","Mod","Shift"]),p={Mod:"Ctrl +",Ctrl:"Ctrl +",Meta:"Win +",Alt:"Alt +",Shift:"Shift +",Hyper:"Caps +"},u={Mod:"⌘",Ctrl:"^",Meta:"⌘",Alt:"⌥",Shift:"⇧",Hyper:"⇪"},g={TAB:"↹",ENTER:"↵",ARROWLEFT:"←",ARROWRIGHT:"→",ARROWUP:"↑",ARROWDOWN:"↓",BACKSPACE:"⌫",ESC:"Esc"};function Z(e,s){let i=t.Platform.isMacOS?u:p;"mac"===s.hotkeyStyle?i=u:"windows"===s.hotkeyStyle&&(i=p);const n=[];var a;s.hyperKeyOverride&&(4===(a=e.modifiers).length&&a.every((t=>r.has(t))))?n.push(i.Hyper):e.modifiers.forEach((t=>{n.push(i[t])}));const d=e.key.toUpperCase();return n.push(g[d]||d),n.join(" ")}function y(t){return t.name}function b(e,s){const i=e.getCache(s);if(!i)return[];const n=(i.tags||[]).map((t=>t.tag)),a=t.parseFrontMatterTags(i.frontmatter)||[],d=n.concat(a),o=t.parseFrontMatterAliases(i.frontmatter)||[];return[new c(s,s,d),...o.map((t=>new c(`${t}:${s}`,t,d)))]}class S extends t.FuzzySuggestModal{constructor(t,e){super(t),this.getItemText=y,this.callback=e}getItems(){return Object.values(this.app.commands.commands)}onChooseItem(t){this.callback(t)}}class T extends h{constructor(){super(...arguments),this.COMMAND_PLUGIN_NAME_SEPARATOR=": "}initialize(){super.initialize(),this.titleText="Better Command Palette: Commands",this.emptyStateText="No matching commands.",this.hiddenIds=this.plugin.settings.hiddenCommands,this.hiddenIdsSettingsKey="hiddenCommands",this.allItems=this.app.commands.listCommands().sort(((t,e)=>e.name.localeCompare(t.name))).map((t=>new c(t.id,t.name)));const t=this.app.internalPlugins.getPluginById("command-palette").instance.options.pinned||[];this.pinnedItems=t.reduce(((t,e)=>{const s=this.app.commands.findCommand(e);return s&&t.push(new c(e,s.name)),t}),[]).reverse()}getInstructions(){return[{command:Z({modifiers:[],key:"ENTER"},this.plugin.settings),purpose:"Run command"},{command:this.plugin.settings.fileSearchPrefix,purpose:"Search Files"},{command:this.plugin.settings.tagSearchPrefix,purpose:"Search Tags"}]}renderSuggestion(e,s,i){const n=this.app.commands.findCommand(e.id),a=this.app.hotkeyManager.getHotkeys(n.id),d=this.app.hotkeyManager.getDefaultHotkeys(n.id),o=a||d||[];if(this.getPinnedItems().find((t=>t.id===e.id))){const e=i.querySelector(".suggestion-flair");t.setIcon(e,"filled-pin",13),e.ariaLabel="Pinned",e.onClickEvent((()=>{}))}let{text:l}=e,c="";if(l.includes(this.COMMAND_PLUGIN_NAME_SEPARATOR)){const t=l.split(this.COMMAND_PLUGIN_NAME_SEPARATOR);c=t.shift(),l=t.join(this.COMMAND_PLUGIN_NAME_SEPARATOR)}s.createEl("span",{cls:"suggestion-title",text:l}),c&&this.plugin.settings.showPluginName&&s.createEl("span",{cls:"suggestion-note",text:c}),o.forEach((t=>{i.createEl("kbd",{cls:"suggestion-hotkey",text:Z(t,this.plugin.settings)})}))}onChooseSuggestion(t){return e(this,void 0,void 0,(function*(){this.getPrevItems().add(t),this.app.commands.executeCommandById(t.id)}))}}class P extends h{initialize(){super.initialize(),this.titleText="Better Command Palette: Files",this.emptyStateText="No matching files.",this.fileSearchPrefix=this.plugin.settings.fileSearchPrefix,this.hiddenIds=this.plugin.settings.hiddenFiles,this.hiddenIdsSettingsKey="hiddenFiles",this.allItems=[],this.unresolvedItems=new l,this.app.metadataCache.getCachedFiles().forEach((t=>{const e=b(this.app.metadataCache,t);this.allItems=this.allItems.concat(e),Object.keys(this.app.metadataCache.unresolvedLinks[t]||{}).forEach((t=>this.unresolvedItems.add(new c(t,t))))})),this.allItems=this.allItems.concat(Array.from(this.unresolvedItems.values())).reverse(),[...this.app.workspace.getLastOpenFiles()].reverse().forEach((t=>{const e=b(this.app.metadataCache,t);e[0]&&this.prevItems.add(e[0])}))}getInstructions(){const{createNewPaneMod:t,createNewFileMod:e}=this.plugin.settings;return[{command:Z({modifiers:[],key:"ENTER"},this.plugin.settings),purpose:"Open file"},{command:Z({modifiers:[t],key:"ENTER"},this.plugin.settings),purpose:"Open file in new pane"},{command:Z({modifiers:[e],key:"ENTER"},this.plugin.settings),purpose:"Create file"},{command:Z({modifiers:[],key:"BACKSPACE"},this.plugin.settings),purpose:"Search Commands"},{command:this.plugin.settings.tagSearchPrefix,purpose:"Search Tags"}]}cleanQuery(t){return t.replace(this.fileSearchPrefix,"")}renderSuggestion(e,s){const i=s.createEl("div",{cls:"suggestion-title",text:e.text});if(this.unresolvedItems.has(e)&&i.addClass("unresolved"),e.id.includes(":")){i.createEl("span",{cls:"suggestion-name",text:e.text}).ariaLabel="Alias",t.setIcon(i,"right-arrow-with-tail");const[,s]=e.id.split(":");i.createEl("span",{cls:"suggestion-note",text:s})}s.createEl("div",{cls:"suggestion-note",text:`${e.tags.join(" ")}`})}onChooseSuggestion(s,i){return e(this,void 0,void 0,(function*(){let n=s&&s.id;if(s)n.includes(":")&&([,n]=n.split(":"));else{n=i.target.value.replace(this.fileSearchPrefix,"")}const a=yield function(s,i){return e(this,void 0,void 0,(function*(){let e=s.metadataCache.getFirstLinkpathDest(i,"");if(!e){const n=t.normalizePath(`${i}.md`),a=n.split("/").slice(0,-1).join("/");try{yield s.vault.createFolder(a)}catch(t){}e=yield s.vault.create(n,"")}return e}))}(this.app,n);a&&this.getPrevItems().add(s||new c(a.path,a.path)),function(t,e,s,i){const{workspace:n}=t;let a=n.activeLeaf;("Shift"===e.createNewPaneMod?i.shiftKey:i.metaKey)&&(a=n.createLeafBySplit(n.activeLeaf),n.setActiveLeaf(a)),a.openFile(s)}(this.app,this.plugin.settings,a,i)}))}}class W extends h{initialize(){super.initialize(),this.hiddenIds=this.plugin.settings.hiddenTags,this.hiddenIdsSettingsKey="hiddenTags",this.tagSearchPrefix=this.plugin.settings.tagSearchPrefix,this.titleText="Better Command Palette: Tags",this.emptyStateText="No matching tags.",this.allItems=Object.entries(this.app.metadataCache.getTags()).map((([t,e])=>new c(t,t,[e])))}getInstructions(){return[{command:Z({modifiers:[],key:"ENTER"},this.plugin.settings),purpose:"See file usage"},{command:Z({modifiers:[],key:"BACKSPACE"},this.plugin.settings),purpose:"Search Commands"},{command:this.plugin.settings.fileSearchPrefix,purpose:"Search Files"}]}cleanQuery(t){return t.replace(this.tagSearchPrefix,"")}renderSuggestion(t,e,s){e.createEl("span",{cls:"suggestion-content",text:t.text});const i=parseInt(t.tags[0],10);s.createEl("span",{cls:"suggestion-flair",text:`Found in ${i} file${1===i?"":"s"}`})}onChooseSuggestion(t){return e(this,void 0,void 0,(function*(){this.getPrevItems().add(t),this.palette.open(),this.palette.setQuery(`/@${t.text}`,1)}))}}class X extends t.SuggestModal{constructor(t,e,s,i,n,a=""){super(t),this.ACTION_TYPE_COMMAND=1,this.ACTION_TYPE_FILES=2,this.ACTION_TYPE_TAGS=3,this.toggleHiddenItems=()=>{this.showHiddenItems=!this.showHiddenItems,this.updateSuggestions()},this.fileSearchPrefix=i.settings.fileSearchPrefix,this.tagSearchPrefix=i.settings.tagSearchPrefix,this.suggestionLimit=i.settings.suggestionLimit,this.initialInputValue=a,this.plugin=i,this.modalEl.addClass("better-command-palette"),this.setPlaceholder("Select a command"),this.commandAdapter=new T(t,e,i,this),this.fileAdapter=new P(t,new l,i,this),this.tagAdapter=new W(t,s,i,this),this.suggestionsWorker=n,this.suggestionsWorker.onmessage=t=>this.receivedSuggestions(t),this.modalTitleEl=createEl("p",{cls:"better-command-palette-title"}),this.updateActionType(),this.modalEl.insertBefore(this.modalTitleEl,this.modalEl.firstChild),this.hiddenItemsHeaderEl=createEl("p","hidden-items-header"),this.showHiddenItems=!1,this.hiddenItemsHeaderEl.onClickEvent(this.toggleHiddenItems),this.modalEl.insertBefore(this.hiddenItemsHeaderEl,this.resultContainerEl),this.setScopes(i)}close(t){super.close(),t&&t.preventDefault()}setScopes(t){const e=e=>{const s=e.target;t.settings.closeWithBackspace&&""===s.value&&this.close(e)},{createNewPaneMod:s,createNewFileMod:i}=t.settings;this.scope.register([],"Backspace",(t=>{e(t)})),this.scope.register(["Mod"],"Backspace",(t=>{e(t)})),this.scope.register([i],"Enter",(t=>{this.actionType===this.ACTION_TYPE_FILES&&(this.currentAdapter.onChooseSuggestion(null,t),this.close(t))})),this.scope.register([i,s],"Enter",(t=>{this.actionType===this.ACTION_TYPE_FILES&&(this.currentAdapter.onChooseSuggestion(null,t),this.close(t))})),this.scope.register([s],"Enter",(t=>{this.actionType===this.ACTION_TYPE_FILES&&this.currentSuggestions.length&&(this.currentAdapter.onChooseSuggestion(this.currentSuggestions[0],t),this.close(t))})),this.scope.register(["Mod"],"I",this.toggleHiddenItems)}onOpen(){super.onOpen(),this.initialInputValue&&this.setQuery(this.initialInputValue)}setQuery(t,e=-1){this.inputEl.value=t,e>-1&&this.inputEl.setSelectionRange(e,e),this.updateSuggestions()}updateActionType(){const t=this.inputEl.value;let e;t.startsWith(this.fileSearchPrefix)?(e=this.ACTION_TYPE_FILES,this.currentAdapter=this.fileAdapter):t.startsWith(this.tagSearchPrefix)?(e=this.ACTION_TYPE_TAGS,this.currentAdapter=this.tagAdapter):(e=this.ACTION_TYPE_COMMAND,this.currentAdapter=this.commandAdapter),this.currentAdapter.initialized||this.currentAdapter.initialize();const s=e!==this.actionType;return this.actionType=e,s&&(this.updateEmptyStateText(),this.updateTitleText(),this.updateInstructions(),this.currentSuggestions=this.currentAdapter.getSortedItems().slice(0,this.suggestionLimit)),s}updateTitleText(){this.modalTitleEl.setText(this.currentAdapter.getTitleText())}updateEmptyStateText(){this.emptyStateText=this.currentAdapter.getEmptyStateText()}updateInstructions(){Array.from(this.modalEl.getElementsByClassName("prompt-instructions")).forEach((t=>{this.modalEl.removeChild(t)})),this.setInstructions([...this.currentAdapter.getInstructions(),{command:Z({modifiers:[],key:"ESC"},this.plugin.settings),purpose:"Close palette"},{command:Z({modifiers:["Mod"],key:"I"},this.plugin.settings),purpose:"Toggle Hidden Items"}])}getItems(){return this.currentAdapter.getSortedItems()}receivedSuggestions(t){const e=[];let s=0;for(let i=0;i<t.data.length&&e.length<this.suggestionLimit+s;i+=1)e.push(t.data[i]),this.currentAdapter.hiddenIds.includes(t.data[i].id)&&(s+=1);const i=e.map((t=>new c(t.id,t.text,t.tags)));this.currentSuggestions=i,this.limit=this.currentSuggestions.length,this.updateSuggestions()}getSuggestionsAsync(t){const e=this.getItems();this.suggestionsWorker.postMessage({query:t,items:e})}getSuggestions(t){this.updateActionType();const e=t!==this.lastQuery;this.lastQuery=t;const s=this.currentAdapter.cleanQuery(t.trim());e&&this.getSuggestionsAsync(s);const i=this.currentSuggestions.filter((t=>!this.currentAdapter.hiddenIds.includes(t.id))),n=this.currentSuggestions.length-i.length;return this.updateHiddenItemCountHeader(n),this.showHiddenItems?this.currentSuggestions:i}updateHiddenItemCountHeader(t){if(this.hiddenItemsHeaderEl.empty(),0!==t){const e=`${this.showHiddenItems?"Hide":"Show"} hidden items (${t})`;this.hiddenItemsHeaderEl.setText(e)}}renderSuggestion(e,s){s.addClass("mod-complex");const i=this.currentAdapter.hiddenIds.includes(e.id);i&&s.addClass("hidden");const n=s.createEl("span","suggestion-content"),a=s.createEl("span","suggestion-aux"),d=a.createEl("span","suggestion-flair");!function(t,e,s){s.has(t)&&(e.addClass("recent"),e.createEl("span",{cls:"suggestion-note",text:"(recently used)"}))}(e,n,this.currentAdapter.getPrevItems()),t.setIcon(d,"cross",13),d.ariaLabel=i?"Click to Unhide":"Click to Hide",d.setAttr("data-id",e.id),d.onClickEvent((t=>{t.preventDefault(),t.stopPropagation();const e=t.target;this.currentAdapter.toggleHideId(e.getAttr("data-id"))})),this.currentAdapter.renderSuggestion(e,n,a)}onChooseSuggestion(t,s){return e(this,void 0,void 0,(function*(){this.currentAdapter.onChooseSuggestion(t,s)}))}}const K={closeWithBackspace:!0,showPluginName:!0,fileSearchPrefix:"/",tagSearchPrefix:"#",suggestionLimit:50,recentAbovePinned:!1,hyperKeyOverride:!1,macros:[],hotkeyStyle:"auto",createNewFileMod:"Mod",createNewPaneMod:"Shift",hiddenCommands:[],hiddenFiles:[],hiddenTags:[]};class I extends t.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){this.containerEl.empty(),this.displayBasicSettings(),this.displayMacroSettings()}displayBasicSettings(){const{containerEl:s}=this,{settings:i}=this.plugin;s.empty(),s.createEl("h2",{text:"Better Command Palette Settings"}),new t.Setting(s).setName("Close on Backspace").setDesc("Close the palette when there is no text and backspace is pressed").addToggle((t=>t.setValue(i.closeWithBackspace).onChange((t=>e(this,void 0,void 0,(function*(){i.closeWithBackspace=t,yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Show Plugin Name").setDesc("Close show the plugin name in the command palette").addToggle((t=>t.setValue(i.showPluginName).onChange((t=>e(this,void 0,void 0,(function*(){i.showPluginName=t,yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Recent above Pinned").setDesc("Sorts the suggestion so that the recently used items show before pinned items.").addToggle((t=>t.setValue(i.recentAbovePinned).onChange((t=>e(this,void 0,void 0,(function*(){i.recentAbovePinned=t,yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Caps Lock Hyper Key Hotkey Override").setDesc('For those users who have use a "Hyper Key", enabling this maps the icons "⌥ ^ ⌘ ⇧" to the caps lock icon "⇪" ').addToggle((t=>t.setValue(i.hyperKeyOverride).onChange((t=>e(this,void 0,void 0,(function*(){i.hyperKeyOverride=t,yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Use shift to create files and cmd to open in new panes").setDesc("By default cmd is used to create files and shift is used to open in new panes. This setting reverses that to mimic the functionality of the standard quick switcher").addToggle((t=>t.setValue("Shift"===i.createNewFileMod).onChange((t=>e(this,void 0,void 0,(function*(){i.createNewFileMod=t?"Shift":"Mod",i.createNewPaneMod=t?"Mod":"Shift",yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("File Search Prefix").setDesc("The prefix used to tell the palette you want to search files").addText((t=>t.setValue(i.fileSearchPrefix).onChange((t=>e(this,void 0,void 0,(function*(){i.fileSearchPrefix=t,yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Tag Search Prefix").setDesc("The prefix used to tell the palette you want to search tags").addText((t=>t.setValue(i.tagSearchPrefix).onChange((t=>e(this,void 0,void 0,(function*(){i.tagSearchPrefix=t,yield this.plugin.saveSettings()}))))));const n={10:"10",20:"20",50:"50",100:"100",200:"200",500:"500",1e3:"1000"};new t.Setting(s).setName("Suggestion Limit").setDesc("The number of items that will be in the suggestion list of the palette. Really high numbers can affect performance").addDropdown((t=>t.addOptions(n).setValue(i.suggestionLimit.toString()).onChange((t=>e(this,void 0,void 0,(function*(){i.suggestionLimit=parseInt(t,10),yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Hotkey Modifier Style").setDesc("Allows autodetecting of hotkey modifier or forcing to Mac or Windows").addDropdown((t=>t.addOptions({auto:"Auto Detect",mac:"Force Mac Hotkeys",windows:"Force Windows Hotkeys"}).setValue(i.hotkeyStyle).onChange((t=>e(this,void 0,void 0,(function*(){i.hotkeyStyle=t,yield this.plugin.saveSettings()})))))),new t.Setting(s).setName("Add new macro").setDesc("Create a new grouping of commands that can be run together").addButton((t=>t.setButtonText("+").onClick((()=>e(this,void 0,void 0,(function*(){i.macros.push({name:`Macro ${i.macros.length+1}`,commandIds:[],delay:200}),yield this.plugin.saveSettings(),this.display()}))))))}displayMacroSettings(){const{containerEl:s}=this,{settings:i}=this.plugin;i.macros.forEach(((n,a)=>{const d=new t.Setting(s).setClass("macro-setting").setName(`Macro #${a+1}`).addButton((t=>t.setButtonText("Delete Macro").onClick((()=>e(this,void 0,void 0,(function*(){i.macros.splice(a,1),yield this.plugin.saveSettings(),this.display()})))))),o=d.settingEl.createEl("div","macro-main-settings");o.createEl("label",{text:"Macro Name"}),o.createEl("input",{cls:"name-input",type:"text",value:n.name}).on("change",".name-input",(t=>e(this,void 0,void 0,(function*(){const e=t.target;i.macros[a]=Object.assign(Object.assign({},n),{name:e.value}),yield this.plugin.saveSettings()})))),o.createEl("label",{text:"Delay (ms)"}),o.createEl("input",{cls:"delay-input",type:"number",value:n.delay.toString()}).on("change",".delay-input",(t=>e(this,void 0,void 0,(function*(){const e=t.target.value;i.macros[a].delay=parseInt(e,10),yield this.plugin.saveSettings()})))),o.createEl("label",{text:"Add a new Command to the macro"}),o.createEl("button",{text:"Add Command"}).onClickEvent((()=>e(this,void 0,void 0,(function*(){new S(this.app,(t=>e(this,void 0,void 0,(function*(){i.macros[a].commandIds.push(t.id),yield this.plugin.saveSettings(),this.display()})))).open()})))),n.commandIds.forEach(((s,n)=>{const o=this.app.commands.findCommand(s),l=d.settingEl.createEl("div","macro-command"),c=l.createEl("button",`delete-command-${n}`);l.createEl("p",{text:`${n+1}: ${o.name}`,cls:"command"}),t.setIcon(c,"trash"),c.onClickEvent((()=>e(this,void 0,void 0,(function*(){i.macros[a].commandIds.splice(n,1),yield this.plugin.saveSettings(),this.display()}))))}))}))}}class x extends t.Plugin{onload(){return e(this,void 0,void 0,(function*(){console.log("Loading plugin: Better Command Palette"),yield this.loadSettings(),this.prevCommands=new l,this.prevTags=new l,this.suggestionsWorker=new o({}),this.addCommand({id:"open-better-commmand-palette",name:"Open better command palette",hotkeys:[{modifiers:["Mod","Shift"],key:"p"}],callback:()=>{new X(this.app,this.prevCommands,this.prevTags,this,this.suggestionsWorker).open()}}),this.addCommand({id:"open-better-commmand-palette-file-search",name:"Open better command palette: File Search",hotkeys:[],callback:()=>{new X(this.app,this.prevCommands,this.prevTags,this,this.suggestionsWorker,this.settings.fileSearchPrefix).open()}}),this.addCommand({id:"open-better-commmand-palette-tag-search",name:"Open better command palette: Tag Search",hotkeys:[],callback:()=>{new X(this.app,this.prevCommands,this.prevTags,this,this.suggestionsWorker,this.settings.tagSearchPrefix).open()}}),this.addSettingTab(new I(this.app,this))}))}onunload(){this.suggestionsWorker.terminate()}loadMacroCommands(){this.settings.macros.forEach(((t,e)=>{if(!t.name||!t.commandIds.length)return;const s=new m(this.app,`obsidian-better-command-palette-macro-${e}`,t.name,t.commandIds,t.delay);this.addCommand(s)}))}deleteMacroCommands(){Object.keys(this.app.commands.commands).filter((t=>t.includes("obsidian-better-command-palette-macro-"))).forEach((t=>{this.app.commands.removeCommand(t)}))}loadSettings(){return e(this,void 0,void 0,(function*(){this.settings=Object.assign(Object.assign({},K),yield this.loadData()),this.loadMacroCommands()}))}saveSettings(){return e(this,void 0,void 0,(function*(){this.deleteMacroCommands(),yield this.saveData(this.settings),this.loadMacroCommands()}))}}module.exports=x;
